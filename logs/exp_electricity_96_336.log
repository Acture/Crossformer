Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=128, d_model=64, data='electricity', data_dim=321, data_path='electricity.csv', data_split=[10800, 2160, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=336, itr=5, learning_rate=0.0005, lradj='fixed', n_heads=2, num_workers=0, out_len=96, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il336_ol96_sl24_win2_fa10_dm64_nh2_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10369
val 2065
test 2785
	iters: 100, epoch: 1 | loss: 0.2744237
	speed: 0.3458s/iter; left time: 2213.3315s
	iters: 200, epoch: 1 | loss: 0.2465670
	speed: 0.2908s/iter; left time: 1832.5478s
	iters: 300, epoch: 1 | loss: 0.2225408
	speed: 0.3513s/iter; left time: 2178.6243s
Epoch: 1 cost time: 104.80845737457275
Epoch: 1, Steps: 325 | Train Loss: 0.3109372 Vali Loss: 0.1984510 Test Loss: 0.3074134
Validation loss decreased (inf --> 0.198451).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2090338
	speed: 0.2923s/iter; left time: 1775.9526s
	iters: 200, epoch: 2 | loss: 0.1919571
	speed: 0.3343s/iter; left time: 1998.0679s
	iters: 300, epoch: 2 | loss: 0.2141287
	speed: 0.3419s/iter; left time: 2008.9704s
Epoch: 2 cost time: 103.41860032081604
Epoch: 2, Steps: 325 | Train Loss: 0.2118456 Vali Loss: 0.1973806 Test Loss: 0.2681798
Validation loss decreased (0.198451 --> 0.197381).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1957154
	speed: 0.3455s/iter; left time: 1987.2000s
	iters: 200, epoch: 3 | loss: 0.1875833
	speed: 0.3388s/iter; left time: 1914.8297s
	iters: 300, epoch: 3 | loss: 0.1898312
	speed: 0.3275s/iter; left time: 1818.1408s
Epoch: 3 cost time: 109.17328786849976
Epoch: 3, Steps: 325 | Train Loss: 0.1970894 Vali Loss: 0.1843084 Test Loss: 0.2492747
Validation loss decreased (0.197381 --> 0.184308).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2040745
	speed: 0.3395s/iter; left time: 1841.9885s
	iters: 200, epoch: 4 | loss: 0.1887282
	speed: 0.3358s/iter; left time: 1788.3173s
	iters: 300, epoch: 4 | loss: 0.1895200
	speed: 0.2659s/iter; left time: 1389.5802s
Epoch: 4 cost time: 105.5211911201477
Epoch: 4, Steps: 325 | Train Loss: 0.1860675 Vali Loss: 0.1793786 Test Loss: 0.2788712
Validation loss decreased (0.184308 --> 0.179379).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1842135
	speed: 0.3438s/iter; left time: 1753.9093s
	iters: 200, epoch: 5 | loss: 0.1698391
	speed: 0.2853s/iter; left time: 1426.9235s
	iters: 300, epoch: 5 | loss: 0.1727605
	speed: 0.2941s/iter; left time: 1441.1483s
Epoch: 5 cost time: 101.41828751564026
Epoch: 5, Steps: 325 | Train Loss: 0.1668787 Vali Loss: 0.1489961 Test Loss: 0.2244257
Validation loss decreased (0.179379 --> 0.148996).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1457609
	speed: 0.2995s/iter; left time: 1430.2146s
	iters: 200, epoch: 6 | loss: 0.1365148
	speed: 0.2659s/iter; left time: 1243.1505s
	iters: 300, epoch: 6 | loss: 0.1566913
	speed: 0.3508s/iter; left time: 1605.1010s
Epoch: 6 cost time: 96.56199598312378
Epoch: 6, Steps: 325 | Train Loss: 0.1533797 Vali Loss: 0.1385556 Test Loss: 0.2276247
Validation loss decreased (0.148996 --> 0.138556).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1604079
	speed: 0.3014s/iter; left time: 1341.6482s
	iters: 200, epoch: 7 | loss: 0.1460938
	speed: 0.2937s/iter; left time: 1278.0494s
	iters: 300, epoch: 7 | loss: 0.1441617
	speed: 0.3202s/iter; left time: 1361.2643s
Epoch: 7 cost time: 97.40725374221802
Epoch: 7, Steps: 325 | Train Loss: 0.1463472 Vali Loss: 0.1421342 Test Loss: 0.2284231
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 8 | loss: 0.1369146
	speed: 0.2867s/iter; left time: 1182.7448s
	iters: 200, epoch: 8 | loss: 0.1336109
	speed: 0.2690s/iter; left time: 1083.1775s
	iters: 300, epoch: 8 | loss: 0.1412481
	speed: 0.2967s/iter; left time: 1164.7272s
Epoch: 8 cost time: 88.0385320186615
Epoch: 8, Steps: 325 | Train Loss: 0.1411230 Vali Loss: 0.1402638 Test Loss: 0.2173075
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 9 | loss: 0.1376000
	speed: 0.2152s/iter; left time: 817.9414s
	iters: 200, epoch: 9 | loss: 0.1311843
	speed: 0.2913s/iter; left time: 1078.0751s
	iters: 300, epoch: 9 | loss: 0.1282189
	speed: 0.3196s/iter; left time: 1150.9838s
Epoch: 9 cost time: 92.28581762313843
Epoch: 9, Steps: 325 | Train Loss: 0.1365146 Vali Loss: 0.1359842 Test Loss: 0.2077763
Validation loss decreased (0.138556 --> 0.135984).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1255433
	speed: 0.3292s/iter; left time: 1144.1274s
	iters: 200, epoch: 10 | loss: 0.1300287
	speed: 0.3317s/iter; left time: 1119.9047s
	iters: 300, epoch: 10 | loss: 0.1269048
	speed: 0.3316s/iter; left time: 1086.2281s
Epoch: 10 cost time: 105.13112831115723
Epoch: 10, Steps: 325 | Train Loss: 0.1326082 Vali Loss: 0.1337752 Test Loss: 0.2204298
Validation loss decreased (0.135984 --> 0.133775).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1392104
	speed: 0.3279s/iter; left time: 1033.1937s
	iters: 200, epoch: 11 | loss: 0.1166438
	speed: 0.3500s/iter; left time: 1067.8967s
	iters: 300, epoch: 11 | loss: 0.1245156
	speed: 0.3170s/iter; left time: 935.4493s
Epoch: 11 cost time: 108.68277287483215
Epoch: 11, Steps: 325 | Train Loss: 0.1296771 Vali Loss: 0.1349268 Test Loss: 0.2306834
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 12 | loss: 0.1191971
	speed: 0.3476s/iter; left time: 982.3572s
	iters: 200, epoch: 12 | loss: 0.1228807
	speed: 0.3332s/iter; left time: 908.2647s
	iters: 300, epoch: 12 | loss: 0.1168797
	speed: 0.3301s/iter; left time: 866.8430s
Epoch: 12 cost time: 104.7250485420227
Epoch: 12, Steps: 325 | Train Loss: 0.1270383 Vali Loss: 0.1361990 Test Loss: 0.2148399
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 13 | loss: 0.1264379
	speed: 0.1584s/iter; left time: 396.1561s
	iters: 200, epoch: 13 | loss: 0.1230019
	speed: 0.3187s/iter; left time: 765.1180s
	iters: 300, epoch: 13 | loss: 0.1335462
	speed: 0.2860s/iter; left time: 658.0353s
Epoch: 13 cost time: 85.77648282051086
Epoch: 13, Steps: 325 | Train Loss: 0.1246814 Vali Loss: 0.1360814 Test Loss: 0.2080296
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il336_ol96_sl24_win2_fa10_dm64_nh2_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.22150170803070068, mae:0.3073979616165161
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il336_ol96_sl24_win2_fa10_dm64_nh2_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10369
val 2065
test 2785
	iters: 100, epoch: 1 | loss: 0.2513134
	speed: 0.2729s/iter; left time: 1746.8503s
	iters: 200, epoch: 1 | loss: 0.2278046
	speed: 0.3383s/iter; left time: 2131.5972s
	iters: 300, epoch: 1 | loss: 0.2176591
	speed: 0.2836s/iter; left time: 1758.8650s
Epoch: 1 cost time: 100.28854465484619
Epoch: 1, Steps: 325 | Train Loss: 0.3101829 Vali Loss: 0.1998356 Test Loss: 0.2960476
Validation loss decreased (inf --> 0.199836).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2159500
	speed: 0.3419s/iter; left time: 2077.2009s
	iters: 200, epoch: 2 | loss: 0.2607871
	speed: 0.2664s/iter; left time: 1592.2562s
	iters: 300, epoch: 2 | loss: 0.2065945
	speed: 0.3356s/iter; left time: 1972.0680s
Epoch: 2 cost time: 99.75149297714233
Epoch: 2, Steps: 325 | Train Loss: 0.2121601 Vali Loss: 0.2679408 Test Loss: 0.3327849
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.2104518
	speed: 0.3576s/iter; left time: 2056.7310s
	iters: 200, epoch: 3 | loss: 0.1949549
	speed: 0.3468s/iter; left time: 1959.9510s
	iters: 300, epoch: 3 | loss: 0.2034582
	speed: 0.2689s/iter; left time: 1492.4689s
Epoch: 3 cost time: 109.45553374290466
Epoch: 3, Steps: 325 | Train Loss: 0.2004616 Vali Loss: 0.1760702 Test Loss: 0.2481678
Validation loss decreased (0.199836 --> 0.176070).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1861903
	speed: 0.2953s/iter; left time: 1602.1987s
	iters: 200, epoch: 4 | loss: 0.1910116
	speed: 0.3058s/iter; left time: 1628.4873s
	iters: 300, epoch: 4 | loss: 0.1912276
	speed: 0.3450s/iter; left time: 1803.0456s
Epoch: 4 cost time: 101.1532289981842
Epoch: 4, Steps: 325 | Train Loss: 0.1901247 Vali Loss: 0.1730312 Test Loss: 0.2483205
Validation loss decreased (0.176070 --> 0.173031).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1923503
	speed: 0.3435s/iter; left time: 1752.1833s
	iters: 200, epoch: 5 | loss: 0.2077261
	speed: 0.3261s/iter; left time: 1630.7945s
	iters: 300, epoch: 5 | loss: 0.1801661
	speed: 0.2332s/iter; left time: 1142.9854s
Epoch: 5 cost time: 99.371985912323
Epoch: 5, Steps: 325 | Train Loss: 0.1844337 Vali Loss: 0.1781579 Test Loss: 0.2445188
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.1827009
	speed: 0.2910s/iter; left time: 1389.9474s
	iters: 200, epoch: 6 | loss: 0.1674404
	speed: 0.2829s/iter; left time: 1322.8472s
	iters: 300, epoch: 6 | loss: 0.1673075
	speed: 0.3154s/iter; left time: 1443.4483s
Epoch: 6 cost time: 92.16697907447815
Epoch: 6, Steps: 325 | Train Loss: 0.1704975 Vali Loss: 0.1550462 Test Loss: 0.2392834
Validation loss decreased (0.173031 --> 0.155046).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1553228
	speed: 0.1854s/iter; left time: 825.1440s
	iters: 200, epoch: 7 | loss: 0.1487192
	speed: 0.3127s/iter; left time: 1360.6260s
	iters: 300, epoch: 7 | loss: 0.1611204
	speed: 0.3081s/iter; left time: 1309.6295s
Epoch: 7 cost time: 86.06058979034424
Epoch: 7, Steps: 325 | Train Loss: 0.1578133 Vali Loss: 0.1469559 Test Loss: 0.2332084
Validation loss decreased (0.155046 --> 0.146956).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1656426
	speed: 0.3240s/iter; left time: 1336.7099s
	iters: 200, epoch: 8 | loss: 0.1627361
	speed: 0.3233s/iter; left time: 1301.4293s
	iters: 300, epoch: 8 | loss: 0.1524985
	speed: 0.3111s/iter; left time: 1221.3010s
Epoch: 8 cost time: 103.6718339920044
Epoch: 8, Steps: 325 | Train Loss: 0.1504208 Vali Loss: 0.1462960 Test Loss: 0.2509966
Validation loss decreased (0.146956 --> 0.146296).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1480433
	speed: 0.3139s/iter; left time: 1193.3034s
	iters: 200, epoch: 9 | loss: 0.1539452
	speed: 0.3133s/iter; left time: 1159.6552s
	iters: 300, epoch: 9 | loss: 0.1471679
	speed: 0.2929s/iter; left time: 1054.8379s
Epoch: 9 cost time: 98.85664010047913
Epoch: 9, Steps: 325 | Train Loss: 0.1446480 Vali Loss: 0.1442061 Test Loss: 0.2137543
Validation loss decreased (0.146296 --> 0.144206).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1505401
	speed: 0.2872s/iter; left time: 998.4287s
	iters: 200, epoch: 10 | loss: 0.1312645
	speed: 0.3283s/iter; left time: 1108.3961s
	iters: 300, epoch: 10 | loss: 0.1278612
	speed: 0.3062s/iter; left time: 1003.0719s
Epoch: 10 cost time: 99.67156028747559
Epoch: 10, Steps: 325 | Train Loss: 0.1394484 Vali Loss: 0.1391152 Test Loss: 0.2337906
Validation loss decreased (0.144206 --> 0.139115).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1280037
	speed: 0.3143s/iter; left time: 990.2243s
	iters: 200, epoch: 11 | loss: 0.1343547
	speed: 0.3134s/iter; left time: 956.2208s
	iters: 300, epoch: 11 | loss: 0.1257757
	speed: 0.3209s/iter; left time: 946.8506s
Epoch: 11 cost time: 103.45995759963989
Epoch: 11, Steps: 325 | Train Loss: 0.1353781 Vali Loss: 0.1422388 Test Loss: 0.2489672
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 12 | loss: 0.1335538
	speed: 0.3316s/iter; left time: 936.9740s
	iters: 200, epoch: 12 | loss: 0.1309497
	speed: 0.3293s/iter; left time: 897.5735s
	iters: 300, epoch: 12 | loss: 0.1267893
	speed: 0.3392s/iter; left time: 890.7231s
Epoch: 12 cost time: 106.49299836158752
Epoch: 12, Steps: 325 | Train Loss: 0.1324168 Vali Loss: 0.1364611 Test Loss: 0.2064809
Validation loss decreased (0.139115 --> 0.136461).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1315749
	speed: 0.1343s/iter; left time: 335.8026s
	iters: 200, epoch: 13 | loss: 0.1273488
	speed: 0.1796s/iter; left time: 431.1426s
	iters: 300, epoch: 13 | loss: 0.1377976
	speed: 0.2491s/iter; left time: 573.2055s
Epoch: 13 cost time: 62.59988594055176
Epoch: 13, Steps: 325 | Train Loss: 0.1297215 Vali Loss: 0.1517192 Test Loss: 0.2097576
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 14 | loss: 0.1177835
	speed: 0.2856s/iter; left time: 621.4983s
	iters: 200, epoch: 14 | loss: 0.1262842
	speed: 0.2592s/iter; left time: 538.0881s
	iters: 300, epoch: 14 | loss: 0.1312421
	speed: 0.3492s/iter; left time: 690.1076s
Epoch: 14 cost time: 94.55767846107483
Epoch: 14, Steps: 325 | Train Loss: 0.1276187 Vali Loss: 0.1352866 Test Loss: 0.2297063
Validation loss decreased (0.136461 --> 0.135287).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1120020
	speed: 0.3226s/iter; left time: 597.2136s
	iters: 200, epoch: 15 | loss: 0.1280027
	speed: 0.2556s/iter; left time: 447.5906s
	iters: 300, epoch: 15 | loss: 0.1154296
	speed: 0.3423s/iter; left time: 565.2006s
Epoch: 15 cost time: 97.40373730659485
Epoch: 15, Steps: 325 | Train Loss: 0.1247748 Vali Loss: 0.1332585 Test Loss: 0.2218147
Validation loss decreased (0.135287 --> 0.133259).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1236671
	speed: 0.2834s/iter; left time: 432.4243s
	iters: 200, epoch: 16 | loss: 0.1187688
	speed: 0.2325s/iter; left time: 331.5899s
	iters: 300, epoch: 16 | loss: 0.1145106
	speed: 0.3113s/iter; left time: 412.7847s
Epoch: 16 cost time: 88.39306306838989
Epoch: 16, Steps: 325 | Train Loss: 0.1226284 Vali Loss: 0.1311132 Test Loss: 0.2122287
Validation loss decreased (0.133259 --> 0.131113).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1194746
	speed: 0.3089s/iter; left time: 370.9734s
	iters: 200, epoch: 17 | loss: 0.1212593
	speed: 0.2205s/iter; left time: 242.7552s
	iters: 300, epoch: 17 | loss: 0.1114099
	speed: 0.2855s/iter; left time: 285.7583s
Epoch: 17 cost time: 86.7860836982727
Epoch: 17, Steps: 325 | Train Loss: 0.1210456 Vali Loss: 0.1331458 Test Loss: 0.2259484
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 18 | loss: 0.1263588
	speed: 0.2883s/iter; left time: 252.5070s
	iters: 200, epoch: 18 | loss: 0.1201015
	speed: 0.2034s/iter; left time: 157.8005s
	iters: 300, epoch: 18 | loss: 0.1229214
	speed: 0.3083s/iter; left time: 208.4119s
Epoch: 18 cost time: 84.95128321647644
Epoch: 18, Steps: 325 | Train Loss: 0.1199847 Vali Loss: 0.1348465 Test Loss: 0.2061678
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 19 | loss: 0.1173231
	speed: 0.2870s/iter; left time: 158.1385s
	iters: 200, epoch: 19 | loss: 0.1170354
	speed: 0.2124s/iter; left time: 95.8143s
	iters: 300, epoch: 19 | loss: 0.1131558
	speed: 0.2939s/iter; left time: 103.1699s
Epoch: 19 cost time: 84.44952988624573
Epoch: 19, Steps: 325 | Train Loss: 0.1178870 Vali Loss: 0.1311778 Test Loss: 0.1987801
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il336_ol96_sl24_win2_fa10_dm64_nh2_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.2131912261247635, mae:0.30049842596054077
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il336_ol96_sl24_win2_fa10_dm64_nh2_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10369
val 2065
test 2785
	iters: 100, epoch: 1 | loss: 0.2628710
	speed: 0.2015s/iter; left time: 1290.0479s
	iters: 200, epoch: 1 | loss: 0.2335191
	speed: 0.2813s/iter; left time: 1772.2295s
	iters: 300, epoch: 1 | loss: 0.2213209
	speed: 0.2740s/iter; left time: 1699.3532s
Epoch: 1 cost time: 83.19540619850159
Epoch: 1, Steps: 325 | Train Loss: 0.3165431 Vali Loss: 0.2050272 Test Loss: 0.2923352
Validation loss decreased (inf --> 0.205027).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2268998
	speed: 0.2545s/iter; left time: 1546.3516s
	iters: 200, epoch: 2 | loss: 0.2190558
	speed: 0.2258s/iter; left time: 1349.4686s
	iters: 300, epoch: 2 | loss: 0.2152561
	speed: 0.2941s/iter; left time: 1727.9414s
Epoch: 2 cost time: 83.09018111228943
Epoch: 2, Steps: 325 | Train Loss: 0.2124269 Vali Loss: 0.1796019 Test Loss: 0.2600241
Validation loss decreased (0.205027 --> 0.179602).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2151777
	speed: 0.2928s/iter; left time: 1684.0349s
	iters: 200, epoch: 3 | loss: 0.2044185
	speed: 0.2100s/iter; left time: 1186.6188s
	iters: 300, epoch: 3 | loss: 0.1780762
	speed: 0.2828s/iter; left time: 1569.8600s
Epoch: 3 cost time: 83.61555314064026
Epoch: 3, Steps: 325 | Train Loss: 0.1983079 Vali Loss: 0.1759537 Test Loss: 0.2406759
Validation loss decreased (0.179602 --> 0.175954).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1950630
	speed: 0.2733s/iter; left time: 1482.7828s
	iters: 200, epoch: 4 | loss: 0.1815057
	speed: 0.2110s/iter; left time: 1123.7832s
	iters: 300, epoch: 4 | loss: 0.1735660
	speed: 0.3164s/iter; left time: 1653.5871s
Epoch: 4 cost time: 85.54203820228577
Epoch: 4, Steps: 325 | Train Loss: 0.1850294 Vali Loss: 0.2434153 Test Loss: 0.2969464
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.1675220
	speed: 0.2998s/iter; left time: 1529.3528s
	iters: 200, epoch: 5 | loss: 0.1545271
	speed: 0.2248s/iter; left time: 1124.0654s
	iters: 300, epoch: 5 | loss: 0.1692636
	speed: 0.2747s/iter; left time: 1346.1102s
Epoch: 5 cost time: 85.2301344871521
Epoch: 5, Steps: 325 | Train Loss: 0.1676945 Vali Loss: 0.1502555 Test Loss: 0.2296056
Validation loss decreased (0.175954 --> 0.150255).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1509037
	speed: 0.2685s/iter; left time: 1282.2562s
	iters: 200, epoch: 6 | loss: 0.1552355
	speed: 0.2115s/iter; left time: 988.9061s
	iters: 300, epoch: 6 | loss: 0.1425850
	speed: 0.2619s/iter; left time: 1198.3857s
Epoch: 6 cost time: 79.8938307762146
Epoch: 6, Steps: 325 | Train Loss: 0.1549193 Vali Loss: 0.1421670 Test Loss: 0.2058144
Validation loss decreased (0.150255 --> 0.142167).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1503421
	speed: 0.2682s/iter; left time: 1193.5888s
	iters: 200, epoch: 7 | loss: 0.1483801
	speed: 0.2437s/iter; left time: 1060.1535s
	iters: 300, epoch: 7 | loss: 0.1385058
	speed: 0.1905s/iter; left time: 809.8978s
Epoch: 7 cost time: 72.89152383804321
Epoch: 7, Steps: 325 | Train Loss: 0.1488105 Vali Loss: 0.1560703 Test Loss: 0.2460947
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 8 | loss: 0.1430429
	speed: 0.2623s/iter; left time: 1082.4211s
	iters: 200, epoch: 8 | loss: 0.1326388
	speed: 0.2883s/iter; left time: 1160.8893s
	iters: 300, epoch: 8 | loss: 0.1475047
	speed: 0.3029s/iter; left time: 1189.1909s
Epoch: 8 cost time: 94.26882529258728
Epoch: 8, Steps: 325 | Train Loss: 0.1449322 Vali Loss: 0.1375462 Test Loss: 0.2041788
Validation loss decreased (0.142167 --> 0.137546).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1372749
	speed: 0.3180s/iter; left time: 1208.5283s
	iters: 200, epoch: 9 | loss: 0.1376104
	speed: 0.3145s/iter; left time: 1164.0968s
	iters: 300, epoch: 9 | loss: 0.1292391
	speed: 0.3138s/iter; left time: 1130.0914s
Epoch: 9 cost time: 100.61060428619385
Epoch: 9, Steps: 325 | Train Loss: 0.1391120 Vali Loss: 0.1397793 Test Loss: 0.2113248
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 10 | loss: 0.1354274
	speed: 0.2979s/iter; left time: 1035.5134s
	iters: 200, epoch: 10 | loss: 0.1263542
	speed: 0.2926s/iter; left time: 987.7469s
	iters: 300, epoch: 10 | loss: 0.1367889
	speed: 0.3477s/iter; left time: 1138.9749s
Epoch: 10 cost time: 100.52554202079773
Epoch: 10, Steps: 325 | Train Loss: 0.1357090 Vali Loss: 0.1377528 Test Loss: 0.2040668
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 11 | loss: 0.1358412
	speed: 0.2426s/iter; left time: 764.5268s
	iters: 200, epoch: 11 | loss: 0.1210619
	speed: 0.1267s/iter; left time: 386.6170s
	iters: 300, epoch: 11 | loss: 0.1309884
	speed: 0.1957s/iter; left time: 577.6507s
Epoch: 11 cost time: 61.236138105392456
Epoch: 11, Steps: 325 | Train Loss: 0.1325208 Vali Loss: 0.1380057 Test Loss: 0.2106036
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il336_ol96_sl24_win2_fa10_dm64_nh2_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.2049461454153061, mae:0.29486143589019775
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il336_ol96_sl24_win2_fa10_dm64_nh2_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10369
val 2065
test 2785
	iters: 100, epoch: 1 | loss: 0.2852423
	speed: 0.2075s/iter; left time: 1328.0455s
	iters: 200, epoch: 1 | loss: 0.2638494
	speed: 0.2446s/iter; left time: 1541.1609s
	iters: 300, epoch: 1 | loss: 0.2176597
	speed: 0.2133s/iter; left time: 1322.6158s
Epoch: 1 cost time: 71.59392380714417
Epoch: 1, Steps: 325 | Train Loss: 0.3142500 Vali Loss: 0.2067859 Test Loss: 0.3001915
Validation loss decreased (inf --> 0.206786).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2227651
	speed: 0.2982s/iter; left time: 1811.9039s
	iters: 200, epoch: 2 | loss: 0.1993564
	speed: 0.2290s/iter; left time: 1368.7626s
	iters: 300, epoch: 2 | loss: 0.2035908
	speed: 0.2316s/iter; left time: 1360.7733s
Epoch: 2 cost time: 82.27308869361877
Epoch: 2, Steps: 325 | Train Loss: 0.2134527 Vali Loss: 0.1866015 Test Loss: 0.2605101
Validation loss decreased (0.206786 --> 0.186601).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2026123
	speed: 0.2080s/iter; left time: 1196.4906s
	iters: 200, epoch: 3 | loss: 0.2161098
	speed: 0.2682s/iter; left time: 1515.7729s
	iters: 300, epoch: 3 | loss: 0.1872770
	speed: 0.2028s/iter; left time: 1125.7884s
Epoch: 3 cost time: 72.78231620788574
Epoch: 3, Steps: 325 | Train Loss: 0.2002045 Vali Loss: 0.1740729 Test Loss: 0.2444243
Validation loss decreased (0.186601 --> 0.174073).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2214842
	speed: 0.2417s/iter; left time: 1311.2796s
	iters: 200, epoch: 4 | loss: 0.1995664
	speed: 0.1933s/iter; left time: 1029.4290s
	iters: 300, epoch: 4 | loss: 0.1850567
	speed: 0.2397s/iter; left time: 1252.6197s
Epoch: 4 cost time: 75.54576873779297
Epoch: 4, Steps: 325 | Train Loss: 0.1909151 Vali Loss: 0.1742510 Test Loss: 0.2406371
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.1879169
	speed: 0.1994s/iter; left time: 1017.0797s
	iters: 200, epoch: 5 | loss: 0.1705623
	speed: 0.2745s/iter; left time: 1372.9864s
	iters: 300, epoch: 5 | loss: 0.1572376
	speed: 0.2081s/iter; left time: 1019.7388s
Epoch: 5 cost time: 73.3086941242218
Epoch: 5, Steps: 325 | Train Loss: 0.1776422 Vali Loss: 0.1659483 Test Loss: 0.2173567
Validation loss decreased (0.174073 --> 0.165948).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1403638
	speed: 0.2615s/iter; left time: 1248.7361s
	iters: 200, epoch: 6 | loss: 0.1511432
	speed: 0.2136s/iter; left time: 998.9863s
	iters: 300, epoch: 6 | loss: 0.1573487
	speed: 0.2485s/iter; left time: 1137.1824s
Epoch: 6 cost time: 80.47056984901428
Epoch: 6, Steps: 325 | Train Loss: 0.1602025 Vali Loss: 0.1490103 Test Loss: 0.2021328
Validation loss decreased (0.165948 --> 0.149010).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1468925
	speed: 0.1913s/iter; left time: 851.4721s
	iters: 200, epoch: 7 | loss: 0.1337745
	speed: 0.2747s/iter; left time: 1195.2923s
	iters: 300, epoch: 7 | loss: 0.1448654
	speed: 0.2032s/iter; left time: 864.0041s
Epoch: 7 cost time: 71.74750447273254
Epoch: 7, Steps: 325 | Train Loss: 0.1507815 Vali Loss: 0.1454942 Test Loss: 0.2014578
Validation loss decreased (0.149010 --> 0.145494).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1548551
	speed: 0.2562s/iter; left time: 1057.1124s
	iters: 200, epoch: 8 | loss: 0.1505526
	speed: 0.1974s/iter; left time: 794.6903s
	iters: 300, epoch: 8 | loss: 0.1340184
	speed: 0.2556s/iter; left time: 1003.6512s
Epoch: 8 cost time: 78.04353404045105
Epoch: 8, Steps: 325 | Train Loss: 0.1454110 Vali Loss: 0.1589393 Test Loss: 0.2549460
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 9 | loss: 0.1594403
	speed: 0.1961s/iter; left time: 745.2989s
	iters: 200, epoch: 9 | loss: 0.1352758
	speed: 0.2545s/iter; left time: 942.0049s
	iters: 300, epoch: 9 | loss: 0.1350493
	speed: 0.1946s/iter; left time: 700.8307s
Epoch: 9 cost time: 69.3349826335907
Epoch: 9, Steps: 325 | Train Loss: 0.1402810 Vali Loss: 0.1419471 Test Loss: 0.2036778
Validation loss decreased (0.145494 --> 0.141947).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1383969
	speed: 0.2473s/iter; left time: 859.5970s
	iters: 200, epoch: 10 | loss: 0.1299978
	speed: 0.2108s/iter; left time: 711.7353s
	iters: 300, epoch: 10 | loss: 0.1318105
	speed: 0.2599s/iter; left time: 851.3178s
Epoch: 10 cost time: 76.56502676010132
Epoch: 10, Steps: 325 | Train Loss: 0.1361506 Vali Loss: 0.1323938 Test Loss: 0.1922209
Validation loss decreased (0.141947 --> 0.132394).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1378643
	speed: 0.2054s/iter; left time: 647.2082s
	iters: 200, epoch: 11 | loss: 0.1401447
	speed: 0.2627s/iter; left time: 801.4937s
	iters: 300, epoch: 11 | loss: 0.1243584
	speed: 0.2040s/iter; left time: 601.8951s
Epoch: 11 cost time: 72.29838871955872
Epoch: 11, Steps: 325 | Train Loss: 0.1329569 Vali Loss: 0.1410729 Test Loss: 0.2017322
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 12 | loss: 0.1350665
	speed: 0.2276s/iter; left time: 643.1647s
	iters: 200, epoch: 12 | loss: 0.1210037
	speed: 0.2115s/iter; left time: 576.5213s
	iters: 300, epoch: 12 | loss: 0.1176116
	speed: 0.2548s/iter; left time: 669.1665s
Epoch: 12 cost time: 74.84157204627991
Epoch: 12, Steps: 325 | Train Loss: 0.1308146 Vali Loss: 0.1310125 Test Loss: 0.2041880
Validation loss decreased (0.132394 --> 0.131013).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1295752
	speed: 0.2554s/iter; left time: 638.6354s
	iters: 200, epoch: 13 | loss: 0.1242073
	speed: 0.1930s/iter; left time: 463.3326s
	iters: 300, epoch: 13 | loss: 0.1259688
	speed: 0.1215s/iter; left time: 279.4861s
Epoch: 13 cost time: 62.34047818183899
Epoch: 13, Steps: 325 | Train Loss: 0.1281556 Vali Loss: 0.1331686 Test Loss: 0.1965900
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 14 | loss: 0.1166402
	speed: 0.3031s/iter; left time: 659.5119s
	iters: 200, epoch: 14 | loss: 0.1310337
	speed: 0.3283s/iter; left time: 681.5922s
	iters: 300, epoch: 14 | loss: 0.1184698
	speed: 0.3026s/iter; left time: 597.8442s
Epoch: 14 cost time: 99.04693984985352
Epoch: 14, Steps: 325 | Train Loss: 0.1256250 Vali Loss: 0.1358139 Test Loss: 0.1931922
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 15 | loss: 0.1187234
	speed: 0.2725s/iter; left time: 504.3656s
	iters: 200, epoch: 15 | loss: 0.1297020
	speed: 0.2924s/iter; left time: 511.9453s
	iters: 300, epoch: 15 | loss: 0.1257826
	speed: 0.3136s/iter; left time: 517.7153s
Epoch: 15 cost time: 98.93196487426758
Epoch: 15, Steps: 325 | Train Loss: 0.1236805 Vali Loss: 0.1314431 Test Loss: 0.1952934
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il336_ol96_sl24_win2_fa10_dm64_nh2_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.2050803154706955, mae:0.2916804552078247
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il336_ol96_sl24_win2_fa10_dm64_nh2_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10369
val 2065
test 2785
	iters: 100, epoch: 1 | loss: 0.2988927
	speed: 0.2710s/iter; left time: 1734.6471s
	iters: 200, epoch: 1 | loss: 0.2660593
	speed: 0.2848s/iter; left time: 1794.5806s
	iters: 300, epoch: 1 | loss: 0.2382951
	speed: 0.2616s/iter; left time: 1621.9489s
Epoch: 1 cost time: 92.60031533241272
Epoch: 1, Steps: 325 | Train Loss: 0.3103320 Vali Loss: 0.2008727 Test Loss: 0.2998540
Validation loss decreased (inf --> 0.200873).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2172357
	speed: 0.2801s/iter; left time: 1701.6029s
	iters: 200, epoch: 2 | loss: 0.2054950
	speed: 0.2827s/iter; left time: 1689.6658s
	iters: 300, epoch: 2 | loss: 0.1912792
	speed: 0.1236s/iter; left time: 726.4881s
Epoch: 2 cost time: 71.64130806922913
Epoch: 2, Steps: 325 | Train Loss: 0.2117925 Vali Loss: 0.1800177 Test Loss: 0.2528469
Validation loss decreased (0.200873 --> 0.180018).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2212254
	speed: 0.3043s/iter; left time: 1749.8045s
	iters: 200, epoch: 3 | loss: 0.1874815
	speed: 0.3331s/iter; left time: 1882.4821s
	iters: 300, epoch: 3 | loss: 0.1962673
	speed: 0.2810s/iter; left time: 1559.8706s
Epoch: 3 cost time: 102.21589660644531
Epoch: 3, Steps: 325 | Train Loss: 0.1987165 Vali Loss: 0.1754785 Test Loss: 0.2427863
Validation loss decreased (0.180018 --> 0.175478).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1880765
	speed: 0.3337s/iter; left time: 1810.6815s
	iters: 200, epoch: 4 | loss: 0.1910870
	speed: 0.3327s/iter; left time: 1772.0951s
	iters: 300, epoch: 4 | loss: 0.2165923
	speed: 0.3228s/iter; left time: 1687.0476s
Epoch: 4 cost time: 105.16748261451721
Epoch: 4, Steps: 325 | Train Loss: 0.1907972 Vali Loss: 0.1991312 Test Loss: 0.2614439
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.1707212
	speed: 0.3359s/iter; left time: 1713.4880s
	iters: 200, epoch: 5 | loss: 0.1751967
	speed: 0.3100s/iter; left time: 1550.1010s
	iters: 300, epoch: 5 | loss: 0.1565110
	speed: 0.3122s/iter; left time: 1530.0509s
Epoch: 5 cost time: 101.7491455078125
Epoch: 5, Steps: 325 | Train Loss: 0.1801587 Vali Loss: 0.1578725 Test Loss: 0.2308116
Validation loss decreased (0.175478 --> 0.157872).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1590521
	speed: 0.3611s/iter; left time: 1724.4851s
	iters: 200, epoch: 6 | loss: 0.1516270
	speed: 0.3177s/iter; left time: 1485.7259s
	iters: 300, epoch: 6 | loss: 0.1454036
	speed: 0.3251s/iter; left time: 1487.5590s
Epoch: 6 cost time: 105.8207414150238
Epoch: 6, Steps: 325 | Train Loss: 0.1609391 Vali Loss: 0.1460750 Test Loss: 0.2179487
Validation loss decreased (0.157872 --> 0.146075).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1543817
	speed: 0.3341s/iter; left time: 1486.9410s
	iters: 200, epoch: 7 | loss: 0.1554257
	speed: 0.3065s/iter; left time: 1333.7395s
	iters: 300, epoch: 7 | loss: 0.1521046
	speed: 0.1399s/iter; left time: 594.5147s
Epoch: 7 cost time: 80.93666553497314
Epoch: 7, Steps: 325 | Train Loss: 0.1502107 Vali Loss: 0.1456404 Test Loss: 0.2027354
Validation loss decreased (0.146075 --> 0.145640).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1446305
	speed: 0.2172s/iter; left time: 896.2184s
	iters: 200, epoch: 8 | loss: 0.1504101
	speed: 0.2825s/iter; left time: 1137.2790s
	iters: 300, epoch: 8 | loss: 0.1273837
	speed: 0.2529s/iter; left time: 992.6979s
Epoch: 8 cost time: 83.71624517440796
Epoch: 8, Steps: 325 | Train Loss: 0.1441691 Vali Loss: 0.1382060 Test Loss: 0.2111631
Validation loss decreased (0.145640 --> 0.138206).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1378405
	speed: 0.2272s/iter; left time: 863.7125s
	iters: 200, epoch: 9 | loss: 0.1551390
	speed: 0.2861s/iter; left time: 1058.8543s
	iters: 300, epoch: 9 | loss: 0.1428577
	speed: 0.2275s/iter; left time: 819.3034s
Epoch: 9 cost time: 79.88004755973816
Epoch: 9, Steps: 325 | Train Loss: 0.1394501 Vali Loss: 0.1373528 Test Loss: 0.1938013
Validation loss decreased (0.138206 --> 0.137353).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1323493
	speed: 0.2361s/iter; left time: 820.7406s
	iters: 200, epoch: 10 | loss: 0.1343032
	speed: 0.2692s/iter; left time: 908.8804s
	iters: 300, epoch: 10 | loss: 0.1298644
	speed: 0.2555s/iter; left time: 836.9310s
Epoch: 10 cost time: 81.27638912200928
Epoch: 10, Steps: 325 | Train Loss: 0.1354341 Vali Loss: 0.1343608 Test Loss: 0.1949956
Validation loss decreased (0.137353 --> 0.134361).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1373003
	speed: 0.2855s/iter; left time: 899.5724s
	iters: 200, epoch: 11 | loss: 0.1332026
	speed: 0.2219s/iter; left time: 677.0274s
	iters: 300, epoch: 11 | loss: 0.1281052
	speed: 0.3091s/iter; left time: 912.2035s
Epoch: 11 cost time: 86.8981511592865
Epoch: 11, Steps: 325 | Train Loss: 0.1323019 Vali Loss: 0.1311717 Test Loss: 0.1906288
Validation loss decreased (0.134361 --> 0.131172).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1215270
	speed: 0.2562s/iter; left time: 724.1421s
	iters: 200, epoch: 12 | loss: 0.1404108
	speed: 0.2015s/iter; left time: 549.3902s
	iters: 300, epoch: 12 | loss: 0.1290552
	speed: 0.3216s/iter; left time: 844.5983s
Epoch: 12 cost time: 82.92593455314636
Epoch: 12, Steps: 325 | Train Loss: 0.1293554 Vali Loss: 0.1315735 Test Loss: 0.1910716
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 13 | loss: 0.1148856
	speed: 0.2326s/iter; left time: 581.6824s
	iters: 200, epoch: 13 | loss: 0.1176486
	speed: 0.2421s/iter; left time: 581.2805s
	iters: 300, epoch: 13 | loss: 0.1276387
	speed: 0.2400s/iter; left time: 552.1969s
Epoch: 13 cost time: 81.62047243118286
Epoch: 13, Steps: 325 | Train Loss: 0.1268257 Vali Loss: 0.1336664 Test Loss: 0.1936072
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 14 | loss: 0.1298349
	speed: 0.2305s/iter; left time: 501.5957s
	iters: 200, epoch: 14 | loss: 0.1174510
	speed: 0.2482s/iter; left time: 515.1950s
	iters: 300, epoch: 14 | loss: 0.1333833
	speed: 0.2133s/iter; left time: 421.4981s
Epoch: 14 cost time: 76.96893286705017
Epoch: 14, Steps: 325 | Train Loss: 0.1250036 Vali Loss: 0.1319104 Test Loss: 0.1949827
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il336_ol96_sl24_win2_fa10_dm64_nh2_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.19124269485473633, mae:0.2849172055721283
