Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh2', data_dim=7, data_path='ETTh2.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=336, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=96, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3382035
	speed: 0.1964s/iter; left time: 990.2258s
	iters: 200, epoch: 1 | loss: 0.3978844
	speed: 0.1309s/iter; left time: 646.9872s
Epoch: 1 cost time: 45.485315799713135
Epoch: 1, Steps: 257 | Train Loss: 0.4808258 Vali Loss: 0.3279443 Test Loss: 0.6326733
Validation loss decreased (inf --> 0.327944).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2090693
	speed: 0.1904s/iter; left time: 911.0415s
	iters: 200, epoch: 2 | loss: 0.2751567
	speed: 0.1099s/iter; left time: 514.9365s
Epoch: 2 cost time: 36.706000328063965
Epoch: 2, Steps: 257 | Train Loss: 0.3335453 Vali Loss: 0.4714473 Test Loss: 0.8849654
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2955786
	speed: 0.1873s/iter; left time: 848.0056s
	iters: 200, epoch: 3 | loss: 0.3998617
	speed: 0.1795s/iter; left time: 794.7974s
Epoch: 3 cost time: 42.793891191482544
Epoch: 3, Steps: 257 | Train Loss: 0.2816407 Vali Loss: 0.4762096 Test Loss: 0.8653877
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3922374
	speed: 0.2036s/iter; left time: 869.2516s
	iters: 200, epoch: 4 | loss: 0.3297207
	speed: 0.1772s/iter; left time: 738.9655s
Epoch: 4 cost time: 49.57775568962097
Epoch: 4, Steps: 257 | Train Loss: 0.2560772 Vali Loss: 0.4969627 Test Loss: 1.0465115
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.6375135183334351, mae:0.545922040939331
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4411342
	speed: 0.2541s/iter; left time: 1280.7076s
	iters: 200, epoch: 1 | loss: 0.4174559
	speed: 0.2122s/iter; left time: 1048.3681s
Epoch: 1 cost time: 60.343536138534546
Epoch: 1, Steps: 257 | Train Loss: 0.4813009 Vali Loss: 0.3332503 Test Loss: 0.6061502
Validation loss decreased (inf --> 0.333250).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3102545
	speed: 0.2111s/iter; left time: 1009.6762s
	iters: 200, epoch: 2 | loss: 0.2910332
	speed: 0.1294s/iter; left time: 606.1532s
Epoch: 2 cost time: 40.46813201904297
Epoch: 2, Steps: 257 | Train Loss: 0.3316258 Vali Loss: 0.3728931 Test Loss: 0.8056428
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2888349
	speed: 0.1079s/iter; left time: 488.2482s
	iters: 200, epoch: 3 | loss: 0.3303052
	speed: 0.1091s/iter; left time: 482.9148s
Epoch: 3 cost time: 28.150363445281982
Epoch: 3, Steps: 257 | Train Loss: 0.2766181 Vali Loss: 0.5627751 Test Loss: 1.3336094
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3596045
	speed: 0.1989s/iter; left time: 849.4694s
	iters: 200, epoch: 4 | loss: 0.1713290
	speed: 0.2796s/iter; left time: 1165.9127s
Epoch: 4 cost time: 65.47679376602173
Epoch: 4, Steps: 257 | Train Loss: 0.2523702 Vali Loss: 0.6418099 Test Loss: 1.5588813
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.6116666197776794, mae:0.5445584654808044
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4726425
	speed: 0.1088s/iter; left time: 548.5239s
	iters: 200, epoch: 1 | loss: 0.3060596
	speed: 0.1846s/iter; left time: 912.0403s
Epoch: 1 cost time: 41.55704665184021
Epoch: 1, Steps: 257 | Train Loss: 0.4901669 Vali Loss: 0.3037926 Test Loss: 0.6127450
Validation loss decreased (inf --> 0.303793).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4164523
	speed: 0.1822s/iter; left time: 871.5609s
	iters: 200, epoch: 2 | loss: 0.3480138
	speed: 0.1806s/iter; left time: 845.9099s
Epoch: 2 cost time: 49.074910402297974
Epoch: 2, Steps: 257 | Train Loss: 0.3356202 Vali Loss: 0.3791257 Test Loss: 0.7661261
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3374273
	speed: 0.2648s/iter; left time: 1198.7803s
	iters: 200, epoch: 3 | loss: 0.2686686
	speed: 0.1761s/iter; left time: 779.7089s
Epoch: 3 cost time: 50.325413942337036
Epoch: 3, Steps: 257 | Train Loss: 0.2862915 Vali Loss: 0.3923687 Test Loss: 0.7177432
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.1701806
	speed: 0.1094s/iter; left time: 467.3142s
	iters: 200, epoch: 4 | loss: 0.3713678
	speed: 0.1094s/iter; left time: 456.0337s
Epoch: 4 cost time: 28.151214361190796
Epoch: 4, Steps: 257 | Train Loss: 0.2634003 Vali Loss: 0.4717005 Test Loss: 0.9256359
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.6181899905204773, mae:0.5398538112640381
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3051193
	speed: 0.2106s/iter; left time: 1061.5023s
	iters: 200, epoch: 1 | loss: 0.2662502
	speed: 0.1740s/iter; left time: 859.5152s
Epoch: 1 cost time: 50.29983568191528
Epoch: 1, Steps: 257 | Train Loss: 0.4826375 Vali Loss: 0.3589142 Test Loss: 0.5654234
Validation loss decreased (inf --> 0.358914).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2890429
	speed: 0.2617s/iter; left time: 1251.7390s
	iters: 200, epoch: 2 | loss: 0.2425680
	speed: 0.1954s/iter; left time: 915.1868s
Epoch: 2 cost time: 56.12268352508545
Epoch: 2, Steps: 257 | Train Loss: 0.3285177 Vali Loss: 0.4220621 Test Loss: 0.9570234
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2810870
	speed: 0.2179s/iter; left time: 986.6445s
	iters: 200, epoch: 3 | loss: 0.2774224
	speed: 0.1741s/iter; left time: 770.8737s
Epoch: 3 cost time: 45.45974349975586
Epoch: 3, Steps: 257 | Train Loss: 0.2765696 Vali Loss: 0.4511344 Test Loss: 0.9336833
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.1882059
	speed: 0.1544s/iter; left time: 659.4553s
	iters: 200, epoch: 4 | loss: 0.1738511
	speed: 0.1787s/iter; left time: 745.3699s
Epoch: 4 cost time: 42.48641800880432
Epoch: 4, Steps: 257 | Train Loss: 0.2521388 Vali Loss: 0.4274756 Test Loss: 0.8696438
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.5702398419380188, mae:0.5839861631393433
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3004501
	speed: 0.2093s/iter; left time: 1054.8351s
	iters: 200, epoch: 1 | loss: 0.2712682
	speed: 0.1988s/iter; left time: 982.3062s
Epoch: 1 cost time: 48.89599108695984
Epoch: 1, Steps: 257 | Train Loss: 0.4826082 Vali Loss: 0.3483757 Test Loss: 0.6353929
Validation loss decreased (inf --> 0.348376).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3058319
	speed: 0.0881s/iter; left time: 421.7039s
	iters: 200, epoch: 2 | loss: 0.3807110
	speed: 0.0904s/iter; left time: 423.3638s
Epoch: 2 cost time: 24.91293716430664
Epoch: 2, Steps: 257 | Train Loss: 0.3325571 Vali Loss: 0.5164747 Test Loss: 1.1122896
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3697003
	speed: 0.2955s/iter; left time: 1337.9102s
	iters: 200, epoch: 3 | loss: 0.2951491
	speed: 0.2064s/iter; left time: 913.7127s
Epoch: 3 cost time: 61.58329486846924
Epoch: 3, Steps: 257 | Train Loss: 0.2741262 Vali Loss: 0.6155535 Test Loss: 1.5237248
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2540909
	speed: 0.1489s/iter; left time: 635.9371s
	iters: 200, epoch: 4 | loss: 0.1961900
	speed: 0.1880s/iter; left time: 783.8102s
Epoch: 4 cost time: 45.51449799537659
Epoch: 4, Steps: 257 | Train Loss: 0.2493073 Vali Loss: 1.0187376 Test Loss: 2.6385889
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.6403460502624512, mae:0.5570289492607117
