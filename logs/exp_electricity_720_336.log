Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=128, d_model=64, data='electricity', data_dim=321, data_path='electricity.csv', data_split=[10800, 2160, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=336, itr=5, learning_rate=0.0005, lradj='fixed', n_heads=2, num_workers=0, out_len=720, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il336_ol720_sl24_win2_fa10_dm64_nh2_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9745
val 1441
test 2161
	iters: 100, epoch: 1 | loss: 0.3176821
	speed: 0.5518s/iter; left time: 3311.2659s
	iters: 200, epoch: 1 | loss: 0.2789651
	speed: 0.4763s/iter; left time: 2810.6033s
	iters: 300, epoch: 1 | loss: 0.2748111
	speed: 0.6207s/iter; left time: 3600.7478s
Epoch: 1 cost time: 168.29335474967957
Epoch: 1, Steps: 305 | Train Loss: 0.3655878 Vali Loss: 0.2519176 Test Loss: 0.3943939
Validation loss decreased (inf --> 0.251918).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2804182
	speed: 0.5839s/iter; left time: 3325.7093s
	iters: 200, epoch: 2 | loss: 0.2648651
	speed: 0.6295s/iter; left time: 3522.8915s
	iters: 300, epoch: 2 | loss: 0.2545379
	speed: 0.6584s/iter; left time: 3618.7455s
Epoch: 2 cost time: 190.22439765930176
Epoch: 2, Steps: 305 | Train Loss: 0.2729870 Vali Loss: 0.2403275 Test Loss: 0.3709400
Validation loss decreased (0.251918 --> 0.240327).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2623164
	speed: 0.6335s/iter; left time: 3415.4581s
	iters: 200, epoch: 3 | loss: 0.2660757
	speed: 0.6248s/iter; left time: 3305.8345s
	iters: 300, epoch: 3 | loss: 0.2478622
	speed: 0.6380s/iter; left time: 3311.8520s
Epoch: 3 cost time: 192.6536464691162
Epoch: 3, Steps: 305 | Train Loss: 0.2558506 Vali Loss: 0.2433293 Test Loss: 0.3837821
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2319446
	speed: 0.6292s/iter; left time: 3200.0990s
	iters: 200, epoch: 4 | loss: 0.2312519
	speed: 0.5061s/iter; left time: 2523.2489s
	iters: 300, epoch: 4 | loss: 0.2478203
	speed: 0.5874s/iter; left time: 2869.9130s
Epoch: 4 cost time: 175.53409075737
Epoch: 4, Steps: 305 | Train Loss: 0.2407716 Vali Loss: 0.2617275 Test Loss: 0.4348849
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.2430418
	speed: 0.6111s/iter; left time: 2921.6052s
	iters: 200, epoch: 5 | loss: 0.2286421
	speed: 0.6164s/iter; left time: 2885.4690s
	iters: 300, epoch: 5 | loss: 0.2216483
	speed: 0.6140s/iter; left time: 2812.5251s
Epoch: 5 cost time: 187.59509992599487
Epoch: 5, Steps: 305 | Train Loss: 0.2296163 Vali Loss: 0.3106309 Test Loss: 0.4600782
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il336_ol720_sl24_win2_fa10_dm64_nh2_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.3716423213481903, mae:0.39945319294929504
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il336_ol720_sl24_win2_fa10_dm64_nh2_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9745
val 1441
test 2161
	iters: 100, epoch: 1 | loss: 0.3187898
	speed: 0.6273s/iter; left time: 3764.2923s
	iters: 200, epoch: 1 | loss: 0.2980103
	speed: 0.6200s/iter; left time: 3658.6370s
	iters: 300, epoch: 1 | loss: 0.2896726
	speed: 0.6447s/iter; left time: 3740.1292s
Epoch: 1 cost time: 192.62872958183289
Epoch: 1, Steps: 305 | Train Loss: 0.3616785 Vali Loss: 0.2468039 Test Loss: 0.4007820
Validation loss decreased (inf --> 0.246804).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2740635
	speed: 0.6566s/iter; left time: 3740.0737s
	iters: 200, epoch: 2 | loss: 0.2587114
	speed: 0.6045s/iter; left time: 3382.5658s
	iters: 300, epoch: 2 | loss: 0.2740580
	speed: 0.4595s/iter; left time: 2525.6218s
Epoch: 2 cost time: 175.18565440177917
Epoch: 2, Steps: 305 | Train Loss: 0.2707179 Vali Loss: 0.2403843 Test Loss: 0.3694343
Validation loss decreased (0.246804 --> 0.240384).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2508057
	speed: 0.5356s/iter; left time: 2887.6119s
	iters: 200, epoch: 3 | loss: 0.2634688
	speed: 0.5794s/iter; left time: 3065.5494s
	iters: 300, epoch: 3 | loss: 0.2412553
	speed: 0.5486s/iter; left time: 2847.8316s
Epoch: 3 cost time: 169.5880196094513
Epoch: 3, Steps: 305 | Train Loss: 0.2532126 Vali Loss: 0.2404036 Test Loss: 0.4009415
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2388465
	speed: 0.5559s/iter; left time: 2827.2371s
	iters: 200, epoch: 4 | loss: 0.2266127
	speed: 0.5481s/iter; left time: 2732.8951s
	iters: 300, epoch: 4 | loss: 0.2274488
	speed: 0.5839s/iter; left time: 2852.9344s
Epoch: 4 cost time: 170.7230920791626
Epoch: 4, Steps: 305 | Train Loss: 0.2392397 Vali Loss: 0.2532261 Test Loss: 0.4274905
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.2342043
	speed: 0.5545s/iter; left time: 2650.9980s
	iters: 200, epoch: 5 | loss: 0.2288314
	speed: 0.5373s/iter; left time: 2515.1732s
	iters: 300, epoch: 5 | loss: 0.2258633
	speed: 0.5791s/iter; left time: 2652.7558s
Epoch: 5 cost time: 169.5946080684662
Epoch: 5, Steps: 305 | Train Loss: 0.2292300 Vali Loss: 0.2879658 Test Loss: 0.4618095
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il336_ol720_sl24_win2_fa10_dm64_nh2_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.3700955808162689, mae:0.39880868792533875
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il336_ol720_sl24_win2_fa10_dm64_nh2_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9745
val 1441
test 2161
	iters: 100, epoch: 1 | loss: 0.3219503
	speed: 0.4377s/iter; left time: 2626.3874s
	iters: 200, epoch: 1 | loss: 0.3057007
	speed: 0.5867s/iter; left time: 3461.9007s
	iters: 300, epoch: 1 | loss: 0.2935076
	speed: 0.5962s/iter; left time: 3458.6984s
Epoch: 1 cost time: 165.07858419418335
Epoch: 1, Steps: 305 | Train Loss: 0.3627300 Vali Loss: 0.2455332 Test Loss: 0.4045711
Validation loss decreased (inf --> 0.245533).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2606847
	speed: 0.5592s/iter; left time: 3185.0326s
	iters: 200, epoch: 2 | loss: 0.2684896
	speed: 0.5945s/iter; left time: 3327.0486s
	iters: 300, epoch: 2 | loss: 0.2605941
	speed: 0.5615s/iter; left time: 3085.7657s
Epoch: 2 cost time: 175.13296461105347
Epoch: 2, Steps: 305 | Train Loss: 0.2708429 Vali Loss: 0.2338963 Test Loss: 0.3742777
Validation loss decreased (0.245533 --> 0.233896).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2426065
	speed: 0.5889s/iter; left time: 3174.9902s
	iters: 200, epoch: 3 | loss: 0.2548398
	speed: 0.5644s/iter; left time: 2986.0091s
	iters: 300, epoch: 3 | loss: 0.2547271
	speed: 0.5419s/iter; left time: 2813.1070s
Epoch: 3 cost time: 171.01383709907532
Epoch: 3, Steps: 305 | Train Loss: 0.2533110 Vali Loss: 0.2401760 Test Loss: 0.3647573
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2404497
	speed: 0.5843s/iter; left time: 2971.5812s
	iters: 200, epoch: 4 | loss: 0.2397173
	speed: 0.5373s/iter; left time: 2679.1917s
	iters: 300, epoch: 4 | loss: 0.2322987
	speed: 0.5943s/iter; left time: 2903.6348s
Epoch: 4 cost time: 174.46191596984863
Epoch: 4, Steps: 305 | Train Loss: 0.2388530 Vali Loss: 0.2433452 Test Loss: 0.3883102
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.2284651
	speed: 0.5883s/iter; left time: 2812.7746s
	iters: 200, epoch: 5 | loss: 0.2280226
	speed: 0.6095s/iter; left time: 2853.2206s
	iters: 300, epoch: 5 | loss: 0.2215154
	speed: 0.6122s/iter; left time: 2804.5356s
Epoch: 5 cost time: 183.5859305858612
Epoch: 5, Steps: 305 | Train Loss: 0.2274427 Vali Loss: 0.2698929 Test Loss: 0.4319544
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il336_ol720_sl24_win2_fa10_dm64_nh2_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.3750373423099518, mae:0.4015856683254242
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il336_ol720_sl24_win2_fa10_dm64_nh2_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9745
val 1441
test 2161
	iters: 100, epoch: 1 | loss: 0.3239605
	speed: 0.5896s/iter; left time: 3538.0052s
	iters: 200, epoch: 1 | loss: 0.3083925
	speed: 0.4681s/iter; left time: 2762.2323s
	iters: 300, epoch: 1 | loss: 0.2666769
	speed: 0.6036s/iter; left time: 3501.7127s
Epoch: 1 cost time: 169.34018301963806
Epoch: 1, Steps: 305 | Train Loss: 0.3611183 Vali Loss: 0.2434162 Test Loss: 0.4038450
Validation loss decreased (inf --> 0.243416).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2714815
	speed: 0.6583s/iter; left time: 3749.9194s
	iters: 200, epoch: 2 | loss: 0.2749780
	speed: 0.6334s/iter; left time: 3544.5838s
	iters: 300, epoch: 2 | loss: 0.2589342
	speed: 0.6343s/iter; left time: 3486.3291s
Epoch: 2 cost time: 195.74479985237122
Epoch: 2, Steps: 305 | Train Loss: 0.2688941 Vali Loss: 0.2371884 Test Loss: 0.3838243
Validation loss decreased (0.243416 --> 0.237188).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2473523
	speed: 0.6465s/iter; left time: 3485.5078s
	iters: 200, epoch: 3 | loss: 0.2324774
	speed: 0.6165s/iter; left time: 3261.9202s
	iters: 300, epoch: 3 | loss: 0.2415254
	speed: 0.6183s/iter; left time: 3209.5916s
Epoch: 3 cost time: 191.27038550376892
Epoch: 3, Steps: 305 | Train Loss: 0.2480950 Vali Loss: 0.2533311 Test Loss: 0.4210484
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2505600
	speed: 0.6409s/iter; left time: 3259.8511s
	iters: 200, epoch: 4 | loss: 0.2355782
	speed: 0.6050s/iter; left time: 3016.3021s
	iters: 300, epoch: 4 | loss: 0.2271050
	speed: 0.6153s/iter; left time: 3006.1878s
Epoch: 4 cost time: 189.37183499336243
Epoch: 4, Steps: 305 | Train Loss: 0.2321580 Vali Loss: 0.2702320 Test Loss: 0.4966595
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.2243451
	speed: 0.6519s/iter; left time: 3116.9704s
	iters: 200, epoch: 5 | loss: 0.2115175
	speed: 0.6290s/iter; left time: 2944.5396s
	iters: 300, epoch: 5 | loss: 0.2202940
	speed: 0.6242s/iter; left time: 2859.4332s
Epoch: 5 cost time: 193.6065695285797
Epoch: 5, Steps: 305 | Train Loss: 0.2218446 Vali Loss: 0.2902815 Test Loss: 0.4770415
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il336_ol720_sl24_win2_fa10_dm64_nh2_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.3846849799156189, mae:0.40548181533813477
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il336_ol720_sl24_win2_fa10_dm64_nh2_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9745
val 1441
test 2161
	iters: 100, epoch: 1 | loss: 0.3238698
	speed: 0.6123s/iter; left time: 3674.4500s
	iters: 200, epoch: 1 | loss: 0.2879901
	speed: 0.5618s/iter; left time: 3314.9784s
	iters: 300, epoch: 1 | loss: 0.2823775
	speed: 0.5160s/iter; left time: 2993.4844s
Epoch: 1 cost time: 172.11760139465332
Epoch: 1, Steps: 305 | Train Loss: 0.3610603 Vali Loss: 0.2669054 Test Loss: 0.3940895
Validation loss decreased (inf --> 0.266905).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2930647
	speed: 0.6024s/iter; left time: 3431.1944s
	iters: 200, epoch: 2 | loss: 0.2641111
	speed: 0.6185s/iter; left time: 3461.0979s
	iters: 300, epoch: 2 | loss: 0.2542589
	speed: 0.6327s/iter; left time: 3477.0523s
Epoch: 2 cost time: 187.82253980636597
Epoch: 2, Steps: 305 | Train Loss: 0.2700604 Vali Loss: 0.2439461 Test Loss: 0.3736062
Validation loss decreased (0.266905 --> 0.243946).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2532218
	speed: 0.6329s/iter; left time: 3412.1768s
	iters: 200, epoch: 3 | loss: 0.2542511
	speed: 0.6188s/iter; left time: 3274.1304s
	iters: 300, epoch: 3 | loss: 0.2444091
	speed: 0.6089s/iter; left time: 3161.0516s
Epoch: 3 cost time: 189.16670751571655
Epoch: 3, Steps: 305 | Train Loss: 0.2506180 Vali Loss: 0.2496810 Test Loss: 0.4086870
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2453086
	speed: 0.6045s/iter; left time: 3074.3164s
	iters: 200, epoch: 4 | loss: 0.2386588
	speed: 0.5873s/iter; left time: 2928.4445s
	iters: 300, epoch: 4 | loss: 0.2419621
	speed: 0.6077s/iter; left time: 2969.0510s
Epoch: 4 cost time: 183.77866864204407
Epoch: 4, Steps: 305 | Train Loss: 0.2364420 Vali Loss: 0.2481529 Test Loss: 0.4440954
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.2254763
	speed: 0.4477s/iter; left time: 2140.6711s
	iters: 200, epoch: 5 | loss: 0.2226520
	speed: 0.5695s/iter; left time: 2666.0317s
	iters: 300, epoch: 5 | loss: 0.2300725
	speed: 0.5575s/iter; left time: 2553.7051s
Epoch: 5 cost time: 160.09622526168823
Epoch: 5, Steps: 305 | Train Loss: 0.2273882 Vali Loss: 0.2532693 Test Loss: 0.5256909
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il336_ol720_sl24_win2_fa10_dm64_nh2_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.37430477142333984, mae:0.39972126483917236
