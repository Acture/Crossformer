Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=128, d_model=64, data='electricity', data_dim=321, data_path='electricity.csv', data_split=[10800, 2160, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=48, itr=5, learning_rate=0.0005, lradj='fixed', n_heads=2, num_workers=0, out_len=720, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il48_ol720_sl24_win2_fa10_dm64_nh2_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10033
val 1441
test 2161
	iters: 100, epoch: 1 | loss: 0.3821490
	speed: 0.6050s/iter; left time: 3739.2204s
	iters: 200, epoch: 1 | loss: 0.3438712
	speed: 0.5906s/iter; left time: 3591.3699s
	iters: 300, epoch: 1 | loss: 0.3167905
	speed: 0.5668s/iter; left time: 3390.1047s
Epoch: 1 cost time: 183.77408361434937
Epoch: 1, Steps: 314 | Train Loss: 0.4196722 Vali Loss: 0.2896291 Test Loss: 0.4516348
Validation loss decreased (inf --> 0.289629).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3005327
	speed: 0.5630s/iter; left time: 3302.8940s
	iters: 200, epoch: 2 | loss: 0.2995726
	speed: 0.4347s/iter; left time: 2506.8569s
	iters: 300, epoch: 2 | loss: 0.2898862
	speed: 0.4979s/iter; left time: 2821.6511s
Epoch: 2 cost time: 157.08035969734192
Epoch: 2, Steps: 314 | Train Loss: 0.3075068 Vali Loss: 0.2919583 Test Loss: 0.4106287
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.2798339
	speed: 0.5437s/iter; left time: 3019.3891s
	iters: 200, epoch: 3 | loss: 0.2901657
	speed: 0.5810s/iter; left time: 3168.1964s
	iters: 300, epoch: 3 | loss: 0.2811269
	speed: 0.5490s/iter; left time: 2938.7956s
Epoch: 3 cost time: 176.1077527999878
Epoch: 3, Steps: 314 | Train Loss: 0.2858745 Vali Loss: 0.3045262 Test Loss: 0.4153932
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2645405
	speed: 0.5669s/iter; left time: 2969.8089s
	iters: 200, epoch: 4 | loss: 0.2626137
	speed: 0.5558s/iter; left time: 2856.2519s
	iters: 300, epoch: 4 | loss: 0.2617497
	speed: 0.5640s/iter; left time: 2842.2252s
Epoch: 4 cost time: 176.27870965003967
Epoch: 4, Steps: 314 | Train Loss: 0.2686887 Vali Loss: 0.3274767 Test Loss: 0.4823007
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il48_ol720_sl24_win2_fa10_dm64_nh2_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.45238742232322693, mae:0.45583558082580566
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il48_ol720_sl24_win2_fa10_dm64_nh2_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10033
val 1441
test 2161
	iters: 100, epoch: 1 | loss: 0.3614241
	speed: 0.5519s/iter; left time: 3411.3851s
	iters: 200, epoch: 1 | loss: 0.3391843
	speed: 0.5607s/iter; left time: 3409.4741s
	iters: 300, epoch: 1 | loss: 0.3307345
	speed: 0.3672s/iter; left time: 2196.2701s
Epoch: 1 cost time: 155.32224988937378
Epoch: 1, Steps: 314 | Train Loss: 0.4183775 Vali Loss: 0.2928624 Test Loss: 0.4462563
Validation loss decreased (inf --> 0.292862).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3170488
	speed: 0.5016s/iter; left time: 2942.7142s
	iters: 200, epoch: 2 | loss: 0.3017625
	speed: 0.5193s/iter; left time: 2994.7170s
	iters: 300, epoch: 2 | loss: 0.2910737
	speed: 0.5259s/iter; left time: 2980.0656s
Epoch: 2 cost time: 161.63779592514038
Epoch: 2, Steps: 314 | Train Loss: 0.3063081 Vali Loss: 0.2789381 Test Loss: 0.4293152
Validation loss decreased (0.292862 --> 0.278938).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2867162
	speed: 0.5381s/iter; left time: 2988.0464s
	iters: 200, epoch: 3 | loss: 0.2849833
	speed: 0.5144s/iter; left time: 2804.7515s
	iters: 300, epoch: 3 | loss: 0.2663206
	speed: 0.5710s/iter; left time: 3056.7375s
Epoch: 3 cost time: 169.3371922969818
Epoch: 3, Steps: 314 | Train Loss: 0.2832473 Vali Loss: 0.3153062 Test Loss: 0.4999978
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2613757
	speed: 0.5409s/iter; left time: 2833.9706s
	iters: 200, epoch: 4 | loss: 0.2568665
	speed: 0.5174s/iter; left time: 2659.0198s
	iters: 300, epoch: 4 | loss: 0.2685568
	speed: 0.5460s/iter; left time: 2751.3243s
Epoch: 4 cost time: 164.04141974449158
Epoch: 4, Steps: 314 | Train Loss: 0.2653773 Vali Loss: 0.3322615 Test Loss: 0.4724978
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.2644765
	speed: 0.5195s/iter; left time: 2558.4662s
	iters: 200, epoch: 5 | loss: 0.2603546
	speed: 0.4928s/iter; left time: 2377.6268s
	iters: 300, epoch: 5 | loss: 0.2667911
	speed: 0.4784s/iter; left time: 2260.3549s
Epoch: 5 cost time: 157.5543248653412
Epoch: 5, Steps: 314 | Train Loss: 0.2539234 Vali Loss: 0.3211081 Test Loss: 0.5789082
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il48_ol720_sl24_win2_fa10_dm64_nh2_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.43004801869392395, mae:0.43996065855026245
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il48_ol720_sl24_win2_fa10_dm64_nh2_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10033
val 1441
test 2161
	iters: 100, epoch: 1 | loss: 0.3863058
	speed: 0.5089s/iter; left time: 3145.4917s
	iters: 200, epoch: 1 | loss: 0.3612067
	speed: 0.4963s/iter; left time: 3017.8247s
	iters: 300, epoch: 1 | loss: 0.3162982
	speed: 0.4939s/iter; left time: 2953.7823s
Epoch: 1 cost time: 156.23195886611938
Epoch: 1, Steps: 314 | Train Loss: 0.4192815 Vali Loss: 0.2840340 Test Loss: 0.4570829
Validation loss decreased (inf --> 0.284034).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3061381
	speed: 0.4751s/iter; left time: 2787.5845s
	iters: 200, epoch: 2 | loss: 0.3128673
	speed: 0.3762s/iter; left time: 2169.6996s
	iters: 300, epoch: 2 | loss: 0.2867002
	speed: 0.4821s/iter; left time: 2731.9692s
Epoch: 2 cost time: 140.1636106967926
Epoch: 2, Steps: 314 | Train Loss: 0.3068255 Vali Loss: 0.2735177 Test Loss: 0.4626723
Validation loss decreased (0.284034 --> 0.273518).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2967940
	speed: 0.5170s/iter; left time: 2871.0635s
	iters: 200, epoch: 3 | loss: 0.2786249
	speed: 0.5227s/iter; left time: 2850.2156s
	iters: 300, epoch: 3 | loss: 0.2702439
	speed: 0.5283s/iter; left time: 2828.0421s
Epoch: 3 cost time: 163.89085483551025
Epoch: 3, Steps: 314 | Train Loss: 0.2835949 Vali Loss: 0.3131114 Test Loss: 0.4746609
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2643421
	speed: 0.5229s/iter; left time: 2739.5079s
	iters: 200, epoch: 4 | loss: 0.2678245
	speed: 0.5438s/iter; left time: 2794.7552s
	iters: 300, epoch: 4 | loss: 0.2623353
	speed: 0.5040s/iter; left time: 2539.6415s
Epoch: 4 cost time: 164.3993034362793
Epoch: 4, Steps: 314 | Train Loss: 0.2655907 Vali Loss: 0.3391163 Test Loss: 0.4819854
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.2578315
	speed: 0.4002s/iter; left time: 1971.2131s
	iters: 200, epoch: 5 | loss: 0.2548511
	speed: 0.4719s/iter; left time: 2276.9524s
	iters: 300, epoch: 5 | loss: 0.2483876
	speed: 0.5488s/iter; left time: 2592.8734s
Epoch: 5 cost time: 147.71352863311768
Epoch: 5, Steps: 314 | Train Loss: 0.2556213 Vali Loss: 0.3443567 Test Loss: 0.4854863
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il48_ol720_sl24_win2_fa10_dm64_nh2_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.4638092517852783, mae:0.460517555475235
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il48_ol720_sl24_win2_fa10_dm64_nh2_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10033
val 1441
test 2161
	iters: 100, epoch: 1 | loss: 0.3877885
	speed: 0.5545s/iter; left time: 3427.6681s
	iters: 200, epoch: 1 | loss: 0.3416486
	speed: 0.5244s/iter; left time: 3188.8401s
	iters: 300, epoch: 1 | loss: 0.3123430
	speed: 0.5526s/iter; left time: 3305.1211s
Epoch: 1 cost time: 172.23746991157532
Epoch: 1, Steps: 314 | Train Loss: 0.4228939 Vali Loss: 0.2827418 Test Loss: 0.4570966
Validation loss decreased (inf --> 0.282742).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3212804
	speed: 0.5365s/iter; left time: 3147.6588s
	iters: 200, epoch: 2 | loss: 0.3100135
	speed: 0.5377s/iter; left time: 3100.6522s
	iters: 300, epoch: 2 | loss: 0.2976550
	speed: 0.5330s/iter; left time: 3020.2820s
Epoch: 2 cost time: 168.8315143585205
Epoch: 2, Steps: 314 | Train Loss: 0.3056627 Vali Loss: 0.2798884 Test Loss: 0.4541295
Validation loss decreased (0.282742 --> 0.279888).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2722061
	speed: 0.5513s/iter; left time: 3061.1897s
	iters: 200, epoch: 3 | loss: 0.2752499
	speed: 0.3785s/iter; left time: 2064.0296s
	iters: 300, epoch: 3 | loss: 0.2750750
	speed: 0.5381s/iter; left time: 2880.6017s
Epoch: 3 cost time: 156.80882835388184
Epoch: 3, Steps: 314 | Train Loss: 0.2812256 Vali Loss: 0.3181927 Test Loss: 0.4740314
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2827812
	speed: 0.5849s/iter; left time: 3064.3214s
	iters: 200, epoch: 4 | loss: 0.2621374
	speed: 0.5490s/iter; left time: 2821.0644s
	iters: 300, epoch: 4 | loss: 0.2607035
	speed: 0.5489s/iter; left time: 2766.1455s
Epoch: 4 cost time: 175.40449118614197
Epoch: 4, Steps: 314 | Train Loss: 0.2644955 Vali Loss: 0.3308971 Test Loss: 0.4604806
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.2627282
	speed: 0.5624s/iter; left time: 2769.9986s
	iters: 200, epoch: 5 | loss: 0.2542589
	speed: 0.5246s/iter; left time: 2531.1062s
	iters: 300, epoch: 5 | loss: 0.2455064
	speed: 0.5458s/iter; left time: 2578.8150s
Epoch: 5 cost time: 169.7738959789276
Epoch: 5, Steps: 314 | Train Loss: 0.2537108 Vali Loss: 0.3311158 Test Loss: 0.4879997
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il48_ol720_sl24_win2_fa10_dm64_nh2_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.45517078042030334, mae:0.4543692171573639
Use GPU: cuda:0
>>>>>>>start training : Crossformer_electricity_il48_ol720_sl24_win2_fa10_dm64_nh2_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10033
val 1441
test 2161
	iters: 100, epoch: 1 | loss: 0.3653316
	speed: 0.5131s/iter; left time: 3171.4912s
	iters: 200, epoch: 1 | loss: 0.3473393
	speed: 0.5007s/iter; left time: 3044.7448s
	iters: 300, epoch: 1 | loss: 0.3228085
	speed: 0.5239s/iter; left time: 3133.4537s
Epoch: 1 cost time: 159.94013667106628
Epoch: 1, Steps: 314 | Train Loss: 0.4150291 Vali Loss: 0.2945219 Test Loss: 0.4446280
Validation loss decreased (inf --> 0.294522).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3200288
	speed: 0.5540s/iter; left time: 3250.3081s
	iters: 200, epoch: 2 | loss: 0.2788637
	speed: 0.3556s/iter; left time: 2050.7288s
	iters: 300, epoch: 2 | loss: 0.2961282
	speed: 0.5149s/iter; left time: 2918.1053s
Epoch: 2 cost time: 149.62359857559204
Epoch: 2, Steps: 314 | Train Loss: 0.3059033 Vali Loss: 0.2707805 Test Loss: 0.4538601
Validation loss decreased (0.294522 --> 0.270780).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2828392
	speed: 0.5175s/iter; left time: 2873.8168s
	iters: 200, epoch: 3 | loss: 0.2999348
	speed: 0.5187s/iter; left time: 2828.7393s
	iters: 300, epoch: 3 | loss: 0.2724729
	speed: 0.4910s/iter; left time: 2628.3282s
Epoch: 3 cost time: 159.731125831604
Epoch: 3, Steps: 314 | Train Loss: 0.2835901 Vali Loss: 0.2960181 Test Loss: 0.4682230
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2744717
	speed: 0.5150s/iter; left time: 2698.2405s
	iters: 200, epoch: 4 | loss: 0.2564999
	speed: 0.5190s/iter; left time: 2666.8914s
	iters: 300, epoch: 4 | loss: 0.2571657
	speed: 0.5231s/iter; left time: 2636.0779s
Epoch: 4 cost time: 160.77698349952698
Epoch: 4, Steps: 314 | Train Loss: 0.2672199 Vali Loss: 0.3381450 Test Loss: 0.4803605
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.2545455
	speed: 0.4604s/iter; left time: 2267.5675s
	iters: 200, epoch: 5 | loss: 0.2510186
	speed: 0.4849s/iter; left time: 2339.5459s
	iters: 300, epoch: 5 | loss: 0.2578189
	speed: 0.4377s/iter; left time: 2068.1025s
Epoch: 5 cost time: 144.0343611240387
Epoch: 5, Steps: 314 | Train Loss: 0.2548316 Vali Loss: 0.3578083 Test Loss: 0.4971695
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_electricity_il48_ol720_sl24_win2_fa10_dm64_nh2_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.4549359977245331, mae:0.45594164729118347
