Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh2', data_dim=7, data_path='ETTh2.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=192, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=720, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il192_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7729
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6961498
	speed: 0.2971s/iter; left time: 1408.6868s
	iters: 200, epoch: 1 | loss: 0.3627589
	speed: 0.1647s/iter; left time: 764.1571s
Epoch: 1 cost time: 53.259602546691895
Epoch: 1, Steps: 242 | Train Loss: 0.7368984 Vali Loss: 1.5296759 Test Loss: 2.9549484
Validation loss decreased (inf --> 1.529676).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6440951
	speed: 0.1618s/iter; left time: 727.9822s
	iters: 200, epoch: 2 | loss: 0.6075432
	speed: 0.1686s/iter; left time: 741.7767s
Epoch: 2 cost time: 43.55831599235535
Epoch: 2, Steps: 242 | Train Loss: 0.4637855 Vali Loss: 1.9154280 Test Loss: 4.1540365
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5090310
	speed: 0.3479s/iter; left time: 1480.9727s
	iters: 200, epoch: 3 | loss: 0.3291662
	speed: 0.2329s/iter; left time: 968.0414s
Epoch: 3 cost time: 64.93056321144104
Epoch: 3, Steps: 242 | Train Loss: 0.3938346 Vali Loss: 2.5322087 Test Loss: 5.3582706
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.4009558
	speed: 0.1605s/iter; left time: 644.4078s
	iters: 200, epoch: 4 | loss: 0.4280404
	speed: 0.1739s/iter; left time: 680.7481s
Epoch: 4 cost time: 42.05045533180237
Epoch: 4, Steps: 242 | Train Loss: 0.3674498 Vali Loss: 2.6104950 Test Loss: 5.8130215
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il192_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:2.952463150024414, mae:1.4843502044677734
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il192_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7729
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.8324149
	speed: 0.3231s/iter; left time: 1531.6460s
	iters: 200, epoch: 1 | loss: 0.7707971
	speed: 0.3432s/iter; left time: 1592.9100s
Epoch: 1 cost time: 76.83043074607849
Epoch: 1, Steps: 242 | Train Loss: 0.7448656 Vali Loss: 1.0819015 Test Loss: 3.1130571
Validation loss decreased (inf --> 1.081901).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4340342
	speed: 0.1795s/iter; left time: 807.5786s
	iters: 200, epoch: 2 | loss: 0.3482520
	speed: 0.1612s/iter; left time: 709.2940s
Epoch: 2 cost time: 40.9528911113739
Epoch: 2, Steps: 242 | Train Loss: 0.4684760 Vali Loss: 0.8527840 Test Loss: 3.7910970
Validation loss decreased (1.081901 --> 0.852784).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3509659
	speed: 0.2225s/iter; left time: 947.1539s
	iters: 200, epoch: 3 | loss: 0.3299735
	speed: 0.2342s/iter; left time: 973.3928s
Epoch: 3 cost time: 52.86237692832947
Epoch: 3, Steps: 242 | Train Loss: 0.4004581 Vali Loss: 0.9729070 Test Loss: 5.0174796
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.4988265
	speed: 0.1618s/iter; left time: 649.7465s
	iters: 200, epoch: 4 | loss: 0.4071167
	speed: 0.2228s/iter; left time: 872.4222s
Epoch: 4 cost time: 47.0384087562561
Epoch: 4, Steps: 242 | Train Loss: 0.3746157 Vali Loss: 0.9462819 Test Loss: 5.5018099
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3023873
	speed: 0.3817s/iter; left time: 1440.1209s
	iters: 200, epoch: 5 | loss: 0.3329587
	speed: 0.3328s/iter; left time: 1222.5169s
Epoch: 5 cost time: 86.5927243232727
Epoch: 5, Steps: 242 | Train Loss: 0.3465247 Vali Loss: 0.9975655 Test Loss: 5.3354818
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il192_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:3.7882239818573, mae:1.6636208295822144
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il192_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7729
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.7480022
	speed: 0.1628s/iter; left time: 771.6448s
	iters: 200, epoch: 1 | loss: 0.4223198
	speed: 0.1588s/iter; left time: 737.1638s
Epoch: 1 cost time: 39.29437327384949
Epoch: 1, Steps: 242 | Train Loss: 0.7237183 Vali Loss: 1.4557031 Test Loss: 3.4530624
Validation loss decreased (inf --> 1.455703).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5666366
	speed: 0.2419s/iter; left time: 1088.3736s
	iters: 200, epoch: 2 | loss: 0.3293672
	speed: 0.3138s/iter; left time: 1380.2018s
Epoch: 2 cost time: 69.82507944107056
Epoch: 2, Steps: 242 | Train Loss: 0.4589956 Vali Loss: 2.2292829 Test Loss: 4.1307747
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4344661
	speed: 0.1643s/iter; left time: 699.4112s
	iters: 200, epoch: 3 | loss: 0.2957125
	speed: 0.1671s/iter; left time: 694.5439s
Epoch: 3 cost time: 40.00529861450195
Epoch: 3, Steps: 242 | Train Loss: 0.3908034 Vali Loss: 2.7094356 Test Loss: 4.7451363
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2617300
	speed: 0.1695s/iter; left time: 680.6269s
	iters: 200, epoch: 4 | loss: 0.3105475
	speed: 0.2400s/iter; left time: 939.4617s
Epoch: 4 cost time: 55.04107141494751
Epoch: 4, Steps: 242 | Train Loss: 0.3619444 Vali Loss: 2.4990291 Test Loss: 4.7488652
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il192_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:3.447006940841675, mae:1.6138224601745605
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il192_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7729
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.7182954
	speed: 0.3760s/iter; left time: 1782.7564s
	iters: 200, epoch: 1 | loss: 0.4601575
	speed: 0.3549s/iter; left time: 1647.3200s
Epoch: 1 cost time: 86.3176805973053
Epoch: 1, Steps: 242 | Train Loss: 0.7365454 Vali Loss: 0.9503928 Test Loss: 3.5806437
Validation loss decreased (inf --> 0.950393).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5273883
	speed: 0.1665s/iter; left time: 749.1139s
	iters: 200, epoch: 2 | loss: 0.5249398
	speed: 0.1253s/iter; left time: 551.0107s
Epoch: 2 cost time: 34.502153396606445
Epoch: 2, Steps: 242 | Train Loss: 0.4675706 Vali Loss: 1.0881955 Test Loss: 4.2126039
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4553808
	speed: 0.2415s/iter; left time: 1028.1110s
	iters: 200, epoch: 3 | loss: 0.3689590
	speed: 0.2104s/iter; left time: 874.7398s
Epoch: 3 cost time: 52.79251027107239
Epoch: 3, Steps: 242 | Train Loss: 0.3991843 Vali Loss: 1.1126575 Test Loss: 4.3916095
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3571554
	speed: 0.1706s/iter; left time: 685.0743s
	iters: 200, epoch: 4 | loss: 0.3605187
	speed: 0.1727s/iter; left time: 676.0219s
Epoch: 4 cost time: 41.06760501861572
Epoch: 4, Steps: 242 | Train Loss: 0.3736669 Vali Loss: 1.1666466 Test Loss: 4.3370481
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il192_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:3.578650712966919, mae:1.6619632244110107
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il192_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7729
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5155807
	speed: 0.3150s/iter; left time: 1493.3426s
	iters: 200, epoch: 1 | loss: 0.5679330
	speed: 0.3663s/iter; left time: 1699.8654s
Epoch: 1 cost time: 83.59075951576233
Epoch: 1, Steps: 242 | Train Loss: 0.7412720 Vali Loss: 1.5921238 Test Loss: 2.5657487
Validation loss decreased (inf --> 1.592124).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6235762
	speed: 0.2091s/iter; left time: 940.7120s
	iters: 200, epoch: 2 | loss: 0.3176829
	speed: 0.1597s/iter; left time: 702.6633s
Epoch: 2 cost time: 43.91661214828491
Epoch: 2, Steps: 242 | Train Loss: 0.4616163 Vali Loss: 2.5624440 Test Loss: 4.6246544
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3461715
	speed: 0.1720s/iter; left time: 732.1884s
	iters: 200, epoch: 3 | loss: 0.4418073
	speed: 0.2545s/iter; left time: 1057.7880s
Epoch: 3 cost time: 53.221304416656494
Epoch: 3, Steps: 242 | Train Loss: 0.3906055 Vali Loss: 2.2046246 Test Loss: 3.7529512
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3519155
	speed: 0.2241s/iter; left time: 899.6181s
	iters: 200, epoch: 4 | loss: 0.3493508
	speed: 0.2661s/iter; left time: 1041.6906s
Epoch: 4 cost time: 58.95664048194885
Epoch: 4, Steps: 242 | Train Loss: 0.3636152 Vali Loss: 2.6042486 Test Loss: 4.7778913
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il192_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:2.5619561672210693, mae:1.3697980642318726
