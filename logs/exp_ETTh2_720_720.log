Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=128, d_model=64, data='ETTh2', data_dim=7, data_path='ETTh1.csv', data_split=[0.7, 0.1, 0.2], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=720, itr=5, learning_rate=5e-05, lradj='fixed', n_heads=2, num_workers=0, out_len=720, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10755
val 1023
test 2765
	iters: 100, epoch: 1 | loss: 1.0831438
	speed: 0.1077s/iter; left time: 715.3362s
	iters: 200, epoch: 1 | loss: 0.9520041
	speed: 0.0730s/iter; left time: 477.5611s
	iters: 300, epoch: 1 | loss: 0.8063232
	speed: 0.0952s/iter; left time: 613.4564s
Epoch: 1 cost time: 31.140265941619873
Epoch: 1, Steps: 337 | Train Loss: 1.0158221 Vali Loss: 0.4824567 Test Loss: 0.7132682
Validation loss decreased (inf --> 0.482457).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6584655
	speed: 0.1714s/iter; left time: 1080.4008s
	iters: 200, epoch: 2 | loss: 0.6102572
	speed: 0.1293s/iter; left time: 802.1106s
	iters: 300, epoch: 2 | loss: 0.5030038
	speed: 0.0962s/iter; left time: 587.3686s
Epoch: 2 cost time: 43.62748456001282
Epoch: 2, Steps: 337 | Train Loss: 0.6302393 Vali Loss: 0.4894958 Test Loss: 0.7194660
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.6212553
	speed: 0.1572s/iter; left time: 938.0336s
	iters: 200, epoch: 3 | loss: 0.6356184
	speed: 0.0952s/iter; left time: 558.7939s
	iters: 300, epoch: 3 | loss: 0.6071298
	speed: 0.0947s/iter; left time: 546.1970s
Epoch: 3 cost time: 40.32534146308899
Epoch: 3, Steps: 337 | Train Loss: 0.5717417 Vali Loss: 0.5578070 Test Loss: 0.7190672
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.5517129
	speed: 0.1556s/iter; left time: 876.1185s
	iters: 200, epoch: 4 | loss: 0.5483388
	speed: 0.1095s/iter; left time: 605.3283s
	iters: 300, epoch: 4 | loss: 0.5587050
	speed: 0.1750s/iter; left time: 950.1506s
Epoch: 4 cost time: 51.24556374549866
Epoch: 4, Steps: 337 | Train Loss: 0.5329387 Vali Loss: 0.6504925 Test Loss: 0.7477784
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2765
mse:0.7143214344978333, mae:0.6454876661300659
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10755
val 1023
test 2765
	iters: 100, epoch: 1 | loss: 1.0824014
	speed: 0.0972s/iter; left time: 645.2204s
	iters: 200, epoch: 1 | loss: 0.7845507
	speed: 0.1145s/iter; left time: 749.1237s
	iters: 300, epoch: 1 | loss: 0.6807279
	speed: 0.1638s/iter; left time: 1055.0579s
Epoch: 1 cost time: 43.41474509239197
Epoch: 1, Steps: 337 | Train Loss: 1.0042418 Vali Loss: 0.4799293 Test Loss: 0.7316790
Validation loss decreased (inf --> 0.479929).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7096187
	speed: 0.1541s/iter; left time: 971.3515s
	iters: 200, epoch: 2 | loss: 0.5815879
	speed: 0.1852s/iter; left time: 1148.9197s
	iters: 300, epoch: 2 | loss: 0.5699496
	speed: 0.1057s/iter; left time: 645.2785s
Epoch: 2 cost time: 48.023072242736816
Epoch: 2, Steps: 337 | Train Loss: 0.6236141 Vali Loss: 0.4819104 Test Loss: 0.7293755
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.5892355
	speed: 0.0973s/iter; left time: 580.6102s
	iters: 200, epoch: 3 | loss: 0.5766155
	speed: 0.1814s/iter; left time: 1064.0078s
	iters: 300, epoch: 3 | loss: 0.5306479
	speed: 0.1601s/iter; left time: 923.5699s
Epoch: 3 cost time: 47.57805585861206
Epoch: 3, Steps: 337 | Train Loss: 0.5665933 Vali Loss: 0.5024558 Test Loss: 0.7037622
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.5255492
	speed: 0.1770s/iter; left time: 996.3089s
	iters: 200, epoch: 4 | loss: 0.4944766
	speed: 0.1158s/iter; left time: 640.4174s
	iters: 300, epoch: 4 | loss: 0.5429371
	speed: 0.0948s/iter; left time: 514.6493s
Epoch: 4 cost time: 42.223544120788574
Epoch: 4, Steps: 337 | Train Loss: 0.5301331 Vali Loss: 0.5307131 Test Loss: 0.6980353
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2765
mse:0.7329303622245789, mae:0.6510841250419617
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10755
val 1023
test 2765
	iters: 100, epoch: 1 | loss: 1.0033273
	speed: 0.1661s/iter; left time: 1103.1098s
	iters: 200, epoch: 1 | loss: 0.8346835
	speed: 0.1185s/iter; left time: 774.7957s
	iters: 300, epoch: 1 | loss: 0.7440382
	speed: 0.1804s/iter; left time: 1162.1635s
Epoch: 1 cost time: 52.59591865539551
Epoch: 1, Steps: 337 | Train Loss: 1.0069369 Vali Loss: 0.4814767 Test Loss: 0.7160096
Validation loss decreased (inf --> 0.481477).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6130521
	speed: 0.0972s/iter; left time: 612.9740s
	iters: 200, epoch: 2 | loss: 0.6470536
	speed: 0.0977s/iter; left time: 605.9402s
	iters: 300, epoch: 2 | loss: 0.5672342
	speed: 0.1261s/iter; left time: 769.9782s
Epoch: 2 cost time: 39.59319591522217
Epoch: 2, Steps: 337 | Train Loss: 0.6323933 Vali Loss: 0.4602726 Test Loss: 0.6906233
Validation loss decreased (0.481477 --> 0.460273).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6296592
	speed: 0.1574s/iter; left time: 939.3518s
	iters: 200, epoch: 3 | loss: 0.5783298
	speed: 0.1988s/iter; left time: 1166.6180s
	iters: 300, epoch: 3 | loss: 0.5597069
	speed: 0.1229s/iter; left time: 708.5618s
Epoch: 3 cost time: 51.40264105796814
Epoch: 3, Steps: 337 | Train Loss: 0.5795532 Vali Loss: 0.4822584 Test Loss: 0.7108916
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.5756486
	speed: 0.0971s/iter; left time: 546.4283s
	iters: 200, epoch: 4 | loss: 0.5126746
	speed: 0.0945s/iter; left time: 522.3686s
	iters: 300, epoch: 4 | loss: 0.5159047
	speed: 0.1763s/iter; left time: 957.0776s
Epoch: 4 cost time: 43.6148042678833
Epoch: 4, Steps: 337 | Train Loss: 0.5421917 Vali Loss: 0.5863670 Test Loss: 0.7619495
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.5206755
	speed: 0.1760s/iter; left time: 931.6766s
	iters: 200, epoch: 5 | loss: 0.5334978
	speed: 0.1377s/iter; left time: 715.2074s
	iters: 300, epoch: 5 | loss: 0.5037826
	speed: 0.0943s/iter; left time: 480.2892s
Epoch: 5 cost time: 44.309590578079224
Epoch: 5, Steps: 337 | Train Loss: 0.5143731 Vali Loss: 0.6749400 Test Loss: 0.8002024
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2765
mse:0.6920533180236816, mae:0.6331794857978821
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10755
val 1023
test 2765
	iters: 100, epoch: 1 | loss: 0.9935479
	speed: 0.0938s/iter; left time: 623.1906s
	iters: 200, epoch: 1 | loss: 0.8019243
	speed: 0.1481s/iter; left time: 968.6800s
	iters: 300, epoch: 1 | loss: 0.7493410
	speed: 0.2311s/iter; left time: 1488.2528s
Epoch: 1 cost time: 53.52112126350403
Epoch: 1, Steps: 337 | Train Loss: 0.9958612 Vali Loss: 0.4715636 Test Loss: 0.7129658
Validation loss decreased (inf --> 0.471564).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6742446
	speed: 0.1310s/iter; left time: 825.5338s
	iters: 200, epoch: 2 | loss: 0.7572862
	speed: 0.0954s/iter; left time: 591.8446s
	iters: 300, epoch: 2 | loss: 0.6849957
	speed: 0.0948s/iter; left time: 578.5396s
Epoch: 2 cost time: 35.612492084503174
Epoch: 2, Steps: 337 | Train Loss: 0.6255185 Vali Loss: 0.4273395 Test Loss: 0.6827844
Validation loss decreased (0.471564 --> 0.427340).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6979648
	speed: 0.1155s/iter; left time: 689.0993s
	iters: 200, epoch: 3 | loss: 0.5306779
	speed: 0.1827s/iter; left time: 1071.8097s
	iters: 300, epoch: 3 | loss: 0.5953058
	speed: 0.2302s/iter; left time: 1327.4187s
Epoch: 3 cost time: 59.36092138290405
Epoch: 3, Steps: 337 | Train Loss: 0.5646747 Vali Loss: 0.5451872 Test Loss: 0.7398497
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.5220315
	speed: 0.0964s/iter; left time: 542.7515s
	iters: 200, epoch: 4 | loss: 0.5008861
	speed: 0.0949s/iter; left time: 524.8511s
	iters: 300, epoch: 4 | loss: 0.5085866
	speed: 0.0939s/iter; left time: 509.8590s
Epoch: 4 cost time: 32.07625198364258
Epoch: 4, Steps: 337 | Train Loss: 0.5287683 Vali Loss: 0.5981396 Test Loss: 0.7245220
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.5415726
	speed: 0.1541s/iter; left time: 815.8944s
	iters: 200, epoch: 5 | loss: 0.5136359
	speed: 0.2191s/iter; left time: 1137.6474s
	iters: 300, epoch: 5 | loss: 0.4418456
	speed: 0.1948s/iter; left time: 992.2332s
Epoch: 5 cost time: 62.97655367851257
Epoch: 5, Steps: 337 | Train Loss: 0.5031451 Vali Loss: 0.6659689 Test Loss: 0.7492867
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2765
mse:0.6843217611312866, mae:0.6310028433799744
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10755
val 1023
test 2765
	iters: 100, epoch: 1 | loss: 1.0904146
	speed: 0.0982s/iter; left time: 651.8283s
	iters: 200, epoch: 1 | loss: 0.7654736
	speed: 0.0978s/iter; left time: 639.8071s
	iters: 300, epoch: 1 | loss: 0.6788877
	speed: 0.0936s/iter; left time: 602.5829s
Epoch: 1 cost time: 34.844602823257446
Epoch: 1, Steps: 337 | Train Loss: 0.9945801 Vali Loss: 0.4715911 Test Loss: 0.7107148
Validation loss decreased (inf --> 0.471591).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6844164
	speed: 0.2870s/iter; left time: 1809.0007s
	iters: 200, epoch: 2 | loss: 0.6144795
	speed: 0.1958s/iter; left time: 1214.8820s
	iters: 300, epoch: 2 | loss: 0.5941235
	speed: 0.0765s/iter; left time: 467.1712s
Epoch: 2 cost time: 58.52641940116882
Epoch: 2, Steps: 337 | Train Loss: 0.6221280 Vali Loss: 0.4616236 Test Loss: 0.6846700
Validation loss decreased (0.471591 --> 0.461624).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5755071
	speed: 0.0744s/iter; left time: 444.2176s
	iters: 200, epoch: 3 | loss: 0.5959767
	speed: 0.0951s/iter; left time: 558.0492s
	iters: 300, epoch: 3 | loss: 0.5051391
	speed: 0.0942s/iter; left time: 543.1777s
Epoch: 3 cost time: 30.047837495803833
Epoch: 3, Steps: 337 | Train Loss: 0.5696572 Vali Loss: 0.5971011 Test Loss: 0.7266003
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.5382208
	speed: 0.2066s/iter; left time: 1163.0090s
	iters: 200, epoch: 4 | loss: 0.5299616
	speed: 0.2081s/iter; left time: 1150.8089s
	iters: 300, epoch: 4 | loss: 0.4791722
	speed: 0.1348s/iter; left time: 731.8955s
Epoch: 4 cost time: 58.436911821365356
Epoch: 4, Steps: 337 | Train Loss: 0.5310617 Vali Loss: 0.7991495 Test Loss: 0.8115915
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.4710676
	speed: 0.0944s/iter; left time: 499.4562s
	iters: 200, epoch: 5 | loss: 0.5436467
	speed: 0.0955s/iter; left time: 496.1882s
	iters: 300, epoch: 5 | loss: 0.4940949
	speed: 0.0973s/iter; left time: 495.4052s
Epoch: 5 cost time: 35.83094024658203
Epoch: 5, Steps: 337 | Train Loss: 0.5054731 Vali Loss: 0.8823876 Test Loss: 0.8322564
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2765
mse:0.6854714155197144, mae:0.6286261081695557
