Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTm1', data_dim=7, data_path='ETTm1.csv', data_split=[34560, 11520, 11520], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=24, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=96, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTm1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34441
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.5331677
	speed: 0.3736s/iter; left time: 8011.2585s
	iters: 200, epoch: 1 | loss: 0.5323610
	speed: 0.1702s/iter; left time: 3633.1003s
	iters: 300, epoch: 1 | loss: 0.5023993
	speed: 0.0936s/iter; left time: 1988.5683s
	iters: 400, epoch: 1 | loss: 0.4118633
	speed: 0.0951s/iter; left time: 2009.9943s
	iters: 500, epoch: 1 | loss: 0.4040955
	speed: 0.0998s/iter; left time: 2099.4790s
	iters: 600, epoch: 1 | loss: 0.3639982
	speed: 0.1209s/iter; left time: 2531.2350s
	iters: 700, epoch: 1 | loss: 0.3702440
	speed: 0.1209s/iter; left time: 2519.1433s
	iters: 800, epoch: 1 | loss: 0.3392791
	speed: 0.1092s/iter; left time: 2265.1446s
	iters: 900, epoch: 1 | loss: 0.3400042
	speed: 0.0942s/iter; left time: 1945.3813s
	iters: 1000, epoch: 1 | loss: 0.3922303
	speed: 0.1083s/iter; left time: 2225.2725s
Epoch: 1 cost time: 158.33638334274292
Epoch: 1, Steps: 1077 | Train Loss: 0.4448972 Vali Loss: 0.7467264 Test Loss: 0.6006496
Validation loss decreased (inf --> 0.746726).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4202309
	speed: 0.2237s/iter; left time: 4555.8655s
	iters: 200, epoch: 2 | loss: 0.3588935
	speed: 0.1038s/iter; left time: 2102.7570s
	iters: 300, epoch: 2 | loss: 0.3648483
	speed: 0.1012s/iter; left time: 2040.4598s
	iters: 400, epoch: 2 | loss: 0.3324147
	speed: 0.0928s/iter; left time: 1862.7763s
	iters: 500, epoch: 2 | loss: 0.2887616
	speed: 0.0971s/iter; left time: 1938.9978s
	iters: 600, epoch: 2 | loss: 0.2870707
	speed: 0.0950s/iter; left time: 1886.6981s
	iters: 700, epoch: 2 | loss: 0.2733433
	speed: 0.0949s/iter; left time: 1876.0174s
	iters: 800, epoch: 2 | loss: 0.3281088
	speed: 0.0964s/iter; left time: 1896.2029s
	iters: 900, epoch: 2 | loss: 0.3355549
	speed: 0.0976s/iter; left time: 1908.5820s
	iters: 1000, epoch: 2 | loss: 0.3443187
	speed: 0.2178s/iter; left time: 4239.5710s
Epoch: 2 cost time: 138.60273504257202
Epoch: 2, Steps: 1077 | Train Loss: 0.3287990 Vali Loss: 0.7113808 Test Loss: 0.5467943
Validation loss decreased (0.746726 --> 0.711381).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3108689
	speed: 0.2254s/iter; left time: 4346.8301s
	iters: 200, epoch: 3 | loss: 0.2872118
	speed: 0.2331s/iter; left time: 4473.0181s
	iters: 300, epoch: 3 | loss: 0.3100660
	speed: 0.1492s/iter; left time: 2847.2074s
	iters: 400, epoch: 3 | loss: 0.2863876
	speed: 0.1091s/iter; left time: 2071.7041s
	iters: 500, epoch: 3 | loss: 0.2904800
	speed: 0.1164s/iter; left time: 2198.2833s
	iters: 600, epoch: 3 | loss: 0.2923465
	speed: 0.0933s/iter; left time: 1752.2444s
	iters: 700, epoch: 3 | loss: 0.3303412
	speed: 0.1411s/iter; left time: 2637.2324s
	iters: 800, epoch: 3 | loss: 0.2834926
	speed: 0.2099s/iter; left time: 3900.9808s
	iters: 900, epoch: 3 | loss: 0.2797239
	speed: 0.2113s/iter; left time: 3906.9763s
	iters: 1000, epoch: 3 | loss: 0.2593559
	speed: 0.0935s/iter; left time: 1719.4924s
Epoch: 3 cost time: 166.00749802589417
Epoch: 3, Steps: 1077 | Train Loss: 0.2931871 Vali Loss: 0.7575001 Test Loss: 0.5729348
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3075845
	speed: 0.1459s/iter; left time: 2656.3486s
	iters: 200, epoch: 4 | loss: 0.2286086
	speed: 0.1018s/iter; left time: 1843.5702s
	iters: 300, epoch: 4 | loss: 0.2606159
	speed: 0.0927s/iter; left time: 1668.9935s
	iters: 400, epoch: 4 | loss: 0.2550087
	speed: 0.0885s/iter; left time: 1585.1078s
	iters: 500, epoch: 4 | loss: 0.3099546
	speed: 0.1679s/iter; left time: 2990.5131s
	iters: 600, epoch: 4 | loss: 0.2885235
	speed: 0.1324s/iter; left time: 2344.3976s
	iters: 700, epoch: 4 | loss: 0.2566196
	speed: 0.1099s/iter; left time: 1935.0392s
	iters: 800, epoch: 4 | loss: 0.2575239
	speed: 0.1079s/iter; left time: 1888.8317s
	iters: 900, epoch: 4 | loss: 0.2848401
	speed: 0.1718s/iter; left time: 2991.3760s
	iters: 1000, epoch: 4 | loss: 0.3041016
	speed: 0.1740s/iter; left time: 3012.3474s
Epoch: 4 cost time: 148.58439588546753
Epoch: 4, Steps: 1077 | Train Loss: 0.2798961 Vali Loss: 0.8167681 Test Loss: 0.5964279
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2461603
	speed: 0.2142s/iter; left time: 3669.5083s
	iters: 200, epoch: 5 | loss: 0.2447612
	speed: 0.2309s/iter; left time: 3932.2670s
	iters: 300, epoch: 5 | loss: 0.2606453
	speed: 0.1783s/iter; left time: 3019.3430s
	iters: 400, epoch: 5 | loss: 0.2283240
	speed: 0.1738s/iter; left time: 2926.3219s
	iters: 500, epoch: 5 | loss: 0.2552471
	speed: 0.1433s/iter; left time: 2397.1540s
	iters: 600, epoch: 5 | loss: 0.2368346
	speed: 0.0975s/iter; left time: 1621.6610s
	iters: 700, epoch: 5 | loss: 0.2463396
	speed: 0.0803s/iter; left time: 1327.3681s
	iters: 800, epoch: 5 | loss: 0.2843073
	speed: 0.1312s/iter; left time: 2156.8191s
	iters: 900, epoch: 5 | loss: 0.2771533
	speed: 0.1170s/iter; left time: 1910.3446s
	iters: 1000, epoch: 5 | loss: 0.2753717
	speed: 0.1709s/iter; left time: 2773.7443s
Epoch: 5 cost time: 174.31842470169067
Epoch: 5, Steps: 1077 | Train Loss: 0.2665664 Vali Loss: 0.7538794 Test Loss: 0.5861023
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.547334611415863, mae:0.4958206117153168
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTm1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34441
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.6378330
	speed: 0.2428s/iter; left time: 5205.1496s
	iters: 200, epoch: 1 | loss: 0.5831300
	speed: 0.2528s/iter; left time: 5396.0581s
	iters: 300, epoch: 1 | loss: 0.3961642
	speed: 0.2350s/iter; left time: 4991.5675s
	iters: 400, epoch: 1 | loss: 0.4059471
	speed: 0.2682s/iter; left time: 5669.2542s
	iters: 500, epoch: 1 | loss: 0.3800607
	speed: 0.2343s/iter; left time: 4929.9971s
	iters: 600, epoch: 1 | loss: 0.4116001
	speed: 0.2201s/iter; left time: 4609.7448s
	iters: 700, epoch: 1 | loss: 0.3802673
	speed: 0.1805s/iter; left time: 3760.9623s
	iters: 800, epoch: 1 | loss: 0.4058778
	speed: 0.1236s/iter; left time: 2563.1444s
	iters: 900, epoch: 1 | loss: 0.3287524
	speed: 0.1195s/iter; left time: 2466.6500s
	iters: 1000, epoch: 1 | loss: 0.3065903
	speed: 0.1789s/iter; left time: 3674.4775s
Epoch: 1 cost time: 224.62321019172668
Epoch: 1, Steps: 1077 | Train Loss: 0.4446585 Vali Loss: 0.7747315 Test Loss: 0.6072044
Validation loss decreased (inf --> 0.774732).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3862539
	speed: 0.1618s/iter; left time: 3295.0708s
	iters: 200, epoch: 2 | loss: 0.2957090
	speed: 0.1626s/iter; left time: 3295.0467s
	iters: 300, epoch: 2 | loss: 0.2991049
	speed: 0.1198s/iter; left time: 2415.1232s
	iters: 400, epoch: 2 | loss: 0.3138646
	speed: 0.1292s/iter; left time: 2592.7146s
	iters: 500, epoch: 2 | loss: 0.3000089
	speed: 0.2490s/iter; left time: 4971.6660s
	iters: 600, epoch: 2 | loss: 0.2913491
	speed: 0.2490s/iter; left time: 4947.0829s
	iters: 700, epoch: 2 | loss: 0.2938166
	speed: 0.1610s/iter; left time: 3182.7520s
	iters: 800, epoch: 2 | loss: 0.2568972
	speed: 0.2081s/iter; left time: 4092.4950s
	iters: 900, epoch: 2 | loss: 0.3228809
	speed: 0.2618s/iter; left time: 5122.6255s
	iters: 1000, epoch: 2 | loss: 0.2736240
	speed: 0.2581s/iter; left time: 5023.5082s
Epoch: 2 cost time: 215.5396032333374
Epoch: 2, Steps: 1077 | Train Loss: 0.3293317 Vali Loss: 0.7529344 Test Loss: 0.5798317
Validation loss decreased (0.774732 --> 0.752934).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3583823
	speed: 0.1788s/iter; left time: 3447.8700s
	iters: 200, epoch: 3 | loss: 0.2825578
	speed: 0.1681s/iter; left time: 3225.8621s
	iters: 300, epoch: 3 | loss: 0.3456950
	speed: 0.1213s/iter; left time: 2315.7019s
	iters: 400, epoch: 3 | loss: 0.2989678
	speed: 0.1209s/iter; left time: 2295.0031s
	iters: 500, epoch: 3 | loss: 0.2842828
	speed: 0.2290s/iter; left time: 4324.1981s
	iters: 600, epoch: 3 | loss: 0.2633070
	speed: 0.2543s/iter; left time: 4777.2116s
	iters: 700, epoch: 3 | loss: 0.3147497
	speed: 0.1926s/iter; left time: 3599.7176s
	iters: 800, epoch: 3 | loss: 0.3028868
	speed: 0.1143s/iter; left time: 2124.8726s
	iters: 900, epoch: 3 | loss: 0.2773957
	speed: 0.1686s/iter; left time: 3116.2328s
	iters: 1000, epoch: 3 | loss: 0.2853308
	speed: 0.1881s/iter; left time: 3458.1131s
Epoch: 3 cost time: 183.0524387359619
Epoch: 3, Steps: 1077 | Train Loss: 0.2944962 Vali Loss: 0.7049255 Test Loss: 0.5861780
Validation loss decreased (0.752934 --> 0.704926).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3104458
	speed: 0.2562s/iter; left time: 4664.8355s
	iters: 200, epoch: 4 | loss: 0.3086560
	speed: 0.2673s/iter; left time: 4841.2556s
	iters: 300, epoch: 4 | loss: 0.3343230
	speed: 0.2107s/iter; left time: 3794.5856s
	iters: 400, epoch: 4 | loss: 0.2816024
	speed: 0.2017s/iter; left time: 3611.8761s
	iters: 500, epoch: 4 | loss: 0.2930460
	speed: 0.1557s/iter; left time: 2772.2328s
	iters: 600, epoch: 4 | loss: 0.2487430
	speed: 0.2255s/iter; left time: 3993.8710s
	iters: 700, epoch: 4 | loss: 0.2631938
	speed: 0.2060s/iter; left time: 3627.6623s
	iters: 800, epoch: 4 | loss: 0.2467609
	speed: 0.1791s/iter; left time: 3136.5197s
	iters: 900, epoch: 4 | loss: 0.2351929
	speed: 0.1493s/iter; left time: 2599.1843s
	iters: 1000, epoch: 4 | loss: 0.2727337
	speed: 0.1848s/iter; left time: 3198.7024s
Epoch: 4 cost time: 212.94507312774658
Epoch: 4, Steps: 1077 | Train Loss: 0.2822860 Vali Loss: 0.7301213 Test Loss: 0.6299991
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2522404
	speed: 0.2640s/iter; left time: 4523.0357s
	iters: 200, epoch: 5 | loss: 0.2607533
	speed: 0.2143s/iter; left time: 3649.4860s
	iters: 300, epoch: 5 | loss: 0.2627598
	speed: 0.1176s/iter; left time: 1990.4923s
	iters: 400, epoch: 5 | loss: 0.2562988
	speed: 0.1215s/iter; left time: 2044.4552s
	iters: 500, epoch: 5 | loss: 0.2662504
	speed: 0.1864s/iter; left time: 3119.6582s
	iters: 600, epoch: 5 | loss: 0.2524076
	speed: 0.1435s/iter; left time: 2386.8867s
	iters: 700, epoch: 5 | loss: 0.2783530
	speed: 0.2199s/iter; left time: 3635.8486s
	iters: 800, epoch: 5 | loss: 0.2864730
	speed: 0.2679s/iter; left time: 4401.9886s
	iters: 900, epoch: 5 | loss: 0.2422043
	speed: 0.2616s/iter; left time: 4273.4382s
	iters: 1000, epoch: 5 | loss: 0.2415687
	speed: 0.2598s/iter; left time: 4216.7897s
Epoch: 5 cost time: 222.30134463310242
Epoch: 5, Steps: 1077 | Train Loss: 0.2687497 Vali Loss: 0.7101584 Test Loss: 0.5954476
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.2826158
	speed: 0.2309s/iter; left time: 3706.9998s
	iters: 200, epoch: 6 | loss: 0.2623427
	speed: 0.2559s/iter; left time: 4083.6466s
	iters: 300, epoch: 6 | loss: 0.2484106
	speed: 0.1930s/iter; left time: 3060.1218s
	iters: 400, epoch: 6 | loss: 0.3247321
	speed: 0.1192s/iter; left time: 1878.0949s
	iters: 500, epoch: 6 | loss: 0.2685724
	speed: 0.1478s/iter; left time: 2313.9222s
	iters: 600, epoch: 6 | loss: 0.3140500
	speed: 0.1913s/iter; left time: 2976.5629s
	iters: 700, epoch: 6 | loss: 0.2858672
	speed: 0.1377s/iter; left time: 2128.9901s
	iters: 800, epoch: 6 | loss: 0.2798815
	speed: 0.2058s/iter; left time: 3159.9961s
	iters: 900, epoch: 6 | loss: 0.2421383
	speed: 0.2390s/iter; left time: 3646.7031s
	iters: 1000, epoch: 6 | loss: 0.2684731
	speed: 0.1998s/iter; left time: 3028.5922s
Epoch: 6 cost time: 202.44563055038452
Epoch: 6, Steps: 1077 | Train Loss: 0.2631823 Vali Loss: 0.7300541 Test Loss: 0.6338223
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.5865260362625122, mae:0.5195677280426025
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTm1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34441
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.6730680
	speed: 0.2763s/iter; left time: 5924.9376s
	iters: 200, epoch: 1 | loss: 0.4606428
	speed: 0.2799s/iter; left time: 5973.9576s
	iters: 300, epoch: 1 | loss: 0.4140862
	speed: 0.2499s/iter; left time: 5307.5426s
	iters: 400, epoch: 1 | loss: 0.4150689
	speed: 0.2591s/iter; left time: 5477.4238s
	iters: 500, epoch: 1 | loss: 0.4230213
	speed: 0.1085s/iter; left time: 2282.1572s
	iters: 600, epoch: 1 | loss: 0.4340693
	speed: 0.1142s/iter; left time: 2391.5041s
	iters: 700, epoch: 1 | loss: 0.3888970
	speed: 0.1781s/iter; left time: 3712.0781s
	iters: 800, epoch: 1 | loss: 0.4210675
	speed: 0.2503s/iter; left time: 5192.4700s
	iters: 900, epoch: 1 | loss: 0.3513329
	speed: 0.1879s/iter; left time: 3878.7776s
	iters: 1000, epoch: 1 | loss: 0.3263992
	speed: 0.1230s/iter; left time: 2525.9814s
Epoch: 1 cost time: 214.20159554481506
Epoch: 1, Steps: 1077 | Train Loss: 0.4423486 Vali Loss: 0.7401965 Test Loss: 0.5721232
Validation loss decreased (inf --> 0.740197).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3369550
	speed: 0.1717s/iter; left time: 3496.8923s
	iters: 200, epoch: 2 | loss: 0.3236283
	speed: 0.2257s/iter; left time: 4573.1096s
	iters: 300, epoch: 2 | loss: 0.4014840
	speed: 0.2382s/iter; left time: 4802.4961s
	iters: 400, epoch: 2 | loss: 0.3184716
	speed: 0.1388s/iter; left time: 2785.8735s
	iters: 500, epoch: 2 | loss: 0.3539417
	speed: 0.1247s/iter; left time: 2488.7552s
	iters: 600, epoch: 2 | loss: 0.3775563
	speed: 0.1175s/iter; left time: 2333.6814s
	iters: 700, epoch: 2 | loss: 0.3625431
	speed: 0.2367s/iter; left time: 4678.9449s
	iters: 800, epoch: 2 | loss: 0.3605996
	speed: 0.2870s/iter; left time: 5644.0528s
	iters: 900, epoch: 2 | loss: 0.3666417
	speed: 0.2700s/iter; left time: 5281.3395s
	iters: 1000, epoch: 2 | loss: 0.3659574
	speed: 0.2662s/iter; left time: 5180.7694s
Epoch: 2 cost time: 225.5566828250885
Epoch: 2, Steps: 1077 | Train Loss: 0.3286649 Vali Loss: 0.7244728 Test Loss: 0.5803581
Validation loss decreased (0.740197 --> 0.724473).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2950434
	speed: 0.1784s/iter; left time: 3440.9430s
	iters: 200, epoch: 3 | loss: 0.3395779
	speed: 0.1009s/iter; left time: 1936.1239s
	iters: 300, epoch: 3 | loss: 0.3066304
	speed: 0.1950s/iter; left time: 3721.9792s
	iters: 400, epoch: 3 | loss: 0.3323818
	speed: 0.2451s/iter; left time: 4654.2071s
	iters: 500, epoch: 3 | loss: 0.2929854
	speed: 0.1430s/iter; left time: 2701.3944s
	iters: 600, epoch: 3 | loss: 0.3311776
	speed: 0.1069s/iter; left time: 2007.4781s
	iters: 700, epoch: 3 | loss: 0.2875699
	speed: 0.1394s/iter; left time: 2605.2041s
	iters: 800, epoch: 3 | loss: 0.2688194
	speed: 0.1647s/iter; left time: 3061.1015s
	iters: 900, epoch: 3 | loss: 0.3368665
	speed: 0.1500s/iter; left time: 2772.2427s
	iters: 1000, epoch: 3 | loss: 0.2331859
	speed: 0.1969s/iter; left time: 3620.1285s
Epoch: 3 cost time: 177.17682671546936
Epoch: 3, Steps: 1077 | Train Loss: 0.2936853 Vali Loss: 0.7460274 Test Loss: 0.6595829
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3063869
	speed: 0.1072s/iter; left time: 1951.4184s
	iters: 200, epoch: 4 | loss: 0.2867982
	speed: 0.1741s/iter; left time: 3153.1476s
	iters: 300, epoch: 4 | loss: 0.3090019
	speed: 0.2828s/iter; left time: 5092.4547s
	iters: 400, epoch: 4 | loss: 0.2846908
	speed: 0.2522s/iter; left time: 4516.8833s
	iters: 500, epoch: 4 | loss: 0.2647465
	speed: 0.1424s/iter; left time: 2536.5897s
	iters: 600, epoch: 4 | loss: 0.2706931
	speed: 0.1655s/iter; left time: 2930.7199s
	iters: 700, epoch: 4 | loss: 0.2615453
	speed: 0.1439s/iter; left time: 2533.4672s
	iters: 800, epoch: 4 | loss: 0.2935257
	speed: 0.1092s/iter; left time: 1912.9265s
	iters: 900, epoch: 4 | loss: 0.2634845
	speed: 0.1328s/iter; left time: 2311.6207s
	iters: 1000, epoch: 4 | loss: 0.2421035
	speed: 0.2423s/iter; left time: 4193.9766s
Epoch: 4 cost time: 194.83258247375488
Epoch: 4, Steps: 1077 | Train Loss: 0.2805556 Vali Loss: 0.7028277 Test Loss: 0.6354476
Validation loss decreased (0.724473 --> 0.702828).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2917588
	speed: 0.1312s/iter; left time: 2247.5160s
	iters: 200, epoch: 5 | loss: 0.3224681
	speed: 0.1913s/iter; left time: 3257.9836s
	iters: 300, epoch: 5 | loss: 0.2517456
	speed: 0.1428s/iter; left time: 2418.2362s
	iters: 400, epoch: 5 | loss: 0.3218602
	speed: 0.2669s/iter; left time: 4492.1534s
	iters: 500, epoch: 5 | loss: 0.2928058
	speed: 0.2506s/iter; left time: 4192.6164s
	iters: 600, epoch: 5 | loss: 0.2504174
	speed: 0.2214s/iter; left time: 3681.9258s
	iters: 700, epoch: 5 | loss: 0.2320969
	speed: 0.1474s/iter; left time: 2437.3834s
	iters: 800, epoch: 5 | loss: 0.2603243
	speed: 0.0816s/iter; left time: 1340.9118s
	iters: 900, epoch: 5 | loss: 0.2544892
	speed: 0.1034s/iter; left time: 1689.6262s
	iters: 1000, epoch: 5 | loss: 0.2714502
	speed: 0.1234s/iter; left time: 2003.1591s
Epoch: 5 cost time: 173.72597312927246
Epoch: 5, Steps: 1077 | Train Loss: 0.2675755 Vali Loss: 0.7136057 Test Loss: 0.6258323
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.2492482
	speed: 0.0786s/iter; left time: 1262.0230s
	iters: 200, epoch: 6 | loss: 0.2363562
	speed: 0.1608s/iter; left time: 2565.3043s
	iters: 300, epoch: 6 | loss: 0.2774145
	speed: 0.1529s/iter; left time: 2423.8998s
	iters: 400, epoch: 6 | loss: 0.2439937
	speed: 0.1166s/iter; left time: 1836.6415s
	iters: 500, epoch: 6 | loss: 0.3161532
	speed: 0.1706s/iter; left time: 2670.6553s
	iters: 600, epoch: 6 | loss: 0.2295659
	speed: 0.1242s/iter; left time: 1932.3310s
	iters: 700, epoch: 6 | loss: 0.2608031
	speed: 0.0983s/iter; left time: 1520.0605s
	iters: 800, epoch: 6 | loss: 0.2410668
	speed: 0.2273s/iter; left time: 3490.1619s
	iters: 900, epoch: 6 | loss: 0.2563662
	speed: 0.2501s/iter; left time: 3816.1254s
	iters: 1000, epoch: 6 | loss: 0.2238066
	speed: 0.1699s/iter; left time: 2575.6685s
Epoch: 6 cost time: 162.70143342018127
Epoch: 6, Steps: 1077 | Train Loss: 0.2611202 Vali Loss: 0.7351630 Test Loss: 0.6575137
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.2156342
	speed: 0.0970s/iter; left time: 1453.0548s
	iters: 200, epoch: 7 | loss: 0.3316613
	speed: 0.1156s/iter; left time: 1719.8887s
	iters: 300, epoch: 7 | loss: 0.2601334
	speed: 0.1891s/iter; left time: 2794.1133s
	iters: 400, epoch: 7 | loss: 0.2900594
	speed: 0.1580s/iter; left time: 2319.8578s
	iters: 500, epoch: 7 | loss: 0.2552464
	speed: 0.2261s/iter; left time: 3296.5112s
	iters: 600, epoch: 7 | loss: 0.2124334
	speed: 0.1991s/iter; left time: 2882.6381s
	iters: 700, epoch: 7 | loss: 0.2604607
	speed: 0.1520s/iter; left time: 2185.0541s
	iters: 800, epoch: 7 | loss: 0.2637758
	speed: 0.1898s/iter; left time: 2709.9510s
	iters: 900, epoch: 7 | loss: 0.3179003
	speed: 0.1642s/iter; left time: 2328.4873s
	iters: 1000, epoch: 7 | loss: 0.2809612
	speed: 0.0995s/iter; left time: 1401.1812s
Epoch: 7 cost time: 166.836035490036
Epoch: 7, Steps: 1077 | Train Loss: 0.2549826 Vali Loss: 0.7035355 Test Loss: 0.6034420
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.6357387900352478, mae:0.5593007802963257
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTm1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34441
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.5332198
	speed: 0.1853s/iter; left time: 3973.1169s
	iters: 200, epoch: 1 | loss: 0.5229168
	speed: 0.1477s/iter; left time: 3152.4858s
	iters: 300, epoch: 1 | loss: 0.4592795
	speed: 0.0965s/iter; left time: 2050.3748s
	iters: 400, epoch: 1 | loss: 0.4392258
	speed: 0.0974s/iter; left time: 2059.4537s
	iters: 500, epoch: 1 | loss: 0.4057737
	speed: 0.0994s/iter; left time: 2092.0160s
	iters: 600, epoch: 1 | loss: 0.4014508
	speed: 0.1068s/iter; left time: 2237.3092s
	iters: 700, epoch: 1 | loss: 0.3753074
	speed: 0.2156s/iter; left time: 4492.4796s
	iters: 800, epoch: 1 | loss: 0.3609056
	speed: 0.2663s/iter; left time: 5522.5972s
	iters: 900, epoch: 1 | loss: 0.3823758
	speed: 0.2561s/iter; left time: 5285.6647s
	iters: 1000, epoch: 1 | loss: 0.3398324
	speed: 0.1433s/iter; left time: 2943.9693s
Epoch: 1 cost time: 168.94167470932007
Epoch: 1, Steps: 1077 | Train Loss: 0.4442872 Vali Loss: 0.7089107 Test Loss: 0.5469763
Validation loss decreased (inf --> 0.708911).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3955221
	speed: 0.1032s/iter; left time: 2101.1614s
	iters: 200, epoch: 2 | loss: 0.3213539
	speed: 0.1627s/iter; left time: 3297.2813s
	iters: 300, epoch: 2 | loss: 0.3196909
	speed: 0.1791s/iter; left time: 3610.9906s
	iters: 400, epoch: 2 | loss: 0.3579547
	speed: 0.1506s/iter; left time: 3022.0630s
	iters: 500, epoch: 2 | loss: 0.2645040
	speed: 0.1793s/iter; left time: 3579.5992s
	iters: 600, epoch: 2 | loss: 0.3585114
	speed: 0.1390s/iter; left time: 2761.6574s
	iters: 700, epoch: 2 | loss: 0.2858127
	speed: 0.1011s/iter; left time: 1998.7425s
	iters: 800, epoch: 2 | loss: 0.3170595
	speed: 0.2077s/iter; left time: 4084.0976s
	iters: 900, epoch: 2 | loss: 0.3525881
	speed: 0.2371s/iter; left time: 4638.7114s
	iters: 1000, epoch: 2 | loss: 0.3183931
	speed: 0.1135s/iter; left time: 2208.5292s
Epoch: 2 cost time: 164.86061191558838
Epoch: 2, Steps: 1077 | Train Loss: 0.3305306 Vali Loss: 0.8070561 Test Loss: 0.6176872
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3028131
	speed: 0.1605s/iter; left time: 3095.6275s
	iters: 200, epoch: 3 | loss: 0.2659349
	speed: 0.1857s/iter; left time: 3562.6091s
	iters: 300, epoch: 3 | loss: 0.2964057
	speed: 0.1375s/iter; left time: 2623.7455s
	iters: 400, epoch: 3 | loss: 0.2830950
	speed: 0.0963s/iter; left time: 1828.8705s
	iters: 500, epoch: 3 | loss: 0.2757114
	speed: 0.0964s/iter; left time: 1820.2087s
	iters: 600, epoch: 3 | loss: 0.3159883
	speed: 0.0953s/iter; left time: 1789.7766s
	iters: 700, epoch: 3 | loss: 0.2843493
	speed: 0.0954s/iter; left time: 1782.3691s
	iters: 800, epoch: 3 | loss: 0.2748456
	speed: 0.1594s/iter; left time: 2962.0800s
	iters: 900, epoch: 3 | loss: 0.3748119
	speed: 0.2661s/iter; left time: 4919.6040s
	iters: 1000, epoch: 3 | loss: 0.2799866
	speed: 0.2788s/iter; left time: 5126.2123s
Epoch: 3 cost time: 172.58812403678894
Epoch: 3, Steps: 1077 | Train Loss: 0.2949376 Vali Loss: 0.7931008 Test Loss: 0.6535669
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3049286
	speed: 0.0959s/iter; left time: 1745.8962s
	iters: 200, epoch: 4 | loss: 0.2458826
	speed: 0.1009s/iter; left time: 1827.6469s
	iters: 300, epoch: 4 | loss: 0.3142127
	speed: 0.1661s/iter; left time: 2990.7757s
	iters: 400, epoch: 4 | loss: 0.2997937
	speed: 0.1515s/iter; left time: 2714.0279s
	iters: 500, epoch: 4 | loss: 0.3001714
	speed: 0.1181s/iter; left time: 2103.5796s
	iters: 600, epoch: 4 | loss: 0.2690406
	speed: 0.1792s/iter; left time: 3173.4162s
	iters: 700, epoch: 4 | loss: 0.2839633
	speed: 0.1313s/iter; left time: 2312.3411s
	iters: 800, epoch: 4 | loss: 0.3033280
	speed: 0.0962s/iter; left time: 1684.7937s
	iters: 900, epoch: 4 | loss: 0.2346663
	speed: 0.1593s/iter; left time: 2772.7064s
	iters: 1000, epoch: 4 | loss: 0.2967942
	speed: 0.1735s/iter; left time: 3002.8795s
Epoch: 4 cost time: 149.21412348747253
Epoch: 4, Steps: 1077 | Train Loss: 0.2827351 Vali Loss: 0.7391679 Test Loss: 0.6409517
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.5475255846977234, mae:0.4865626394748688
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTm1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34441
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4651257
	speed: 0.2182s/iter; left time: 4678.0012s
	iters: 200, epoch: 1 | loss: 0.5512525
	speed: 0.2108s/iter; left time: 4499.4581s
	iters: 300, epoch: 1 | loss: 0.4604703
	speed: 0.1127s/iter; left time: 2393.2086s
	iters: 400, epoch: 1 | loss: 0.4733697
	speed: 0.0971s/iter; left time: 2051.9334s
	iters: 500, epoch: 1 | loss: 0.3715428
	speed: 0.0996s/iter; left time: 2095.2717s
	iters: 600, epoch: 1 | loss: 0.4194856
	speed: 0.0947s/iter; left time: 1983.2813s
	iters: 700, epoch: 1 | loss: 0.3734216
	speed: 0.0972s/iter; left time: 2026.7244s
	iters: 800, epoch: 1 | loss: 0.3811797
	speed: 0.1597s/iter; left time: 3312.6744s
	iters: 900, epoch: 1 | loss: 0.4056404
	speed: 0.2082s/iter; left time: 4297.7770s
	iters: 1000, epoch: 1 | loss: 0.3585204
	speed: 0.1709s/iter; left time: 3510.4917s
Epoch: 1 cost time: 159.75957894325256
Epoch: 1, Steps: 1077 | Train Loss: 0.4398290 Vali Loss: 0.8116128 Test Loss: 0.6433634
Validation loss decreased (inf --> 0.811613).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2944643
	speed: 0.1905s/iter; left time: 3878.3912s
	iters: 200, epoch: 2 | loss: 0.2964506
	speed: 0.1350s/iter; left time: 2736.1060s
	iters: 300, epoch: 2 | loss: 0.3554782
	speed: 0.1002s/iter; left time: 2020.9100s
	iters: 400, epoch: 2 | loss: 0.3543772
	speed: 0.1350s/iter; left time: 2709.5655s
	iters: 500, epoch: 2 | loss: 0.2831867
	speed: 0.1632s/iter; left time: 3257.7909s
	iters: 600, epoch: 2 | loss: 0.3881974
	speed: 0.1097s/iter; left time: 2178.6764s
	iters: 700, epoch: 2 | loss: 0.3160933
	speed: 0.1681s/iter; left time: 3322.0954s
	iters: 800, epoch: 2 | loss: 0.2802396
	speed: 0.1365s/iter; left time: 2684.7258s
	iters: 900, epoch: 2 | loss: 0.2646248
	speed: 0.0960s/iter; left time: 1878.3721s
	iters: 1000, epoch: 2 | loss: 0.2846665
	speed: 0.0951s/iter; left time: 1850.3505s
Epoch: 2 cost time: 140.3868339061737
Epoch: 2, Steps: 1077 | Train Loss: 0.3264253 Vali Loss: 0.7648652 Test Loss: 0.6129296
Validation loss decreased (0.811613 --> 0.764865).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3092605
	speed: 0.2872s/iter; left time: 5539.1360s
	iters: 200, epoch: 3 | loss: 0.3285566
	speed: 0.2637s/iter; left time: 5060.0058s
	iters: 300, epoch: 3 | loss: 0.3018823
	speed: 0.2082s/iter; left time: 3974.1010s
	iters: 400, epoch: 3 | loss: 0.3007058
	speed: 0.0906s/iter; left time: 1720.0522s
	iters: 500, epoch: 3 | loss: 0.3370628
	speed: 0.0788s/iter; left time: 1488.0599s
	iters: 600, epoch: 3 | loss: 0.2904718
	speed: 0.0804s/iter; left time: 1509.7874s
	iters: 700, epoch: 3 | loss: 0.2975845
	speed: 0.0776s/iter; left time: 1449.7421s
	iters: 800, epoch: 3 | loss: 0.2851564
	speed: 0.1009s/iter; left time: 1876.0792s
	iters: 900, epoch: 3 | loss: 0.2772619
	speed: 0.0963s/iter; left time: 1780.9712s
	iters: 1000, epoch: 3 | loss: 0.2673780
	speed: 0.1134s/iter; left time: 2084.7225s
Epoch: 3 cost time: 152.516033411026
Epoch: 3, Steps: 1077 | Train Loss: 0.2913135 Vali Loss: 0.7472391 Test Loss: 0.5855416
Validation loss decreased (0.764865 --> 0.747239).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2455026
	speed: 0.1164s/iter; left time: 2119.5307s
	iters: 200, epoch: 4 | loss: 0.3111336
	speed: 0.1262s/iter; left time: 2286.3329s
	iters: 300, epoch: 4 | loss: 0.2387167
	speed: 0.1555s/iter; left time: 2801.4039s
	iters: 400, epoch: 4 | loss: 0.2846437
	speed: 0.1039s/iter; left time: 1860.0559s
	iters: 500, epoch: 4 | loss: 0.2647365
	speed: 0.0976s/iter; left time: 1738.0625s
	iters: 600, epoch: 4 | loss: 0.2688547
	speed: 0.1688s/iter; left time: 2988.9933s
	iters: 700, epoch: 4 | loss: 0.3086534
	speed: 0.2289s/iter; left time: 4031.7924s
	iters: 800, epoch: 4 | loss: 0.3049480
	speed: 0.1633s/iter; left time: 2858.7718s
	iters: 900, epoch: 4 | loss: 0.3279006
	speed: 0.0960s/iter; left time: 1671.6220s
	iters: 1000, epoch: 4 | loss: 0.2815137
	speed: 0.0973s/iter; left time: 1684.1101s
Epoch: 4 cost time: 142.8940360546112
Epoch: 4, Steps: 1077 | Train Loss: 0.2798724 Vali Loss: 0.7655681 Test Loss: 0.5885139
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3189155
	speed: 0.1303s/iter; left time: 2232.7529s
	iters: 200, epoch: 5 | loss: 0.2791770
	speed: 0.0952s/iter; left time: 1621.1513s
	iters: 300, epoch: 5 | loss: 0.2255725
	speed: 0.1562s/iter; left time: 2644.1844s
	iters: 400, epoch: 5 | loss: 0.2890375
	speed: 0.2263s/iter; left time: 3808.6117s
	iters: 500, epoch: 5 | loss: 0.2373113
	speed: 0.2156s/iter; left time: 3607.9413s
	iters: 600, epoch: 5 | loss: 0.2813990
	speed: 0.1486s/iter; left time: 2471.0127s
	iters: 700, epoch: 5 | loss: 0.2707885
	speed: 0.1106s/iter; left time: 1828.8075s
	iters: 800, epoch: 5 | loss: 0.3311667
	speed: 0.0964s/iter; left time: 1584.8015s
	iters: 900, epoch: 5 | loss: 0.2321892
	speed: 0.0959s/iter; left time: 1566.3596s
	iters: 1000, epoch: 5 | loss: 0.2490758
	speed: 0.0955s/iter; left time: 1550.5116s
Epoch: 5 cost time: 144.56162214279175
Epoch: 5, Steps: 1077 | Train Loss: 0.2662637 Vali Loss: 0.7509619 Test Loss: 0.6211254
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.2722021
	speed: 0.2090s/iter; left time: 3356.0065s
	iters: 200, epoch: 6 | loss: 0.2400947
	speed: 0.1173s/iter; left time: 1871.0762s
	iters: 300, epoch: 6 | loss: 0.2457796
	speed: 0.0898s/iter; left time: 1424.1297s
	iters: 400, epoch: 6 | loss: 0.2457816
	speed: 0.0780s/iter; left time: 1228.6978s
	iters: 500, epoch: 6 | loss: 0.2654782
	speed: 0.1062s/iter; left time: 1662.6658s
	iters: 600, epoch: 6 | loss: 0.2390485
	speed: 0.1937s/iter; left time: 3013.7110s
	iters: 700, epoch: 6 | loss: 0.2382319
	speed: 0.1711s/iter; left time: 2644.1490s
	iters: 800, epoch: 6 | loss: 0.2902239
	speed: 0.1036s/iter; left time: 1590.9922s
	iters: 900, epoch: 6 | loss: 0.2368079
	speed: 0.0979s/iter; left time: 1493.5595s
	iters: 1000, epoch: 6 | loss: 0.2553508
	speed: 0.0959s/iter; left time: 1452.7731s
Epoch: 6 cost time: 135.36685514450073
Epoch: 6, Steps: 1077 | Train Loss: 0.2613268 Vali Loss: 0.7785689 Test Loss: 0.6127523
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.5861986875534058, mae:0.5147124528884888
