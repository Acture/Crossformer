Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh2', data_dim=7, data_path='ETTh2.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=24, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=720, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7897
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.7320988
	speed: 0.2662s/iter; left time: 1288.8290s
	iters: 200, epoch: 1 | loss: 0.5443774
	speed: 0.2751s/iter; left time: 1304.4019s
Epoch: 1 cost time: 67.76729559898376
Epoch: 1, Steps: 247 | Train Loss: 0.7784838 Vali Loss: 0.9643490 Test Loss: 2.2994478
Validation loss decreased (inf --> 0.964349).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5909213
	speed: 0.2911s/iter; left time: 1337.1086s
	iters: 200, epoch: 2 | loss: 0.6671721
	speed: 0.2857s/iter; left time: 1283.8517s
Epoch: 2 cost time: 67.18359279632568
Epoch: 2, Steps: 247 | Train Loss: 0.5529730 Vali Loss: 2.1160699 Test Loss: 3.1298852
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5651984
	speed: 0.1581s/iter; left time: 687.2997s
	iters: 200, epoch: 3 | loss: 0.5012639
	speed: 0.1560s/iter; left time: 662.7391s
Epoch: 3 cost time: 38.91118860244751
Epoch: 3, Steps: 247 | Train Loss: 0.4871129 Vali Loss: 2.8520210 Test Loss: 3.8438654
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.5016200
	speed: 0.1902s/iter; left time: 780.0141s
	iters: 200, epoch: 4 | loss: 0.6490203
	speed: 0.2594s/iter; left time: 1037.6430s
Epoch: 4 cost time: 59.57709860801697
Epoch: 4, Steps: 247 | Train Loss: 0.4665631 Vali Loss: 2.6335891 Test Loss: 4.0057221
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:2.2981245517730713, mae:1.2671406269073486
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7897
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.8384665
	speed: 0.1967s/iter; left time: 952.3366s
	iters: 200, epoch: 1 | loss: 0.7057305
	speed: 0.1583s/iter; left time: 750.3940s
Epoch: 1 cost time: 43.63793396949768
Epoch: 1, Steps: 247 | Train Loss: 0.7785446 Vali Loss: 1.0828151 Test Loss: 1.9903647
Validation loss decreased (inf --> 1.082815).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4641508
	speed: 0.2279s/iter; left time: 1046.7771s
	iters: 200, epoch: 2 | loss: 0.5520288
	speed: 0.2682s/iter; left time: 1205.2412s
Epoch: 2 cost time: 63.898730754852295
Epoch: 2, Steps: 247 | Train Loss: 0.5597817 Vali Loss: 1.7137208 Test Loss: 2.6712302
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4754654
	speed: 0.2983s/iter; left time: 1296.5492s
	iters: 200, epoch: 3 | loss: 0.4730194
	speed: 0.2154s/iter; left time: 914.7688s
Epoch: 3 cost time: 58.71731209754944
Epoch: 3, Steps: 247 | Train Loss: 0.4979313 Vali Loss: 1.7447767 Test Loss: 2.6415497
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.5185603
	speed: 0.1559s/iter; left time: 639.1589s
	iters: 200, epoch: 4 | loss: 0.4462656
	speed: 0.1566s/iter; left time: 626.5282s
Epoch: 4 cost time: 38.58102798461914
Epoch: 4, Steps: 247 | Train Loss: 0.4675098 Vali Loss: 2.4439817 Test Loss: 3.2627149
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:1.9880871772766113, mae:1.1739633083343506
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7897
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 1.0439816
	speed: 0.2399s/iter; left time: 1161.2898s
	iters: 200, epoch: 1 | loss: 0.7390575
	speed: 0.3000s/iter; left time: 1422.4366s
Epoch: 1 cost time: 64.81630301475525
Epoch: 1, Steps: 247 | Train Loss: 0.7764621 Vali Loss: 1.3300166 Test Loss: 2.3451693
Validation loss decreased (inf --> 1.330017).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5287707
	speed: 0.2442s/iter; left time: 1121.6948s
	iters: 200, epoch: 2 | loss: 0.3094878
	speed: 0.1946s/iter; left time: 874.5388s
Epoch: 2 cost time: 51.19326400756836
Epoch: 2, Steps: 247 | Train Loss: 0.5583652 Vali Loss: 2.0943843 Test Loss: 2.6803342
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5579700
	speed: 0.2227s/iter; left time: 968.1783s
	iters: 200, epoch: 3 | loss: 0.4926686
	speed: 0.1891s/iter; left time: 803.1165s
Epoch: 3 cost time: 48.66759419441223
Epoch: 3, Steps: 247 | Train Loss: 0.4977162 Vali Loss: 2.4306002 Test Loss: 3.6258637
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.5654091
	speed: 0.2209s/iter; left time: 905.7964s
	iters: 200, epoch: 4 | loss: 0.4979773
	speed: 0.2062s/iter; left time: 824.8444s
Epoch: 4 cost time: 50.199809074401855
Epoch: 4, Steps: 247 | Train Loss: 0.4738325 Vali Loss: 2.6804595 Test Loss: 4.3173622
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:2.342665910720825, mae:1.2519989013671875
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7897
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.8126632
	speed: 0.2315s/iter; left time: 1120.7046s
	iters: 200, epoch: 1 | loss: 0.9053414
	speed: 0.1830s/iter; left time: 867.5726s
Epoch: 1 cost time: 50.49068570137024
Epoch: 1, Steps: 247 | Train Loss: 0.7768640 Vali Loss: 1.4558928 Test Loss: 2.6558567
Validation loss decreased (inf --> 1.455893).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7443839
	speed: 0.2672s/iter; left time: 1227.2922s
	iters: 200, epoch: 2 | loss: 0.3892540
	speed: 0.3017s/iter; left time: 1355.9950s
Epoch: 2 cost time: 70.98801350593567
Epoch: 2, Steps: 247 | Train Loss: 0.5572902 Vali Loss: 2.0454474 Test Loss: 3.3309055
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5053819
	speed: 0.3231s/iter; left time: 1404.7092s
	iters: 200, epoch: 3 | loss: 0.4352233
	speed: 0.2064s/iter; left time: 876.5634s
Epoch: 3 cost time: 60.51353454589844
Epoch: 3, Steps: 247 | Train Loss: 0.4916911 Vali Loss: 3.0457534 Test Loss: 4.8385136
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.4817460
	speed: 0.1562s/iter; left time: 640.5381s
	iters: 200, epoch: 4 | loss: 0.3824345
	speed: 0.1560s/iter; left time: 624.0236s
Epoch: 4 cost time: 38.92761564254761
Epoch: 4, Steps: 247 | Train Loss: 0.4723385 Vali Loss: 3.3477765 Test Loss: 5.0324100
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:2.6534693241119385, mae:1.3996514081954956
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7897
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.9409438
	speed: 0.2735s/iter; left time: 1323.9239s
	iters: 200, epoch: 1 | loss: 0.6724632
	speed: 0.2845s/iter; left time: 1348.7573s
Epoch: 1 cost time: 70.09623718261719
Epoch: 1, Steps: 247 | Train Loss: 0.7754114 Vali Loss: 1.4966157 Test Loss: 2.5971038
Validation loss decreased (inf --> 1.496616).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5794790
	speed: 0.1594s/iter; left time: 732.1133s
	iters: 200, epoch: 2 | loss: 0.4830202
	speed: 0.1858s/iter; left time: 834.9517s
Epoch: 2 cost time: 44.562549352645874
Epoch: 2, Steps: 247 | Train Loss: 0.5632166 Vali Loss: 2.1063752 Test Loss: 3.2942182
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6296813
	speed: 0.1890s/iter; left time: 821.5568s
	iters: 200, epoch: 3 | loss: 0.4245956
	speed: 0.2295s/iter; left time: 974.6567s
Epoch: 3 cost time: 51.51322817802429
Epoch: 3, Steps: 247 | Train Loss: 0.4962595 Vali Loss: 2.4647164 Test Loss: 3.4833042
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.4452539
	speed: 0.2326s/iter; left time: 953.6370s
	iters: 200, epoch: 4 | loss: 0.4478535
	speed: 0.1571s/iter; left time: 628.3683s
Epoch: 4 cost time: 45.35537362098694
Epoch: 4, Steps: 247 | Train Loss: 0.4709611 Vali Loss: 2.3676195 Test Loss: 3.9011462
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:2.593841314315796, mae:1.3771132230758667
