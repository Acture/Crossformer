Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh1', data_dim=7, data_path='ETTh1.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=96, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=720, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il96_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5720636
	speed: 0.4384s/iter; left time: 2104.6028s
	iters: 200, epoch: 1 | loss: 0.4815351
	speed: 0.2763s/iter; left time: 1298.7280s
Epoch: 1 cost time: 80.85133576393127
Epoch: 1, Steps: 245 | Train Loss: 0.6131682 Vali Loss: 1.1780596 Test Loss: 0.7695902
Validation loss decreased (inf --> 1.178060).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4783254
	speed: 0.1724s/iter; left time: 785.2465s
	iters: 200, epoch: 2 | loss: 0.4215051
	speed: 0.1704s/iter; left time: 759.3739s
Epoch: 2 cost time: 41.283063888549805
Epoch: 2, Steps: 245 | Train Loss: 0.4609055 Vali Loss: 1.2119394 Test Loss: 0.8279713
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4381946
	speed: 0.1923s/iter; left time: 828.8319s
	iters: 200, epoch: 3 | loss: 0.4060784
	speed: 0.2660s/iter; left time: 1119.9998s
Epoch: 3 cost time: 55.466480016708374
Epoch: 3, Steps: 245 | Train Loss: 0.4143261 Vali Loss: 1.2687843 Test Loss: 0.8093081
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3877288
	speed: 0.1567s/iter; left time: 637.2825s
	iters: 200, epoch: 4 | loss: 0.4094786
	speed: 0.1963s/iter; left time: 778.3285s
Epoch: 4 cost time: 46.25658369064331
Epoch: 4, Steps: 245 | Train Loss: 0.3947337 Vali Loss: 1.2544345 Test Loss: 0.7237070
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il96_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.7682634592056274, mae:0.687759518623352
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il96_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6103378
	speed: 0.2699s/iter; left time: 1295.7014s
	iters: 200, epoch: 1 | loss: 0.4650326
	speed: 0.3339s/iter; left time: 1569.5094s
Epoch: 1 cost time: 75.60750913619995
Epoch: 1, Steps: 245 | Train Loss: 0.6190860 Vali Loss: 1.1773439 Test Loss: 0.7050144
Validation loss decreased (inf --> 1.177344).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5025098
	speed: 0.1588s/iter; left time: 723.3111s
	iters: 200, epoch: 2 | loss: 0.4517080
	speed: 0.1747s/iter; left time: 778.2875s
Epoch: 2 cost time: 40.366419553756714
Epoch: 2, Steps: 245 | Train Loss: 0.4594910 Vali Loss: 1.2578661 Test Loss: 0.7138625
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3968882
	speed: 0.1550s/iter; left time: 668.3527s
	iters: 200, epoch: 3 | loss: 0.4381748
	speed: 0.1729s/iter; left time: 728.1273s
Epoch: 3 cost time: 41.54452085494995
Epoch: 3, Steps: 245 | Train Loss: 0.4149492 Vali Loss: 1.3043428 Test Loss: 0.6978919
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3674828
	speed: 0.2053s/iter; left time: 834.8098s
	iters: 200, epoch: 4 | loss: 0.4017720
	speed: 0.1751s/iter; left time: 694.2835s
Epoch: 4 cost time: 48.388169288635254
Epoch: 4, Steps: 245 | Train Loss: 0.3946950 Vali Loss: 1.3228705 Test Loss: 0.7268546
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il96_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.7040212154388428, mae:0.6405566930770874
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il96_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6105974
	speed: 0.2452s/iter; left time: 1177.2259s
	iters: 200, epoch: 1 | loss: 0.5063570
	speed: 0.2877s/iter; left time: 1352.3537s
Epoch: 1 cost time: 68.69090580940247
Epoch: 1, Steps: 245 | Train Loss: 0.6223375 Vali Loss: 1.1553225 Test Loss: 0.7178583
Validation loss decreased (inf --> 1.155323).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4082500
	speed: 0.2777s/iter; left time: 1265.0445s
	iters: 200, epoch: 2 | loss: 0.4581618
	speed: 0.1787s/iter; left time: 796.1918s
Epoch: 2 cost time: 53.426565408706665
Epoch: 2, Steps: 245 | Train Loss: 0.4625576 Vali Loss: 1.2346285 Test Loss: 0.6762213
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4309557
	speed: 0.1524s/iter; left time: 656.9013s
	iters: 200, epoch: 3 | loss: 0.4037144
	speed: 0.1679s/iter; left time: 707.1858s
Epoch: 3 cost time: 39.52555871009827
Epoch: 3, Steps: 245 | Train Loss: 0.4143409 Vali Loss: 1.2876476 Test Loss: 0.7154102
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.4207943
	speed: 0.1581s/iter; left time: 642.6797s
	iters: 200, epoch: 4 | loss: 0.3696718
	speed: 0.2070s/iter; left time: 820.7924s
Epoch: 4 cost time: 44.71237635612488
Epoch: 4, Steps: 245 | Train Loss: 0.3958840 Vali Loss: 1.2793730 Test Loss: 0.7476165
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il96_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.7170059084892273, mae:0.642864465713501
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il96_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5702737
	speed: 0.2008s/iter; left time: 963.8891s
	iters: 200, epoch: 1 | loss: 0.5036645
	speed: 0.2293s/iter; left time: 1078.1674s
Epoch: 1 cost time: 56.73294973373413
Epoch: 1, Steps: 245 | Train Loss: 0.6207596 Vali Loss: 1.1940131 Test Loss: 0.6697101
Validation loss decreased (inf --> 1.194013).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4942342
	speed: 0.1612s/iter; left time: 734.5571s
	iters: 200, epoch: 2 | loss: 0.4772734
	speed: 0.1555s/iter; left time: 692.9861s
Epoch: 2 cost time: 38.573484659194946
Epoch: 2, Steps: 245 | Train Loss: 0.4602272 Vali Loss: 1.2518217 Test Loss: 0.8849573
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3913532
	speed: 0.2259s/iter; left time: 973.9708s
	iters: 200, epoch: 3 | loss: 0.4598399
	speed: 0.1608s/iter; left time: 677.1189s
Epoch: 3 cost time: 45.51900553703308
Epoch: 3, Steps: 245 | Train Loss: 0.4146708 Vali Loss: 1.3502928 Test Loss: 0.9391383
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3880468
	speed: 0.1853s/iter; left time: 753.4356s
	iters: 200, epoch: 4 | loss: 0.3903176
	speed: 0.2298s/iter; left time: 911.5426s
Epoch: 4 cost time: 55.401538610458374
Epoch: 4, Steps: 245 | Train Loss: 0.3955721 Vali Loss: 1.3400361 Test Loss: 0.9749558
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il96_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.6689023375511169, mae:0.6141209602355957
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il96_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5522118
	speed: 0.3100s/iter; left time: 1488.5339s
	iters: 200, epoch: 1 | loss: 0.5271336
	speed: 0.2601s/iter; left time: 1222.7957s
Epoch: 1 cost time: 69.71365237236023
Epoch: 1, Steps: 245 | Train Loss: 0.6179332 Vali Loss: 1.1862022 Test Loss: 0.7423719
Validation loss decreased (inf --> 1.186202).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4525855
	speed: 0.2469s/iter; left time: 1124.8138s
	iters: 200, epoch: 2 | loss: 0.4722717
	speed: 0.1789s/iter; left time: 797.3253s
Epoch: 2 cost time: 53.05293798446655
Epoch: 2, Steps: 245 | Train Loss: 0.4650247 Vali Loss: 1.1815635 Test Loss: 0.6603527
Validation loss decreased (1.186202 --> 1.181563).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4099363
	speed: 0.2014s/iter; left time: 868.4034s
	iters: 200, epoch: 3 | loss: 0.4256523
	speed: 0.1560s/iter; left time: 656.8379s
Epoch: 3 cost time: 42.93227958679199
Epoch: 3, Steps: 245 | Train Loss: 0.4179592 Vali Loss: 1.2431238 Test Loss: 0.6623523
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3975855
	speed: 0.1706s/iter; left time: 693.4794s
	iters: 200, epoch: 4 | loss: 0.3833747
	speed: 0.2047s/iter; left time: 811.8058s
Epoch: 4 cost time: 46.91393160820007
Epoch: 4, Steps: 245 | Train Loss: 0.3975933 Vali Loss: 1.2415378 Test Loss: 0.6422374
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3723480
	speed: 0.2727s/iter; left time: 1042.0901s
	iters: 200, epoch: 5 | loss: 0.3812140
	speed: 0.2900s/iter; left time: 1078.9781s
Epoch: 5 cost time: 67.57015585899353
Epoch: 5, Steps: 245 | Train Loss: 0.3828568 Vali Loss: 1.2372095 Test Loss: 0.6571953
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il96_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.6598798036575317, mae:0.6075524687767029
