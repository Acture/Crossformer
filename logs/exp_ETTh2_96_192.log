Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh2', data_dim=7, data_path='ETTh2.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=192, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=96, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.6006166
	speed: 0.3732s/iter; left time: 1918.6425s
	iters: 200, epoch: 1 | loss: 0.3687930
	speed: 0.1297s/iter; left time: 653.6220s
Epoch: 1 cost time: 57.003483295440674
Epoch: 1, Steps: 262 | Train Loss: 0.4763319 Vali Loss: 0.3515568 Test Loss: 0.7466651
Validation loss decreased (inf --> 0.351557).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3138517
	speed: 0.1093s/iter; left time: 533.3575s
	iters: 200, epoch: 2 | loss: 0.3134746
	speed: 0.1087s/iter; left time: 519.3712s
Epoch: 2 cost time: 28.480304479599
Epoch: 2, Steps: 262 | Train Loss: 0.3377157 Vali Loss: 0.4149087 Test Loss: 0.7592543
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3341282
	speed: 0.2098s/iter; left time: 968.7571s
	iters: 200, epoch: 3 | loss: 0.2668146
	speed: 0.2519s/iter; left time: 1137.6514s
Epoch: 3 cost time: 62.041101932525635
Epoch: 3, Steps: 262 | Train Loss: 0.2804513 Vali Loss: 0.3394695 Test Loss: 0.8056939
Validation loss decreased (0.351557 --> 0.339469).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2597086
	speed: 0.2478s/iter; left time: 1079.0790s
	iters: 200, epoch: 4 | loss: 0.2588659
	speed: 0.2286s/iter; left time: 972.8559s
Epoch: 4 cost time: 60.9876983165741
Epoch: 4, Steps: 262 | Train Loss: 0.2539612 Vali Loss: 0.4183887 Test Loss: 1.1085214
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2006021
	speed: 0.2000s/iter; left time: 818.3998s
	iters: 200, epoch: 5 | loss: 0.1985171
	speed: 0.2693s/iter; left time: 1075.3472s
Epoch: 5 cost time: 61.246113300323486
Epoch: 5, Steps: 262 | Train Loss: 0.2359442 Vali Loss: 0.4093015 Test Loss: 0.8711734
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.2192851
	speed: 0.2251s/iter; left time: 862.2305s
	iters: 200, epoch: 6 | loss: 0.2171532
	speed: 0.1823s/iter; left time: 680.1127s
Epoch: 6 cost time: 47.809348821640015
Epoch: 6, Steps: 262 | Train Loss: 0.2296239 Vali Loss: 0.4398340 Test Loss: 0.9257828
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.8081029057502747, mae:0.6330248117446899
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3108086
	speed: 0.1143s/iter; left time: 587.4633s
	iters: 200, epoch: 1 | loss: 0.2572331
	speed: 0.1440s/iter; left time: 725.7921s
Epoch: 1 cost time: 38.156556606292725
Epoch: 1, Steps: 262 | Train Loss: 0.4823024 Vali Loss: 0.4115284 Test Loss: 0.9610416
Validation loss decreased (inf --> 0.411528).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2669251
	speed: 0.1641s/iter; left time: 800.5342s
	iters: 200, epoch: 2 | loss: 0.3788970
	speed: 0.1948s/iter; left time: 930.9766s
Epoch: 2 cost time: 47.57140612602234
Epoch: 2, Steps: 262 | Train Loss: 0.3372906 Vali Loss: 0.3324906 Test Loss: 0.6481629
Validation loss decreased (0.411528 --> 0.332491).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3260542
	speed: 0.1422s/iter; left time: 656.3919s
	iters: 200, epoch: 3 | loss: 0.2660069
	speed: 0.2131s/iter; left time: 962.3786s
Epoch: 3 cost time: 54.62162113189697
Epoch: 3, Steps: 262 | Train Loss: 0.2923335 Vali Loss: 0.3762218 Test Loss: 0.7928694
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.1981377
	speed: 0.2865s/iter; left time: 1247.8032s
	iters: 200, epoch: 4 | loss: 0.2263561
	speed: 0.2835s/iter; left time: 1206.2419s
Epoch: 4 cost time: 68.86460137367249
Epoch: 4, Steps: 262 | Train Loss: 0.2709578 Vali Loss: 0.3894184 Test Loss: 0.8824619
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2803052
	speed: 0.1806s/iter; left time: 739.3382s
	iters: 200, epoch: 5 | loss: 0.2346851
	speed: 0.1073s/iter; left time: 428.2595s
Epoch: 5 cost time: 35.69075608253479
Epoch: 5, Steps: 262 | Train Loss: 0.2533452 Vali Loss: 0.4344267 Test Loss: 0.9246439
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.6533704400062561, mae:0.5699169635772705
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5403742
	speed: 0.2281s/iter; left time: 1172.7168s
	iters: 200, epoch: 1 | loss: 0.2864396
	speed: 0.2204s/iter; left time: 1110.9079s
Epoch: 1 cost time: 51.98497486114502
Epoch: 1, Steps: 262 | Train Loss: 0.4776378 Vali Loss: 0.3185767 Test Loss: 0.6417865
Validation loss decreased (inf --> 0.318577).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3179373
	speed: 0.1965s/iter; left time: 958.8032s
	iters: 200, epoch: 2 | loss: 0.3023928
	speed: 0.2055s/iter; left time: 981.9058s
Epoch: 2 cost time: 48.8456552028656
Epoch: 2, Steps: 262 | Train Loss: 0.3405143 Vali Loss: 0.3805401 Test Loss: 1.0178103
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2770492
	speed: 0.1625s/iter; left time: 750.2593s
	iters: 200, epoch: 3 | loss: 0.2750235
	speed: 0.2882s/iter; left time: 1301.6657s
Epoch: 3 cost time: 63.91761589050293
Epoch: 3, Steps: 262 | Train Loss: 0.3039419 Vali Loss: 0.3702130 Test Loss: 1.2352309
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2666627
	speed: 0.2070s/iter; left time: 901.3424s
	iters: 200, epoch: 4 | loss: 0.2439540
	speed: 0.1772s/iter; left time: 754.0680s
Epoch: 4 cost time: 51.31918716430664
Epoch: 4, Steps: 262 | Train Loss: 0.2787985 Vali Loss: 0.3754835 Test Loss: 1.3258027
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.6472576856613159, mae:0.5614303350448608
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.6170034
	speed: 0.1595s/iter; left time: 819.9643s
	iters: 200, epoch: 1 | loss: 0.2452841
	speed: 0.2177s/iter; left time: 1097.6654s
Epoch: 1 cost time: 48.169713735580444
Epoch: 1, Steps: 262 | Train Loss: 0.4790371 Vali Loss: 0.3679498 Test Loss: 0.7258619
Validation loss decreased (inf --> 0.367950).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2636169
	speed: 0.1084s/iter; left time: 529.0208s
	iters: 200, epoch: 2 | loss: 0.3171308
	speed: 0.1061s/iter; left time: 507.0165s
Epoch: 2 cost time: 29.827991247177124
Epoch: 2, Steps: 262 | Train Loss: 0.3423684 Vali Loss: 0.3337181 Test Loss: 0.6734377
Validation loss decreased (0.367950 --> 0.333718).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2732619
	speed: 0.2040s/iter; left time: 941.9018s
	iters: 200, epoch: 3 | loss: 0.2716623
	speed: 0.2182s/iter; left time: 985.7176s
Epoch: 3 cost time: 56.3997540473938
Epoch: 3, Steps: 262 | Train Loss: 0.2933940 Vali Loss: 0.3561716 Test Loss: 0.7446785
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3973480
	speed: 0.2258s/iter; left time: 983.1569s
	iters: 200, epoch: 4 | loss: 0.4222353
	speed: 0.1300s/iter; left time: 552.9533s
Epoch: 4 cost time: 40.99247932434082
Epoch: 4, Steps: 262 | Train Loss: 0.2710800 Vali Loss: 0.3788337 Test Loss: 0.7685774
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3115044
	speed: 0.1068s/iter; left time: 437.1263s
	iters: 200, epoch: 5 | loss: 0.2952057
	speed: 0.1443s/iter; left time: 576.2867s
Epoch: 5 cost time: 33.45945954322815
Epoch: 5, Steps: 262 | Train Loss: 0.2476262 Vali Loss: 0.3873122 Test Loss: 0.7184466
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.6795499920845032, mae:0.5752714276313782
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.7131459
	speed: 0.1057s/iter; left time: 543.4212s
	iters: 200, epoch: 1 | loss: 0.4850429
	speed: 0.1074s/iter; left time: 541.3875s
Epoch: 1 cost time: 28.593472242355347
Epoch: 1, Steps: 262 | Train Loss: 0.4819104 Vali Loss: 0.3086753 Test Loss: 0.5620350
Validation loss decreased (inf --> 0.308675).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2053672
	speed: 0.1826s/iter; left time: 891.0497s
	iters: 200, epoch: 2 | loss: 0.3026107
	speed: 0.1885s/iter; left time: 900.7465s
Epoch: 2 cost time: 48.91624140739441
Epoch: 2, Steps: 262 | Train Loss: 0.3379099 Vali Loss: 0.3652247 Test Loss: 0.9677992
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3464290
	speed: 0.2065s/iter; left time: 953.2615s
	iters: 200, epoch: 3 | loss: 0.4245248
	speed: 0.2365s/iter; left time: 1068.1217s
Epoch: 3 cost time: 57.99435257911682
Epoch: 3, Steps: 262 | Train Loss: 0.2926671 Vali Loss: 0.4042469 Test Loss: 1.0976163
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.1819025
	speed: 0.2963s/iter; left time: 1290.2053s
	iters: 200, epoch: 4 | loss: 0.2834966
	speed: 0.2580s/iter; left time: 1097.6447s
Epoch: 4 cost time: 72.54866075515747
Epoch: 4, Steps: 262 | Train Loss: 0.2692539 Vali Loss: 0.4558827 Test Loss: 1.3267612
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.5670337080955505, mae:0.5522299408912659
