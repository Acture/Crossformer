Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='illness', data_dim=7, data_path='national_illness.csv', data_split=[0.7, 0.1, 0.2], devices='0,1,2,3', dropout=0.6, e_layers=2, factor=10, gpu=0, in_len=60, itr=5, learning_rate=0.0005, lradj='type1', n_heads=4, num_workers=0, out_len=60, patience=3, root_path='./datasets/', save_pred=False, seg_len=6, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_illness_il60_ol60_sl6_win2_fa10_dm256_nh4_el2_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 557
val 38
test 134
Epoch: 1 cost time: 4.227013349533081
Epoch: 1, Steps: 18 | Train Loss: 1.2570485 Vali Loss: 0.6573775 Test Loss: 4.5926259
Validation loss decreased (inf --> 0.657377).  Saving model ...
Epoch: 2 cost time: 1.6741783618927002
Epoch: 2, Steps: 18 | Train Loss: 0.8589302 Vali Loss: 0.4121516 Test Loss: 4.4518619
Validation loss decreased (0.657377 --> 0.412152).  Saving model ...
Updating learning rate to 0.00025
Epoch: 3 cost time: 1.340491533279419
Epoch: 3, Steps: 18 | Train Loss: 0.7300774 Vali Loss: 0.2442313 Test Loss: 3.9512929
Validation loss decreased (0.412152 --> 0.244231).  Saving model ...
Epoch: 4 cost time: 1.8296070098876953
Epoch: 4, Steps: 18 | Train Loss: 0.6510229 Vali Loss: 0.2022681 Test Loss: 4.1822230
Validation loss decreased (0.244231 --> 0.202268).  Saving model ...
Updating learning rate to 0.000125
Epoch: 5 cost time: 1.7969510555267334
Epoch: 5, Steps: 18 | Train Loss: 0.6172200 Vali Loss: 0.2129072 Test Loss: 3.9482633
EarlyStopping counter: 1 out of 3
Epoch: 6 cost time: 1.4565658569335938
Epoch: 6, Steps: 18 | Train Loss: 0.5966227 Vali Loss: 0.2010182 Test Loss: 4.1250999
Validation loss decreased (0.202268 --> 0.201018).  Saving model ...
Updating learning rate to 6.25e-05
Epoch: 7 cost time: 0.9642782211303711
Epoch: 7, Steps: 18 | Train Loss: 0.5815438 Vali Loss: 0.2183462 Test Loss: 4.2516441
EarlyStopping counter: 1 out of 3
Epoch: 8 cost time: 0.9326190948486328
Epoch: 8, Steps: 18 | Train Loss: 0.5646055 Vali Loss: 0.1968053 Test Loss: 4.5990210
Validation loss decreased (0.201018 --> 0.196805).  Saving model ...
Updating learning rate to 3.125e-05
Epoch: 9 cost time: 0.969555139541626
Epoch: 9, Steps: 18 | Train Loss: 0.5589577 Vali Loss: 0.1941285 Test Loss: 4.5091082
Validation loss decreased (0.196805 --> 0.194128).  Saving model ...
Epoch: 10 cost time: 0.9859189987182617
Epoch: 10, Steps: 18 | Train Loss: 0.5613155 Vali Loss: 0.2171746 Test Loss: 4.4426398
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
Epoch: 11 cost time: 0.9629154205322266
Epoch: 11, Steps: 18 | Train Loss: 0.5486269 Vali Loss: 0.1987181 Test Loss: 4.7355187
EarlyStopping counter: 2 out of 3
Epoch: 12 cost time: 0.9680769443511963
Epoch: 12, Steps: 18 | Train Loss: 0.5507060 Vali Loss: 0.2153638 Test Loss: 4.5889261
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_illness_il60_ol60_sl6_win2_fa10_dm256_nh4_el2_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 134
mse:4.336514949798584, mae:1.3910555839538574
Use GPU: cuda:0
>>>>>>>start training : Crossformer_illness_il60_ol60_sl6_win2_fa10_dm256_nh4_el2_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 557
val 38
test 134
Epoch: 1 cost time: 0.9581267833709717
Epoch: 1, Steps: 18 | Train Loss: 1.2880407 Vali Loss: 0.6001376 Test Loss: 4.5484476
Validation loss decreased (inf --> 0.600138).  Saving model ...
Epoch: 2 cost time: 0.8815622329711914
Epoch: 2, Steps: 18 | Train Loss: 0.8539509 Vali Loss: 0.4451942 Test Loss: 3.9611460
Validation loss decreased (0.600138 --> 0.445194).  Saving model ...
Updating learning rate to 0.00025
Epoch: 3 cost time: 0.9500608444213867
Epoch: 3, Steps: 18 | Train Loss: 0.7503465 Vali Loss: 0.3279083 Test Loss: 4.1581391
Validation loss decreased (0.445194 --> 0.327908).  Saving model ...
Epoch: 4 cost time: 0.8875060081481934
Epoch: 4, Steps: 18 | Train Loss: 0.6806004 Vali Loss: 0.2379968 Test Loss: 3.9659975
Validation loss decreased (0.327908 --> 0.237997).  Saving model ...
Updating learning rate to 0.000125
Epoch: 5 cost time: 0.9026072025299072
Epoch: 5, Steps: 18 | Train Loss: 0.6316142 Vali Loss: 0.2254568 Test Loss: 3.9414265
Validation loss decreased (0.237997 --> 0.225457).  Saving model ...
Epoch: 6 cost time: 0.9363257884979248
Epoch: 6, Steps: 18 | Train Loss: 0.6184207 Vali Loss: 0.2077340 Test Loss: 4.3058122
Validation loss decreased (0.225457 --> 0.207734).  Saving model ...
Updating learning rate to 6.25e-05
Epoch: 7 cost time: 0.9655921459197998
Epoch: 7, Steps: 18 | Train Loss: 0.5976232 Vali Loss: 0.2062209 Test Loss: 4.2030442
Validation loss decreased (0.207734 --> 0.206221).  Saving model ...
Epoch: 8 cost time: 0.9584367275238037
Epoch: 8, Steps: 18 | Train Loss: 0.5912974 Vali Loss: 0.2054523 Test Loss: 4.1789345
Validation loss decreased (0.206221 --> 0.205452).  Saving model ...
Updating learning rate to 3.125e-05
Epoch: 9 cost time: 0.9746315479278564
Epoch: 9, Steps: 18 | Train Loss: 0.5700824 Vali Loss: 0.1989430 Test Loss: 4.4309812
Validation loss decreased (0.205452 --> 0.198943).  Saving model ...
Epoch: 10 cost time: 0.8985841274261475
Epoch: 10, Steps: 18 | Train Loss: 0.5725138 Vali Loss: 0.2040274 Test Loss: 4.6049524
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
Epoch: 11 cost time: 1.278961420059204
Epoch: 11, Steps: 18 | Train Loss: 0.5688413 Vali Loss: 0.2023129 Test Loss: 4.5494706
EarlyStopping counter: 2 out of 3
Epoch: 12 cost time: 1.7663509845733643
Epoch: 12, Steps: 18 | Train Loss: 0.5597197 Vali Loss: 0.2112053 Test Loss: 4.5493972
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_illness_il60_ol60_sl6_win2_fa10_dm256_nh4_el2_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 134
mse:4.3021979331970215, mae:1.3779200315475464
Use GPU: cuda:0
>>>>>>>start training : Crossformer_illness_il60_ol60_sl6_win2_fa10_dm256_nh4_el2_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 557
val 38
test 134
Epoch: 1 cost time: 1.4182217121124268
Epoch: 1, Steps: 18 | Train Loss: 1.3074716 Vali Loss: 0.6248941 Test Loss: 4.8314631
Validation loss decreased (inf --> 0.624894).  Saving model ...
Epoch: 2 cost time: 1.4162051677703857
Epoch: 2, Steps: 18 | Train Loss: 0.8867250 Vali Loss: 0.5048956 Test Loss: 4.5544269
Validation loss decreased (0.624894 --> 0.504896).  Saving model ...
Updating learning rate to 0.00025
Epoch: 3 cost time: 1.648890733718872
Epoch: 3, Steps: 18 | Train Loss: 0.7703426 Vali Loss: 0.3639271 Test Loss: 4.3108038
Validation loss decreased (0.504896 --> 0.363927).  Saving model ...
Epoch: 4 cost time: 1.5187723636627197
Epoch: 4, Steps: 18 | Train Loss: 0.6792428 Vali Loss: 0.2525956 Test Loss: 4.1193300
Validation loss decreased (0.363927 --> 0.252596).  Saving model ...
Updating learning rate to 0.000125
Epoch: 5 cost time: 0.9585518836975098
Epoch: 5, Steps: 18 | Train Loss: 0.6421136 Vali Loss: 0.2414478 Test Loss: 4.3311031
Validation loss decreased (0.252596 --> 0.241448).  Saving model ...
Epoch: 6 cost time: 0.9241092205047607
Epoch: 6, Steps: 18 | Train Loss: 0.6238153 Vali Loss: 0.1870904 Test Loss: 4.4364832
Validation loss decreased (0.241448 --> 0.187090).  Saving model ...
Updating learning rate to 6.25e-05
Epoch: 7 cost time: 0.9672374725341797
Epoch: 7, Steps: 18 | Train Loss: 0.5934776 Vali Loss: 0.1913460 Test Loss: 4.4036061
EarlyStopping counter: 1 out of 3
Epoch: 8 cost time: 0.9744086265563965
Epoch: 8, Steps: 18 | Train Loss: 0.5863219 Vali Loss: 0.2057192 Test Loss: 4.5170958
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
Epoch: 9 cost time: 0.9662730693817139
Epoch: 9, Steps: 18 | Train Loss: 0.5798408 Vali Loss: 0.1964737 Test Loss: 4.4342278
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_illness_il60_ol60_sl6_win2_fa10_dm256_nh4_el2_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 134
mse:4.300377368927002, mae:1.3592489957809448
Use GPU: cuda:0
>>>>>>>start training : Crossformer_illness_il60_ol60_sl6_win2_fa10_dm256_nh4_el2_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 557
val 38
test 134
Epoch: 1 cost time: 0.9092943668365479
Epoch: 1, Steps: 18 | Train Loss: 1.2996005 Vali Loss: 0.6564039 Test Loss: 4.4074015
Validation loss decreased (inf --> 0.656404).  Saving model ...
Epoch: 2 cost time: 0.8949909210205078
Epoch: 2, Steps: 18 | Train Loss: 0.8814911 Vali Loss: 0.4711073 Test Loss: 4.3372910
Validation loss decreased (0.656404 --> 0.471107).  Saving model ...
Updating learning rate to 0.00025
Epoch: 3 cost time: 0.9876093864440918
Epoch: 3, Steps: 18 | Train Loss: 0.7523414 Vali Loss: 0.3050581 Test Loss: 3.8451048
Validation loss decreased (0.471107 --> 0.305058).  Saving model ...
Epoch: 4 cost time: 1.0139317512512207
Epoch: 4, Steps: 18 | Train Loss: 0.6852339 Vali Loss: 0.2237257 Test Loss: 3.9536773
Validation loss decreased (0.305058 --> 0.223726).  Saving model ...
Updating learning rate to 0.000125
Epoch: 5 cost time: 0.9419682025909424
Epoch: 5, Steps: 18 | Train Loss: 0.6397845 Vali Loss: 0.2119967 Test Loss: 4.1084561
Validation loss decreased (0.223726 --> 0.211997).  Saving model ...
Epoch: 6 cost time: 0.9217522144317627
Epoch: 6, Steps: 18 | Train Loss: 0.6102033 Vali Loss: 0.1941734 Test Loss: 4.2639312
Validation loss decreased (0.211997 --> 0.194173).  Saving model ...
Updating learning rate to 6.25e-05
Epoch: 7 cost time: 0.9419987201690674
Epoch: 7, Steps: 18 | Train Loss: 0.5847420 Vali Loss: 0.1886379 Test Loss: 4.1418000
Validation loss decreased (0.194173 --> 0.188638).  Saving model ...
Epoch: 8 cost time: 0.9652326107025146
Epoch: 8, Steps: 18 | Train Loss: 0.5696053 Vali Loss: 0.1932413 Test Loss: 4.3619537
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
Epoch: 9 cost time: 0.9284224510192871
Epoch: 9, Steps: 18 | Train Loss: 0.5730396 Vali Loss: 0.1933031 Test Loss: 4.1553426
EarlyStopping counter: 2 out of 3
Epoch: 10 cost time: 0.9903194904327393
Epoch: 10, Steps: 18 | Train Loss: 0.5650102 Vali Loss: 0.1873542 Test Loss: 4.6653004
Validation loss decreased (0.188638 --> 0.187354).  Saving model ...
Updating learning rate to 1.5625e-05
Epoch: 11 cost time: 0.9786908626556396
Epoch: 11, Steps: 18 | Train Loss: 0.5650430 Vali Loss: 0.2015864 Test Loss: 4.4869695
EarlyStopping counter: 1 out of 3
Epoch: 12 cost time: 0.9700498580932617
Epoch: 12, Steps: 18 | Train Loss: 0.5499839 Vali Loss: 0.1921814 Test Loss: 4.6743213
EarlyStopping counter: 2 out of 3
Epoch: 13 cost time: 1.6677374839782715
Epoch: 13, Steps: 18 | Train Loss: 0.5605339 Vali Loss: 0.1904318 Test Loss: 4.6414686
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_illness_il60_ol60_sl6_win2_fa10_dm256_nh4_el2_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 134
mse:4.505725383758545, mae:1.438767433166504
Use GPU: cuda:0
>>>>>>>start training : Crossformer_illness_il60_ol60_sl6_win2_fa10_dm256_nh4_el2_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 557
val 38
test 134
Epoch: 1 cost time: 1.9289474487304688
Epoch: 1, Steps: 18 | Train Loss: 1.2386345 Vali Loss: 0.6523926 Test Loss: 4.5873503
Validation loss decreased (inf --> 0.652393).  Saving model ...
Epoch: 2 cost time: 1.171151876449585
Epoch: 2, Steps: 18 | Train Loss: 0.8767206 Vali Loss: 0.4152189 Test Loss: 4.3925288
Validation loss decreased (0.652393 --> 0.415219).  Saving model ...
Updating learning rate to 0.00025
Epoch: 3 cost time: 1.5441784858703613
Epoch: 3, Steps: 18 | Train Loss: 0.7491820 Vali Loss: 0.3323458 Test Loss: 3.9045218
Validation loss decreased (0.415219 --> 0.332346).  Saving model ...
Epoch: 4 cost time: 1.7395665645599365
Epoch: 4, Steps: 18 | Train Loss: 0.6753364 Vali Loss: 0.2111261 Test Loss: 3.9014019
Validation loss decreased (0.332346 --> 0.211126).  Saving model ...
Updating learning rate to 0.000125
Epoch: 5 cost time: 0.9199373722076416
Epoch: 5, Steps: 18 | Train Loss: 0.6348005 Vali Loss: 0.2156543 Test Loss: 3.8500829
EarlyStopping counter: 1 out of 3
Epoch: 6 cost time: 0.9744694232940674
Epoch: 6, Steps: 18 | Train Loss: 0.6022200 Vali Loss: 0.2106031 Test Loss: 3.9226330
Validation loss decreased (0.211126 --> 0.210603).  Saving model ...
Updating learning rate to 6.25e-05
Epoch: 7 cost time: 0.9788699150085449
Epoch: 7, Steps: 18 | Train Loss: 0.5820885 Vali Loss: 0.1929163 Test Loss: 3.9545442
Validation loss decreased (0.210603 --> 0.192916).  Saving model ...
Epoch: 8 cost time: 0.9659380912780762
Epoch: 8, Steps: 18 | Train Loss: 0.5849816 Vali Loss: 0.1991401 Test Loss: 4.2506607
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
Epoch: 9 cost time: 0.9103043079376221
Epoch: 9, Steps: 18 | Train Loss: 0.5642043 Vali Loss: 0.1901708 Test Loss: 4.2742991
Validation loss decreased (0.192916 --> 0.190171).  Saving model ...
Epoch: 10 cost time: 0.9944729804992676
Epoch: 10, Steps: 18 | Train Loss: 0.5630680 Vali Loss: 0.1886291 Test Loss: 4.4870763
Validation loss decreased (0.190171 --> 0.188629).  Saving model ...
Updating learning rate to 1.5625e-05
Epoch: 11 cost time: 0.9723923206329346
Epoch: 11, Steps: 18 | Train Loss: 0.5606694 Vali Loss: 0.1776423 Test Loss: 4.3907313
Validation loss decreased (0.188629 --> 0.177642).  Saving model ...
Epoch: 12 cost time: 0.967928409576416
Epoch: 12, Steps: 18 | Train Loss: 0.5501338 Vali Loss: 0.1998026 Test Loss: 4.5289952
EarlyStopping counter: 1 out of 3
Epoch: 13 cost time: 0.9730973243713379
Epoch: 13, Steps: 18 | Train Loss: 0.5545305 Vali Loss: 0.1765931 Test Loss: 4.4972653
Validation loss decreased (0.177642 --> 0.176593).  Saving model ...
Epoch: 14 cost time: 1.0229010581970215
Epoch: 14, Steps: 18 | Train Loss: 0.5505707 Vali Loss: 0.2085942 Test Loss: 4.5726798
EarlyStopping counter: 1 out of 3
Epoch: 15 cost time: 0.9804697036743164
Epoch: 15, Steps: 18 | Train Loss: 0.5532630 Vali Loss: 0.1796627 Test Loss: 4.7373740
EarlyStopping counter: 2 out of 3
Epoch: 16 cost time: 0.9667263031005859
Epoch: 16, Steps: 18 | Train Loss: 0.5456596 Vali Loss: 0.1912326 Test Loss: 4.7738625
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_illness_il60_ol60_sl6_win2_fa10_dm256_nh4_el2_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 134
mse:4.326620578765869, mae:1.4032492637634277
