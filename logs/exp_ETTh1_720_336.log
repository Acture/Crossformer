Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh1', data_dim=7, data_path='ETTh1.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=336, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=720, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5517931
	speed: 0.1978s/iter; left time: 921.7225s
	iters: 200, epoch: 1 | loss: 0.4565370
	speed: 0.1442s/iter; left time: 657.8840s
Epoch: 1 cost time: 40.21448469161987
Epoch: 1, Steps: 238 | Train Loss: 0.5951905 Vali Loss: 1.2119972 Test Loss: 0.7341447
Validation loss decreased (inf --> 1.211997).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4279231
	speed: 0.1508s/iter; left time: 666.8966s
	iters: 200, epoch: 2 | loss: 0.3734155
	speed: 0.1812s/iter; left time: 783.3394s
Epoch: 2 cost time: 42.04699397087097
Epoch: 2, Steps: 238 | Train Loss: 0.4066484 Vali Loss: 1.2291056 Test Loss: 0.7139452
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3582348
	speed: 0.2041s/iter; left time: 854.2829s
	iters: 200, epoch: 3 | loss: 0.3450506
	speed: 0.2868s/iter; left time: 1171.5317s
Epoch: 3 cost time: 59.016318559646606
Epoch: 3, Steps: 238 | Train Loss: 0.3595104 Vali Loss: 1.2619126 Test Loss: 0.7310162
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3464473
	speed: 0.3921s/iter; left time: 1547.5066s
	iters: 200, epoch: 4 | loss: 0.3403732
	speed: 0.2788s/iter; left time: 1072.5059s
Epoch: 4 cost time: 74.43512272834778
Epoch: 4, Steps: 238 | Train Loss: 0.3465337 Vali Loss: 1.2653183 Test Loss: 0.6697858
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.7335549592971802, mae:0.6612869501113892
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5723494
	speed: 0.1178s/iter; left time: 548.8629s
	iters: 200, epoch: 1 | loss: 0.4617709
	speed: 0.1337s/iter; left time: 609.6971s
Epoch: 1 cost time: 30.80922508239746
Epoch: 1, Steps: 238 | Train Loss: 0.5936386 Vali Loss: 1.2431839 Test Loss: 0.7207063
Validation loss decreased (inf --> 1.243184).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4054801
	speed: 0.1558s/iter; left time: 688.8915s
	iters: 200, epoch: 2 | loss: 0.3659891
	speed: 0.1625s/iter; left time: 702.2954s
Epoch: 2 cost time: 38.16090440750122
Epoch: 2, Steps: 238 | Train Loss: 0.4031279 Vali Loss: 1.3066901 Test Loss: 1.0441146
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3793635
	speed: 0.1986s/iter; left time: 830.9855s
	iters: 200, epoch: 3 | loss: 0.3385917
	speed: 0.1981s/iter; left time: 809.2993s
Epoch: 3 cost time: 47.12795615196228
Epoch: 3, Steps: 238 | Train Loss: 0.3622334 Vali Loss: 1.2726052 Test Loss: 0.9580239
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3263348
	speed: 0.1645s/iter; left time: 649.1578s
	iters: 200, epoch: 4 | loss: 0.3537105
	speed: 0.2079s/iter; left time: 799.9798s
Epoch: 4 cost time: 43.48682713508606
Epoch: 4, Steps: 238 | Train Loss: 0.3473192 Vali Loss: 1.2681100 Test Loss: 0.9704335
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.7200040221214294, mae:0.6622180342674255
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6038171
	speed: 0.1581s/iter; left time: 737.0093s
	iters: 200, epoch: 1 | loss: 0.4589811
	speed: 0.2045s/iter; left time: 932.7489s
Epoch: 1 cost time: 48.15683102607727
Epoch: 1, Steps: 238 | Train Loss: 0.5927897 Vali Loss: 1.2534825 Test Loss: 0.7454900
Validation loss decreased (inf --> 1.253482).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3856089
	speed: 0.3078s/iter; left time: 1361.6082s
	iters: 200, epoch: 2 | loss: 0.3506101
	speed: 0.2265s/iter; left time: 979.3159s
Epoch: 2 cost time: 60.77187418937683
Epoch: 2, Steps: 238 | Train Loss: 0.4073177 Vali Loss: 1.3028945 Test Loss: 0.7885584
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3429055
	speed: 0.1758s/iter; left time: 735.6794s
	iters: 200, epoch: 3 | loss: 0.3511977
	speed: 0.1926s/iter; left time: 786.8643s
Epoch: 3 cost time: 42.95849299430847
Epoch: 3, Steps: 238 | Train Loss: 0.3623515 Vali Loss: 1.3501304 Test Loss: 0.9091279
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3463039
	speed: 0.1568s/iter; left time: 618.8722s
	iters: 200, epoch: 4 | loss: 0.3566204
	speed: 0.1611s/iter; left time: 619.6765s
Epoch: 4 cost time: 37.758851766586304
Epoch: 4, Steps: 238 | Train Loss: 0.3480756 Vali Loss: 1.3808682 Test Loss: 0.7753588
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.7446830868721008, mae:0.6777306199073792
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5783040
	speed: 0.1660s/iter; left time: 773.6484s
	iters: 200, epoch: 1 | loss: 0.4939813
	speed: 0.1703s/iter; left time: 776.7189s
Epoch: 1 cost time: 41.204381465911865
Epoch: 1, Steps: 238 | Train Loss: 0.5975511 Vali Loss: 1.2305266 Test Loss: 0.6785902
Validation loss decreased (inf --> 1.230527).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4274898
	speed: 0.3111s/iter; left time: 1375.8299s
	iters: 200, epoch: 2 | loss: 0.3843550
	speed: 0.3199s/iter; left time: 1383.0711s
Epoch: 2 cost time: 72.84878039360046
Epoch: 2, Steps: 238 | Train Loss: 0.4042697 Vali Loss: 1.2611517 Test Loss: 0.7324754
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3545579
	speed: 0.2000s/iter; left time: 837.0379s
	iters: 200, epoch: 3 | loss: 0.3745312
	speed: 0.1618s/iter; left time: 660.9608s
Epoch: 3 cost time: 44.53675317764282
Epoch: 3, Steps: 238 | Train Loss: 0.3604536 Vali Loss: 1.3299828 Test Loss: 0.6852397
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3356622
	speed: 0.1693s/iter; left time: 668.0771s
	iters: 200, epoch: 4 | loss: 0.3362251
	speed: 0.1686s/iter; left time: 648.7093s
Epoch: 4 cost time: 41.77033233642578
Epoch: 4, Steps: 238 | Train Loss: 0.3457945 Vali Loss: 1.2882904 Test Loss: 0.8416317
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.6775816082954407, mae:0.6328031420707703
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6008421
	speed: 0.1947s/iter; left time: 907.5675s
	iters: 200, epoch: 1 | loss: 0.4508633
	speed: 0.1612s/iter; left time: 735.0485s
Epoch: 1 cost time: 41.74864721298218
Epoch: 1, Steps: 238 | Train Loss: 0.5919981 Vali Loss: 1.2121067 Test Loss: 0.7862722
Validation loss decreased (inf --> 1.212107).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4166632
	speed: 0.1615s/iter; left time: 714.4269s
	iters: 200, epoch: 2 | loss: 0.3993667
	speed: 0.1891s/iter; left time: 817.4716s
Epoch: 2 cost time: 47.440431118011475
Epoch: 2, Steps: 238 | Train Loss: 0.4003634 Vali Loss: 1.3108697 Test Loss: 0.8765809
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3614346
	speed: 0.2180s/iter; left time: 912.3834s
	iters: 200, epoch: 3 | loss: 0.3478256
	speed: 0.2691s/iter; left time: 1099.1991s
Epoch: 3 cost time: 58.73258948326111
Epoch: 3, Steps: 238 | Train Loss: 0.3599189 Vali Loss: 1.2819090 Test Loss: 0.6624042
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3671394
	speed: 0.2593s/iter; left time: 1023.5416s
	iters: 200, epoch: 4 | loss: 0.3255560
	speed: 0.1713s/iter; left time: 658.9605s
Epoch: 4 cost time: 49.25471305847168
Epoch: 4, Steps: 238 | Train Loss: 0.3445986 Vali Loss: 1.2893876 Test Loss: 0.7484016
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.7859103083610535, mae:0.6944460868835449
