Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh2', data_dim=7, data_path='ETTh2.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=96, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=96, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5398558
	speed: 0.3383s/iter; left time: 1759.3562s
	iters: 200, epoch: 1 | loss: 0.2486659
	speed: 0.2637s/iter; left time: 1345.3120s
Epoch: 1 cost time: 76.10542488098145
Epoch: 1, Steps: 265 | Train Loss: 0.4731019 Vali Loss: 0.3547311 Test Loss: 0.7144879
Validation loss decreased (inf --> 0.354731).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2359041
	speed: 0.2410s/iter; left time: 1189.7652s
	iters: 200, epoch: 2 | loss: 0.3058257
	speed: 0.1926s/iter; left time: 931.5814s
Epoch: 2 cost time: 56.51991009712219
Epoch: 2, Steps: 265 | Train Loss: 0.3519382 Vali Loss: 0.3409148 Test Loss: 0.9247790
Validation loss decreased (0.354731 --> 0.340915).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5106845
	speed: 0.2272s/iter; left time: 1061.4250s
	iters: 200, epoch: 3 | loss: 0.2853666
	speed: 0.2068s/iter; left time: 945.0895s
Epoch: 3 cost time: 50.18321084976196
Epoch: 3, Steps: 265 | Train Loss: 0.3121143 Vali Loss: 0.4618662 Test Loss: 1.0380735
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.4912428
	speed: 0.0830s/iter; left time: 365.6842s
	iters: 200, epoch: 4 | loss: 0.3292526
	speed: 0.0835s/iter; left time: 359.3739s
Epoch: 4 cost time: 27.615918397903442
Epoch: 4, Steps: 265 | Train Loss: 0.2923626 Vali Loss: 0.3844215 Test Loss: 1.0360670
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2396272
	speed: 0.1377s/iter; left time: 570.1065s
	iters: 200, epoch: 5 | loss: 0.3254958
	speed: 0.1113s/iter; left time: 449.6791s
Epoch: 5 cost time: 32.287763357162476
Epoch: 5, Steps: 265 | Train Loss: 0.2701823 Vali Loss: 0.3630641 Test Loss: 0.8781016
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.9339038729667664, mae:0.7270050048828125
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4999700
	speed: 0.1888s/iter; left time: 981.9808s
	iters: 200, epoch: 1 | loss: 0.5278854
	speed: 0.2488s/iter; left time: 1269.2206s
Epoch: 1 cost time: 59.648728370666504
Epoch: 1, Steps: 265 | Train Loss: 0.4742145 Vali Loss: 0.6007553 Test Loss: 1.2671240
Validation loss decreased (inf --> 0.600755).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2533432
	speed: 0.1100s/iter; left time: 543.1791s
	iters: 200, epoch: 2 | loss: 0.2212144
	speed: 0.1155s/iter; left time: 558.3851s
Epoch: 2 cost time: 36.61972403526306
Epoch: 2, Steps: 265 | Train Loss: 0.3560743 Vali Loss: 0.3178065 Test Loss: 0.8236225
Validation loss decreased (0.600755 --> 0.317806).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3326864
	speed: 0.2650s/iter; left time: 1238.0032s
	iters: 200, epoch: 3 | loss: 0.2168466
	speed: 0.2651s/iter; left time: 1211.8335s
Epoch: 3 cost time: 71.02492880821228
Epoch: 3, Steps: 265 | Train Loss: 0.3132714 Vali Loss: 0.3333799 Test Loss: 0.8165953
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.1970010
	speed: 0.2458s/iter; left time: 1083.1853s
	iters: 200, epoch: 4 | loss: 0.2624654
	speed: 0.2642s/iter; left time: 1137.8122s
Epoch: 4 cost time: 63.30629563331604
Epoch: 4, Steps: 265 | Train Loss: 0.2984717 Vali Loss: 0.3918441 Test Loss: 1.0177884
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.1860005
	speed: 0.1908s/iter; left time: 789.9951s
	iters: 200, epoch: 5 | loss: 0.3105771
	speed: 0.1416s/iter; left time: 572.3451s
Epoch: 5 cost time: 40.60057044029236
Epoch: 5, Steps: 265 | Train Loss: 0.2813386 Vali Loss: 0.4518679 Test Loss: 1.3654620
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.8316456079483032, mae:0.6720181703567505
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5778417
	speed: 0.1204s/iter; left time: 626.0609s
	iters: 200, epoch: 1 | loss: 0.3847663
	speed: 0.2193s/iter; left time: 1118.8400s
Epoch: 1 cost time: 49.71122908592224
Epoch: 1, Steps: 265 | Train Loss: 0.4777219 Vali Loss: 0.4822183 Test Loss: 1.2208676
Validation loss decreased (inf --> 0.482218).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2684193
	speed: 0.2152s/iter; left time: 1062.3005s
	iters: 200, epoch: 2 | loss: 0.2562837
	speed: 0.1185s/iter; left time: 573.1680s
Epoch: 2 cost time: 40.261693239212036
Epoch: 2, Steps: 265 | Train Loss: 0.3564720 Vali Loss: 0.4191484 Test Loss: 0.9199812
Validation loss decreased (0.482218 --> 0.419148).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3535280
	speed: 0.1081s/iter; left time: 504.8431s
	iters: 200, epoch: 3 | loss: 0.2491234
	speed: 0.1869s/iter; left time: 854.3315s
Epoch: 3 cost time: 38.90053129196167
Epoch: 3, Steps: 265 | Train Loss: 0.3163314 Vali Loss: 0.4912876 Test Loss: 1.0680492
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3757946
	speed: 0.2753s/iter; left time: 1212.7974s
	iters: 200, epoch: 4 | loss: 0.2614637
	speed: 0.2817s/iter; left time: 1213.0366s
Epoch: 4 cost time: 73.79948925971985
Epoch: 4, Steps: 265 | Train Loss: 0.2955363 Vali Loss: 0.4864202 Test Loss: 1.1242462
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3121538
	speed: 0.2519s/iter; left time: 1043.0517s
	iters: 200, epoch: 5 | loss: 0.2441086
	speed: 0.1847s/iter; left time: 746.2238s
Epoch: 5 cost time: 50.63999891281128
Epoch: 5, Steps: 265 | Train Loss: 0.2757433 Vali Loss: 0.5399295 Test Loss: 1.2160085
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.925946831703186, mae:0.6850485801696777
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3815425
	speed: 0.1064s/iter; left time: 553.1473s
	iters: 200, epoch: 1 | loss: 0.4632518
	speed: 0.1778s/iter; left time: 906.7585s
Epoch: 1 cost time: 45.37684726715088
Epoch: 1, Steps: 265 | Train Loss: 0.4807439 Vali Loss: 0.3584878 Test Loss: 0.8044264
Validation loss decreased (inf --> 0.358488).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2817984
	speed: 0.2559s/iter; left time: 1263.1588s
	iters: 200, epoch: 2 | loss: 0.2659817
	speed: 0.1396s/iter; left time: 675.2583s
Epoch: 2 cost time: 47.07621240615845
Epoch: 2, Steps: 265 | Train Loss: 0.3524301 Vali Loss: 0.3821201 Test Loss: 0.8232964
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2920009
	speed: 0.1147s/iter; left time: 535.8812s
	iters: 200, epoch: 3 | loss: 0.2617345
	speed: 0.1601s/iter; left time: 731.7857s
Epoch: 3 cost time: 40.844494342803955
Epoch: 3, Steps: 265 | Train Loss: 0.3109943 Vali Loss: 0.3541012 Test Loss: 1.0339741
Validation loss decreased (0.358488 --> 0.354101).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2658137
	speed: 0.1821s/iter; left time: 802.3732s
	iters: 200, epoch: 4 | loss: 0.2844583
	speed: 0.2234s/iter; left time: 961.8365s
Epoch: 4 cost time: 56.93009066581726
Epoch: 4, Steps: 265 | Train Loss: 0.2944361 Vali Loss: 0.3904528 Test Loss: 1.1218071
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2680337
	speed: 0.2528s/iter; left time: 1046.8427s
	iters: 200, epoch: 5 | loss: 0.2637013
	speed: 0.2692s/iter; left time: 1087.8922s
Epoch: 5 cost time: 69.7121000289917
Epoch: 5, Steps: 265 | Train Loss: 0.2786896 Vali Loss: 0.4394137 Test Loss: 1.3937605
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.3023416
	speed: 0.1224s/iter; left time: 474.4988s
	iters: 200, epoch: 6 | loss: 0.3954163
	speed: 0.1375s/iter; left time: 519.0445s
Epoch: 6 cost time: 40.61690926551819
Epoch: 6, Steps: 265 | Train Loss: 0.2695525 Vali Loss: 0.4970689 Test Loss: 1.7120866
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:1.0442999601364136, mae:0.7487732768058777
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.2830135
	speed: 0.2560s/iter; left time: 1331.2268s
	iters: 200, epoch: 1 | loss: 0.3260404
	speed: 0.1655s/iter; left time: 843.9904s
Epoch: 1 cost time: 50.865172147750854
Epoch: 1, Steps: 265 | Train Loss: 0.4788962 Vali Loss: 0.3867314 Test Loss: 0.8469099
Validation loss decreased (inf --> 0.386731).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4276206
	speed: 0.0825s/iter; left time: 407.0227s
	iters: 200, epoch: 2 | loss: 0.3960322
	speed: 0.0836s/iter; left time: 404.0879s
Epoch: 2 cost time: 22.38559913635254
Epoch: 2, Steps: 265 | Train Loss: 0.3537931 Vali Loss: 0.4086456 Test Loss: 1.2112969
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3657019
	speed: 0.1803s/iter; left time: 842.3577s
	iters: 200, epoch: 3 | loss: 0.3783495
	speed: 0.1425s/iter; left time: 651.5103s
Epoch: 3 cost time: 39.35791063308716
Epoch: 3, Steps: 265 | Train Loss: 0.3103769 Vali Loss: 0.5972993 Test Loss: 1.8683951
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2588505
	speed: 0.1312s/iter; left time: 578.2455s
	iters: 200, epoch: 4 | loss: 0.2107984
	speed: 0.1587s/iter; left time: 683.5521s
Epoch: 4 cost time: 36.75124907493591
Epoch: 4, Steps: 265 | Train Loss: 0.2934978 Vali Loss: 0.4492637 Test Loss: 1.4405644
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.85370272397995, mae:0.6399452090263367
