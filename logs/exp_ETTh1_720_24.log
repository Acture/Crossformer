Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh1', data_dim=7, data_path='ETTh1.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=24, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=720, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7897
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6408188
	speed: 0.2356s/iter; left time: 1140.3676s
	iters: 200, epoch: 1 | loss: 0.5594086
	speed: 0.2226s/iter; left time: 1055.1584s
Epoch: 1 cost time: 56.34651494026184
Epoch: 1, Steps: 247 | Train Loss: 0.6704937 Vali Loss: 1.2261667 Test Loss: 0.6906374
Validation loss decreased (inf --> 1.226167).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5165451
	speed: 0.2776s/iter; left time: 1275.2887s
	iters: 200, epoch: 2 | loss: 0.5034437
	speed: 0.3263s/iter; left time: 1466.3792s
Epoch: 2 cost time: 67.81903386116028
Epoch: 2, Steps: 247 | Train Loss: 0.5152678 Vali Loss: 1.2382613 Test Loss: 0.7337463
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4371120
	speed: 0.1513s/iter; left time: 657.7945s
	iters: 200, epoch: 3 | loss: 0.4988298
	speed: 0.1839s/iter; left time: 780.8359s
Epoch: 3 cost time: 40.733478307724
Epoch: 3, Steps: 247 | Train Loss: 0.4808009 Vali Loss: 1.2507647 Test Loss: 0.7279664
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.4576350
	speed: 0.2149s/iter; left time: 880.9503s
	iters: 200, epoch: 4 | loss: 0.4727338
	speed: 0.2148s/iter; left time: 859.2903s
Epoch: 4 cost time: 50.34776163101196
Epoch: 4, Steps: 247 | Train Loss: 0.4636319 Vali Loss: 1.2507583 Test Loss: 0.7982311
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.6896562576293945, mae:0.6331671476364136
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7897
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6336555
	speed: 0.1692s/iter; left time: 818.8575s
	iters: 200, epoch: 1 | loss: 0.5161797
	speed: 0.2278s/iter; left time: 1080.1655s
Epoch: 1 cost time: 53.79361343383789
Epoch: 1, Steps: 247 | Train Loss: 0.6706421 Vali Loss: 1.2801290 Test Loss: 0.6391458
Validation loss decreased (inf --> 1.280129).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5056685
	speed: 0.2896s/iter; left time: 1330.4411s
	iters: 200, epoch: 2 | loss: 0.4754070
	speed: 0.3015s/iter; left time: 1354.7509s
Epoch: 2 cost time: 66.80131316184998
Epoch: 2, Steps: 247 | Train Loss: 0.5158101 Vali Loss: 1.2703774 Test Loss: 0.7386646
Validation loss decreased (1.280129 --> 1.270377).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4678087
	speed: 0.1540s/iter; left time: 669.5200s
	iters: 200, epoch: 3 | loss: 0.5069067
	speed: 0.2010s/iter; left time: 853.6377s
Epoch: 3 cost time: 44.47350883483887
Epoch: 3, Steps: 247 | Train Loss: 0.4810825 Vali Loss: 1.3157001 Test Loss: 0.8826619
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.4649333
	speed: 0.1704s/iter; left time: 698.5247s
	iters: 200, epoch: 4 | loss: 0.4298258
	speed: 0.1291s/iter; left time: 516.2113s
Epoch: 4 cost time: 35.55360651016235
Epoch: 4, Steps: 247 | Train Loss: 0.4622552 Vali Loss: 1.2948183 Test Loss: 0.8146230
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.4736097
	speed: 0.1586s/iter; left time: 611.0194s
	iters: 200, epoch: 5 | loss: 0.4293560
	speed: 0.1993s/iter; left time: 747.8578s
Epoch: 5 cost time: 49.32078981399536
Epoch: 5, Steps: 247 | Train Loss: 0.4458854 Vali Loss: 1.2732795 Test Loss: 0.8252398
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.737994372844696, mae:0.6592497229576111
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7897
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6037022
	speed: 0.2129s/iter; left time: 1030.8849s
	iters: 200, epoch: 1 | loss: 0.5804499
	speed: 0.1659s/iter; left time: 786.3236s
Epoch: 1 cost time: 48.292702198028564
Epoch: 1, Steps: 247 | Train Loss: 0.6679355 Vali Loss: 1.2112059 Test Loss: 0.7305994
Validation loss decreased (inf --> 1.211206).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5359036
	speed: 0.1676s/iter; left time: 769.9357s
	iters: 200, epoch: 2 | loss: 0.5198159
	speed: 0.1542s/iter; left time: 693.0070s
Epoch: 2 cost time: 40.24034857749939
Epoch: 2, Steps: 247 | Train Loss: 0.5144961 Vali Loss: 1.2482487 Test Loss: 0.7103270
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4981180
	speed: 0.1546s/iter; left time: 672.1147s
	iters: 200, epoch: 3 | loss: 0.4576104
	speed: 0.2194s/iter; left time: 931.9280s
Epoch: 3 cost time: 47.80497717857361
Epoch: 3, Steps: 247 | Train Loss: 0.4805743 Vali Loss: 1.2771719 Test Loss: 0.7528641
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.4700599
	speed: 0.1497s/iter; left time: 613.8225s
	iters: 200, epoch: 4 | loss: 0.4220392
	speed: 0.2412s/iter; left time: 964.9836s
Epoch: 4 cost time: 52.92638683319092
Epoch: 4, Steps: 247 | Train Loss: 0.4657318 Vali Loss: 1.2703686 Test Loss: 0.7467223
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.7296653985977173, mae:0.657645583152771
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7897
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5874862
	speed: 0.2779s/iter; left time: 1345.2804s
	iters: 200, epoch: 1 | loss: 0.5859106
	speed: 0.2519s/iter; left time: 1194.4023s
Epoch: 1 cost time: 62.445911169052124
Epoch: 1, Steps: 247 | Train Loss: 0.6702763 Vali Loss: 1.2690777 Test Loss: 0.7140837
Validation loss decreased (inf --> 1.269078).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5120425
	speed: 0.1492s/iter; left time: 685.5230s
	iters: 200, epoch: 2 | loss: 0.5134067
	speed: 0.1602s/iter; left time: 719.9138s
Epoch: 2 cost time: 37.68852949142456
Epoch: 2, Steps: 247 | Train Loss: 0.5165703 Vali Loss: 1.2755298 Test Loss: 0.7643102
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4847590
	speed: 0.1890s/iter; left time: 821.5703s
	iters: 200, epoch: 3 | loss: 0.4813862
	speed: 0.1608s/iter; left time: 682.9317s
Epoch: 3 cost time: 43.422489166259766
Epoch: 3, Steps: 247 | Train Loss: 0.4828592 Vali Loss: 1.3254325 Test Loss: 0.8166507
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.4451845
	speed: 0.1516s/iter; left time: 621.3921s
	iters: 200, epoch: 4 | loss: 0.4979896
	speed: 0.1865s/iter; left time: 746.1673s
Epoch: 4 cost time: 49.42499780654907
Epoch: 4, Steps: 247 | Train Loss: 0.4651337 Vali Loss: 1.3185878 Test Loss: 0.7404977
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.7133777737617493, mae:0.6395005583763123
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7897
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5905088
	speed: 0.2696s/iter; left time: 1305.2379s
	iters: 200, epoch: 1 | loss: 0.5556185
	speed: 0.2402s/iter; left time: 1138.9354s
Epoch: 1 cost time: 58.215035915374756
Epoch: 1, Steps: 247 | Train Loss: 0.6716894 Vali Loss: 1.2733176 Test Loss: 0.7314103
Validation loss decreased (inf --> 1.273318).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5173531
	speed: 0.1528s/iter; left time: 701.9571s
	iters: 200, epoch: 2 | loss: 0.4964699
	speed: 0.2004s/iter; left time: 900.4358s
Epoch: 2 cost time: 43.792986154556274
Epoch: 2, Steps: 247 | Train Loss: 0.5178272 Vali Loss: 1.2845837 Test Loss: 0.7565673
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4719588
	speed: 0.1536s/iter; left time: 667.8519s
	iters: 200, epoch: 3 | loss: 0.5142496
	speed: 0.1655s/iter; left time: 702.7783s
Epoch: 3 cost time: 39.005377769470215
Epoch: 3, Steps: 247 | Train Loss: 0.4803676 Vali Loss: 1.3285605 Test Loss: 0.7711310
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.4601676
	speed: 0.1497s/iter; left time: 613.7122s
	iters: 200, epoch: 4 | loss: 0.4725522
	speed: 0.2627s/iter; left time: 1050.7493s
Epoch: 4 cost time: 55.72946572303772
Epoch: 4, Steps: 247 | Train Loss: 0.4610786 Vali Loss: 1.3354445 Test Loss: 0.7916804
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il24_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.7309367060661316, mae:0.6498294472694397
