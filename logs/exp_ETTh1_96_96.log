Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh1', data_dim=7, data_path='ETTh1.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=96, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=96, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3655326
	speed: 0.3482s/iter; left time: 1811.1576s
	iters: 200, epoch: 1 | loss: 0.4184499
	speed: 0.2749s/iter; left time: 1402.2637s
Epoch: 1 cost time: 77.39697933197021
Epoch: 1, Steps: 265 | Train Loss: 0.4613873 Vali Loss: 0.7180579 Test Loss: 0.4143564
Validation loss decreased (inf --> 0.718058).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3427678
	speed: 0.1270s/iter; left time: 626.8206s
	iters: 200, epoch: 2 | loss: 0.3465080
	speed: 0.1060s/iter; left time: 512.4895s
Epoch: 2 cost time: 30.294756174087524
Epoch: 2, Steps: 265 | Train Loss: 0.3627520 Vali Loss: 0.7433286 Test Loss: 0.4221703
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3788777
	speed: 0.1057s/iter; left time: 493.6185s
	iters: 200, epoch: 3 | loss: 0.2868379
	speed: 0.1155s/iter; left time: 527.7267s
Epoch: 3 cost time: 30.15854573249817
Epoch: 3, Steps: 265 | Train Loss: 0.3365687 Vali Loss: 0.8078957 Test Loss: 0.4697840
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3504542
	speed: 0.1294s/iter; left time: 570.2803s
	iters: 200, epoch: 4 | loss: 0.3894754
	speed: 0.1046s/iter; left time: 450.3070s
Epoch: 4 cost time: 30.319806337356567
Epoch: 4, Steps: 265 | Train Loss: 0.3252318 Vali Loss: 0.7820197 Test Loss: 0.4808165
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.4139946401119232, mae:0.4361222982406616
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4168298
	speed: 0.1066s/iter; left time: 554.6739s
	iters: 200, epoch: 1 | loss: 0.3988178
	speed: 0.1004s/iter; left time: 512.1620s
Epoch: 1 cost time: 32.61387848854065
Epoch: 1, Steps: 265 | Train Loss: 0.4578064 Vali Loss: 0.6883108 Test Loss: 0.3952564
Validation loss decreased (inf --> 0.688311).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3366484
	speed: 0.2410s/iter; left time: 1189.5161s
	iters: 200, epoch: 2 | loss: 0.3490313
	speed: 0.2194s/iter; left time: 1061.0694s
Epoch: 2 cost time: 60.18107342720032
Epoch: 2, Steps: 265 | Train Loss: 0.3612171 Vali Loss: 0.7085246 Test Loss: 0.4075345
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3319464
	speed: 0.1255s/iter; left time: 586.0837s
	iters: 200, epoch: 3 | loss: 0.3122722
	speed: 0.1056s/iter; left time: 482.8803s
Epoch: 3 cost time: 30.90826940536499
Epoch: 3, Steps: 265 | Train Loss: 0.3356074 Vali Loss: 0.7155144 Test Loss: 0.4244490
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3360902
	speed: 0.1303s/iter; left time: 574.2753s
	iters: 200, epoch: 4 | loss: 0.3327136
	speed: 0.1126s/iter; left time: 485.0040s
Epoch: 4 cost time: 31.18460178375244
Epoch: 4, Steps: 265 | Train Loss: 0.3257391 Vali Loss: 0.7368220 Test Loss: 0.4219632
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3948236107826233, mae:0.4232158362865448
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4362596
	speed: 0.1061s/iter; left time: 551.6829s
	iters: 200, epoch: 1 | loss: 0.4291679
	speed: 0.1053s/iter; left time: 537.3651s
Epoch: 1 cost time: 28.233531713485718
Epoch: 1, Steps: 265 | Train Loss: 0.4577056 Vali Loss: 0.6988058 Test Loss: 0.3948309
Validation loss decreased (inf --> 0.698806).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4038586
	speed: 0.1667s/iter; left time: 822.7069s
	iters: 200, epoch: 2 | loss: 0.3366490
	speed: 0.1333s/iter; left time: 644.3981s
Epoch: 2 cost time: 40.643409967422485
Epoch: 2, Steps: 265 | Train Loss: 0.3607644 Vali Loss: 0.7045681 Test Loss: 0.3933365
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2881958
	speed: 0.1647s/iter; left time: 769.1347s
	iters: 200, epoch: 3 | loss: 0.3283304
	speed: 0.1941s/iter; left time: 887.4206s
Epoch: 3 cost time: 47.30972480773926
Epoch: 3, Steps: 265 | Train Loss: 0.3358051 Vali Loss: 0.7727512 Test Loss: 0.4824085
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3218442
	speed: 0.1104s/iter; left time: 486.5795s
	iters: 200, epoch: 4 | loss: 0.2954817
	speed: 0.1393s/iter; left time: 599.6597s
Epoch: 4 cost time: 32.243762493133545
Epoch: 4, Steps: 265 | Train Loss: 0.3231683 Vali Loss: 0.7581834 Test Loss: 0.4567903
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.394470751285553, mae:0.41948211193084717
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4348430
	speed: 0.1031s/iter; left time: 536.3105s
	iters: 200, epoch: 1 | loss: 0.3881949
	speed: 0.1042s/iter; left time: 531.3599s
Epoch: 1 cost time: 27.647881984710693
Epoch: 1, Steps: 265 | Train Loss: 0.4572907 Vali Loss: 0.6867453 Test Loss: 0.4069199
Validation loss decreased (inf --> 0.686745).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3312242
	speed: 0.1084s/iter; left time: 535.2855s
	iters: 200, epoch: 2 | loss: 0.3886795
	speed: 0.1283s/iter; left time: 620.4519s
Epoch: 2 cost time: 31.902586460113525
Epoch: 2, Steps: 265 | Train Loss: 0.3643103 Vali Loss: 0.7374519 Test Loss: 0.4540679
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4069608
	speed: 0.1004s/iter; left time: 469.1275s
	iters: 200, epoch: 3 | loss: 0.3619187
	speed: 0.1754s/iter; left time: 801.7575s
Epoch: 3 cost time: 39.11987543106079
Epoch: 3, Steps: 265 | Train Loss: 0.3396642 Vali Loss: 0.7103419 Test Loss: 0.4051836
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3447105
	speed: 0.1691s/iter; left time: 744.9388s
	iters: 200, epoch: 4 | loss: 0.3038221
	speed: 0.2039s/iter; left time: 878.0272s
Epoch: 4 cost time: 49.89499354362488
Epoch: 4, Steps: 265 | Train Loss: 0.3277814 Vali Loss: 0.7481421 Test Loss: 0.4301235
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.4065883457660675, mae:0.43550458550453186
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5198467
	speed: 0.0846s/iter; left time: 439.9689s
	iters: 200, epoch: 1 | loss: 0.3834356
	speed: 0.0855s/iter; left time: 436.0963s
Epoch: 1 cost time: 25.139893770217896
Epoch: 1, Steps: 265 | Train Loss: 0.4615105 Vali Loss: 0.7407904 Test Loss: 0.3996042
Validation loss decreased (inf --> 0.740790).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3371802
	speed: 0.1046s/iter; left time: 516.0899s
	iters: 200, epoch: 2 | loss: 0.4015985
	speed: 0.1161s/iter; left time: 561.5229s
Epoch: 2 cost time: 33.10218954086304
Epoch: 2, Steps: 265 | Train Loss: 0.3658630 Vali Loss: 0.7921193 Test Loss: 0.4859197
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3088330
	speed: 0.1573s/iter; left time: 734.8449s
	iters: 200, epoch: 3 | loss: 0.3625562
	speed: 0.1096s/iter; left time: 501.1093s
Epoch: 3 cost time: 33.640209913253784
Epoch: 3, Steps: 265 | Train Loss: 0.3390857 Vali Loss: 0.7894565 Test Loss: 0.5013896
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3715362
	speed: 0.1256s/iter; left time: 553.4883s
	iters: 200, epoch: 4 | loss: 0.3501743
	speed: 0.1020s/iter; left time: 439.2197s
Epoch: 4 cost time: 29.706153869628906
Epoch: 4, Steps: 265 | Train Loss: 0.3263045 Vali Loss: 0.7045404 Test Loss: 0.4204409
Validation loss decreased (0.740790 --> 0.704540).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3806188
	speed: 0.1355s/iter; left time: 561.2797s
	iters: 200, epoch: 5 | loss: 0.3217791
	speed: 0.1308s/iter; left time: 528.4128s
Epoch: 5 cost time: 33.8960440158844
Epoch: 5, Steps: 265 | Train Loss: 0.3152488 Vali Loss: 0.7635807 Test Loss: 0.5084570
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.2979732
	speed: 0.1087s/iter; left time: 421.5088s
	iters: 200, epoch: 6 | loss: 0.2934752
	speed: 0.1352s/iter; left time: 510.5310s
Epoch: 6 cost time: 37.225404262542725
Epoch: 6, Steps: 265 | Train Loss: 0.3098177 Vali Loss: 0.7805196 Test Loss: 0.5483233
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.3296582
	speed: 0.2520s/iter; left time: 910.1351s
	iters: 200, epoch: 7 | loss: 0.3128355
	speed: 0.1712s/iter; left time: 601.1118s
Epoch: 7 cost time: 49.9649920463562
Epoch: 7, Steps: 265 | Train Loss: 0.3045941 Vali Loss: 0.7991969 Test Loss: 0.5910386
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il96_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.41980454325675964, mae:0.4388611912727356
