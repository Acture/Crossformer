Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=128, d_model=64, data='ETTh1', data_dim=7, data_path='ETTh1.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=720, itr=5, learning_rate=5e-05, lradj='fixed', n_heads=2, num_workers=0, out_len=720, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.9752656
	speed: 0.2372s/iter; left time: 1048.7397s
	iters: 200, epoch: 1 | loss: 0.7278349
	speed: 0.1749s/iter; left time: 755.5623s
Epoch: 1 cost time: 46.86413383483887
Epoch: 1, Steps: 226 | Train Loss: 1.0864176 Vali Loss: 1.3907917 Test Loss: 0.6642260
Validation loss decreased (inf --> 1.390792).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5894805
	speed: 0.1750s/iter; left time: 733.9459s
	iters: 200, epoch: 2 | loss: 0.5224298
	speed: 0.1147s/iter; left time: 469.7309s
Epoch: 2 cost time: 31.530374765396118
Epoch: 2, Steps: 226 | Train Loss: 0.6280612 Vali Loss: 1.2344592 Test Loss: 0.5241734
Validation loss decreased (1.390792 --> 1.234459).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5552008
	speed: 0.2145s/iter; left time: 851.3907s
	iters: 200, epoch: 3 | loss: 0.5599646
	speed: 0.2910s/iter; left time: 1125.9978s
Epoch: 3 cost time: 58.9610276222229
Epoch: 3, Steps: 226 | Train Loss: 0.5465920 Vali Loss: 1.2004434 Test Loss: 0.5157126
Validation loss decreased (1.234459 --> 1.200443).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4846796
	speed: 0.2187s/iter; left time: 818.7244s
	iters: 200, epoch: 4 | loss: 0.4940266
	speed: 0.2029s/iter; left time: 739.0416s
Epoch: 4 cost time: 48.243359088897705
Epoch: 4, Steps: 226 | Train Loss: 0.4985469 Vali Loss: 1.2027322 Test Loss: 0.5717473
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.4764908
	speed: 0.2059s/iter; left time: 724.1992s
	iters: 200, epoch: 5 | loss: 0.4449465
	speed: 0.1438s/iter; left time: 491.4710s
Epoch: 5 cost time: 38.796112060546875
Epoch: 5, Steps: 226 | Train Loss: 0.4617646 Vali Loss: 1.2352091 Test Loss: 0.6960099
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.4504482
	speed: 0.0853s/iter; left time: 280.6877s
	iters: 200, epoch: 6 | loss: 0.4411749
	speed: 0.1107s/iter; left time: 353.3003s
Epoch: 6 cost time: 22.54576277732849
Epoch: 6, Steps: 226 | Train Loss: 0.4406301 Vali Loss: 1.2415568 Test Loss: 0.6742217
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.514776885509491, mae:0.5263065099716187
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.9402772
	speed: 0.3162s/iter; left time: 1398.1323s
	iters: 200, epoch: 1 | loss: 0.7235413
	speed: 0.3209s/iter; left time: 1386.4506s
Epoch: 1 cost time: 71.47900629043579
Epoch: 1, Steps: 226 | Train Loss: 1.0491499 Vali Loss: 1.3827250 Test Loss: 0.6561992
Validation loss decreased (inf --> 1.382725).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6559733
	speed: 0.2621s/iter; left time: 1099.3328s
	iters: 200, epoch: 2 | loss: 0.5759553
	speed: 0.1582s/iter; left time: 647.7169s
Epoch: 2 cost time: 45.430579662323
Epoch: 2, Steps: 226 | Train Loss: 0.6188795 Vali Loss: 1.2228924 Test Loss: 0.5396246
Validation loss decreased (1.382725 --> 1.222892).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5207258
	speed: 0.1374s/iter; left time: 545.4851s
	iters: 200, epoch: 3 | loss: 0.5097715
	speed: 0.1133s/iter; left time: 438.3625s
Epoch: 3 cost time: 27.637471675872803
Epoch: 3, Steps: 226 | Train Loss: 0.5296073 Vali Loss: 1.2177631 Test Loss: 0.6459895
Validation loss decreased (1.222892 --> 1.217763).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5034564
	speed: 0.1480s/iter; left time: 554.0568s
	iters: 200, epoch: 4 | loss: 0.4861436
	speed: 0.1540s/iter; left time: 560.9567s
Epoch: 4 cost time: 33.81566500663757
Epoch: 4, Steps: 226 | Train Loss: 0.4841669 Vali Loss: 1.2365573 Test Loss: 0.6800194
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.4663407
	speed: 0.1441s/iter; left time: 506.7820s
	iters: 200, epoch: 5 | loss: 0.4460718
	speed: 0.1846s/iter; left time: 630.7067s
Epoch: 5 cost time: 40.65077090263367
Epoch: 5, Steps: 226 | Train Loss: 0.4610360 Vali Loss: 1.2802538 Test Loss: 0.6620455
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.4021497
	speed: 0.1528s/iter; left time: 502.8481s
	iters: 200, epoch: 6 | loss: 0.4336157
	speed: 0.1572s/iter; left time: 501.6501s
Epoch: 6 cost time: 35.328362464904785
Epoch: 6, Steps: 226 | Train Loss: 0.4440827 Vali Loss: 1.3368723 Test Loss: 0.7736411
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.6454606652259827, mae:0.6223830580711365
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.9783602
	speed: 0.1636s/iter; left time: 723.1552s
	iters: 200, epoch: 1 | loss: 0.6893383
	speed: 0.1770s/iter; left time: 765.0254s
Epoch: 1 cost time: 37.34359288215637
Epoch: 1, Steps: 226 | Train Loss: 1.0499336 Vali Loss: 1.3754855 Test Loss: 0.6537682
Validation loss decreased (inf --> 1.375485).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5604025
	speed: 0.1200s/iter; left time: 503.4142s
	iters: 200, epoch: 2 | loss: 0.5861561
	speed: 0.1182s/iter; left time: 484.2209s
Epoch: 2 cost time: 26.583449125289917
Epoch: 2, Steps: 226 | Train Loss: 0.6169566 Vali Loss: 1.2193655 Test Loss: 0.5130509
Validation loss decreased (1.375485 --> 1.219365).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5797071
	speed: 0.1466s/iter; left time: 582.0397s
	iters: 200, epoch: 3 | loss: 0.5291618
	speed: 0.1831s/iter; left time: 708.5792s
Epoch: 3 cost time: 41.611008405685425
Epoch: 3, Steps: 226 | Train Loss: 0.5445581 Vali Loss: 1.2158930 Test Loss: 0.5438663
Validation loss decreased (1.219365 --> 1.215893).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5007973
	speed: 0.2908s/iter; left time: 1088.3768s
	iters: 200, epoch: 4 | loss: 0.4700903
	speed: 0.2895s/iter; left time: 1054.6740s
Epoch: 4 cost time: 64.07679963111877
Epoch: 4, Steps: 226 | Train Loss: 0.5047658 Vali Loss: 1.2048725 Test Loss: 0.6180540
Validation loss decreased (1.215893 --> 1.204873).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4624391
	speed: 0.1949s/iter; left time: 685.3752s
	iters: 200, epoch: 5 | loss: 0.4727268
	speed: 0.2045s/iter; left time: 698.7682s
Epoch: 5 cost time: 45.59530019760132
Epoch: 5, Steps: 226 | Train Loss: 0.4684273 Vali Loss: 1.2222901 Test Loss: 0.6402325
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.4361018
	speed: 0.1047s/iter; left time: 344.4771s
	iters: 200, epoch: 6 | loss: 0.4581275
	speed: 0.1039s/iter; left time: 331.3869s
Epoch: 6 cost time: 24.72536826133728
Epoch: 6, Steps: 226 | Train Loss: 0.4478546 Vali Loss: 1.2421359 Test Loss: 0.6692134
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 7 | loss: 0.4379974
	speed: 0.1880s/iter; left time: 576.2468s
	iters: 200, epoch: 7 | loss: 0.4196045
	speed: 0.2330s/iter; left time: 690.7131s
Epoch: 7 cost time: 50.79351758956909
Epoch: 7, Steps: 226 | Train Loss: 0.4344165 Vali Loss: 1.2461218 Test Loss: 0.7075014
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.6174875497817993, mae:0.5912913680076599
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.9614185
	speed: 0.2800s/iter; left time: 1237.9501s
	iters: 200, epoch: 1 | loss: 0.7771442
	speed: 0.2511s/iter; left time: 1085.1770s
Epoch: 1 cost time: 57.986066818237305
Epoch: 1, Steps: 226 | Train Loss: 1.0444743 Vali Loss: 1.3840640 Test Loss: 0.6535090
Validation loss decreased (inf --> 1.384064).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6288775
	speed: 0.1749s/iter; left time: 733.8978s
	iters: 200, epoch: 2 | loss: 0.5837831
	speed: 0.1973s/iter; left time: 807.7860s
Epoch: 2 cost time: 39.84399938583374
Epoch: 2, Steps: 226 | Train Loss: 0.6275131 Vali Loss: 1.2540364 Test Loss: 0.5426909
Validation loss decreased (1.384064 --> 1.254036).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5423217
	speed: 0.1103s/iter; left time: 437.9144s
	iters: 200, epoch: 3 | loss: 0.5812709
	speed: 0.1290s/iter; left time: 498.9205s
Epoch: 3 cost time: 27.117063522338867
Epoch: 3, Steps: 226 | Train Loss: 0.5454819 Vali Loss: 1.1948967 Test Loss: 0.5024420
Validation loss decreased (1.254036 --> 1.194897).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4781141
	speed: 0.1204s/iter; left time: 450.6836s
	iters: 200, epoch: 4 | loss: 0.5015460
	speed: 0.1225s/iter; left time: 446.3225s
Epoch: 4 cost time: 27.84237313270569
Epoch: 4, Steps: 226 | Train Loss: 0.5025822 Vali Loss: 1.1591038 Test Loss: 0.5915329
Validation loss decreased (1.194897 --> 1.159104).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4731798
	speed: 0.3011s/iter; left time: 1059.1348s
	iters: 200, epoch: 5 | loss: 0.4422376
	speed: 0.2672s/iter; left time: 913.0842s
Epoch: 5 cost time: 64.63473844528198
Epoch: 5, Steps: 226 | Train Loss: 0.4627038 Vali Loss: 1.1754126 Test Loss: 0.7629558
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.4817021
	speed: 0.1639s/iter; left time: 539.4677s
	iters: 200, epoch: 6 | loss: 0.4371288
	speed: 0.1369s/iter; left time: 436.7474s
Epoch: 6 cost time: 32.688029289245605
Epoch: 6, Steps: 226 | Train Loss: 0.4427232 Vali Loss: 1.1956265 Test Loss: 0.7301127
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 7 | loss: 0.4443963
	speed: 0.1333s/iter; left time: 408.6161s
	iters: 200, epoch: 7 | loss: 0.4399940
	speed: 0.1658s/iter; left time: 491.5322s
Epoch: 7 cost time: 33.283496379852295
Epoch: 7, Steps: 226 | Train Loss: 0.4292271 Vali Loss: 1.2097250 Test Loss: 0.7413924
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.5913005471229553, mae:0.5765771865844727
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.9660549
	speed: 0.1410s/iter; left time: 623.1791s
	iters: 200, epoch: 1 | loss: 0.7373129
	speed: 0.1723s/iter; left time: 744.7071s
Epoch: 1 cost time: 36.320462703704834
Epoch: 1, Steps: 226 | Train Loss: 1.0636707 Vali Loss: 1.3806376 Test Loss: 0.6616402
Validation loss decreased (inf --> 1.380638).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5879473
	speed: 0.1093s/iter; left time: 458.5046s
	iters: 200, epoch: 2 | loss: 0.6226198
	speed: 0.1771s/iter; left time: 725.3829s
Epoch: 2 cost time: 33.79127264022827
Epoch: 2, Steps: 226 | Train Loss: 0.6186598 Vali Loss: 1.2231813 Test Loss: 0.5189279
Validation loss decreased (1.380638 --> 1.223181).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5283346
	speed: 0.2733s/iter; left time: 1084.7511s
	iters: 200, epoch: 3 | loss: 0.5202240
	speed: 0.1879s/iter; left time: 727.1530s
Epoch: 3 cost time: 50.47971320152283
Epoch: 3, Steps: 226 | Train Loss: 0.5395750 Vali Loss: 1.2024952 Test Loss: 0.5650391
Validation loss decreased (1.223181 --> 1.202495).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4378132
	speed: 0.1438s/iter; left time: 538.3383s
	iters: 200, epoch: 4 | loss: 0.5125917
	speed: 0.1450s/iter; left time: 528.2298s
Epoch: 4 cost time: 32.35474443435669
Epoch: 4, Steps: 226 | Train Loss: 0.4923892 Vali Loss: 1.2302894 Test Loss: 0.6694976
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.4721308
	speed: 0.1389s/iter; left time: 488.3521s
	iters: 200, epoch: 5 | loss: 0.4423470
	speed: 0.1699s/iter; left time: 580.6889s
Epoch: 5 cost time: 34.28039526939392
Epoch: 5, Steps: 226 | Train Loss: 0.4645144 Vali Loss: 1.2744595 Test Loss: 0.7394534
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.4184796
	speed: 0.0929s/iter; left time: 305.8577s
	iters: 200, epoch: 6 | loss: 0.4597807
	speed: 0.0829s/iter; left time: 264.5193s
Epoch: 6 cost time: 19.668015003204346
Epoch: 6, Steps: 226 | Train Loss: 0.4450888 Vali Loss: 1.3045780 Test Loss: 0.8248089
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm64_nh2_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.5644271373748779, mae:0.5536717176437378
