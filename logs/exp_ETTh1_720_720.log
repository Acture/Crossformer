Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh1', data_dim=7, data_path='ETTh1.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=720, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=720, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5425824
	speed: 0.2652s/iter; left time: 1172.2758s
	iters: 200, epoch: 1 | loss: 0.4379252
	speed: 0.1446s/iter; left time: 624.9550s
Epoch: 1 cost time: 44.55756449699402
Epoch: 1, Steps: 226 | Train Loss: 0.5854945 Vali Loss: 1.3400414 Test Loss: 0.5987705
Validation loss decreased (inf --> 1.340041).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3723972
	speed: 0.1490s/iter; left time: 625.1651s
	iters: 200, epoch: 2 | loss: 0.3788929
	speed: 0.2530s/iter; left time: 1036.1718s
Epoch: 2 cost time: 49.48560452461243
Epoch: 2, Steps: 226 | Train Loss: 0.3933209 Vali Loss: 1.3220584 Test Loss: 1.1524472
Validation loss decreased (1.340041 --> 1.322058).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3533062
	speed: 0.3222s/iter; left time: 1278.8963s
	iters: 200, epoch: 3 | loss: 0.3345628
	speed: 0.3131s/iter; left time: 1211.4483s
Epoch: 3 cost time: 70.5017409324646
Epoch: 3, Steps: 226 | Train Loss: 0.3499122 Vali Loss: 1.2589499 Test Loss: 0.9872560
Validation loss decreased (1.322058 --> 1.258950).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3313354
	speed: 0.2401s/iter; left time: 898.7627s
	iters: 200, epoch: 4 | loss: 0.3617217
	speed: 0.1998s/iter; left time: 728.0501s
Epoch: 4 cost time: 51.033496618270874
Epoch: 4, Steps: 226 | Train Loss: 0.3348954 Vali Loss: 1.2912130 Test Loss: 1.0183234
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3170112
	speed: 0.1982s/iter; left time: 697.1378s
	iters: 200, epoch: 5 | loss: 0.3112680
	speed: 0.2715s/iter; left time: 927.7534s
Epoch: 5 cost time: 55.88130855560303
Epoch: 5, Steps: 226 | Train Loss: 0.3247137 Vali Loss: 1.3033313 Test Loss: 1.1099987
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.3423623
	speed: 0.1787s/iter; left time: 588.0974s
	iters: 200, epoch: 6 | loss: 0.3109035
	speed: 0.2975s/iter; left time: 949.4542s
Epoch: 6 cost time: 56.63023376464844
Epoch: 6, Steps: 226 | Train Loss: 0.3199371 Vali Loss: 1.3171016 Test Loss: 1.0539763
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.9870449304580688, mae:0.7294002771377563
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5283288
	speed: 0.3112s/iter; left time: 1375.9259s
	iters: 200, epoch: 1 | loss: 0.4424150
	speed: 0.3048s/iter; left time: 1317.0221s
Epoch: 1 cost time: 66.4068386554718
Epoch: 1, Steps: 226 | Train Loss: 0.5861194 Vali Loss: 1.2910658 Test Loss: 0.6886793
Validation loss decreased (inf --> 1.291066).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4019915
	speed: 0.2138s/iter; left time: 896.9594s
	iters: 200, epoch: 2 | loss: 0.3603339
	speed: 0.2287s/iter; left time: 936.4270s
Epoch: 2 cost time: 50.34359955787659
Epoch: 2, Steps: 226 | Train Loss: 0.3865365 Vali Loss: 1.3359512 Test Loss: 0.7157346
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3400197
	speed: 0.2510s/iter; left time: 996.2875s
	iters: 200, epoch: 3 | loss: 0.3258308
	speed: 0.1868s/iter; left time: 722.6166s
Epoch: 3 cost time: 49.920734167099
Epoch: 3, Steps: 226 | Train Loss: 0.3458366 Vali Loss: 1.3691345 Test Loss: 0.8138206
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3410302
	speed: 0.1988s/iter; left time: 744.1660s
	iters: 200, epoch: 4 | loss: 0.3442646
	speed: 0.2663s/iter; left time: 970.0111s
Epoch: 4 cost time: 55.97777843475342
Epoch: 4, Steps: 226 | Train Loss: 0.3322985 Vali Loss: 1.3990130 Test Loss: 0.7343686
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.6878732442855835, mae:0.6108676195144653
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5504224
	speed: 0.2943s/iter; left time: 1301.2627s
	iters: 200, epoch: 1 | loss: 0.4605854
	speed: 0.2932s/iter; left time: 1266.8011s
Epoch: 1 cost time: 67.95012497901917
Epoch: 1, Steps: 226 | Train Loss: 0.5888247 Vali Loss: 1.2617780 Test Loss: 0.6914176
Validation loss decreased (inf --> 1.261778).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3659592
	speed: 0.2450s/iter; left time: 1027.7704s
	iters: 200, epoch: 2 | loss: 0.3581932
	speed: 0.2173s/iter; left time: 889.8140s
Epoch: 2 cost time: 53.14388680458069
Epoch: 2, Steps: 226 | Train Loss: 0.3847904 Vali Loss: 1.2696126 Test Loss: 0.8385476
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3366623
	speed: 0.1867s/iter; left time: 741.1584s
	iters: 200, epoch: 3 | loss: 0.3429469
	speed: 0.2421s/iter; left time: 936.7302s
Epoch: 3 cost time: 47.48357963562012
Epoch: 3, Steps: 226 | Train Loss: 0.3451499 Vali Loss: 1.2377230 Test Loss: 0.8085164
Validation loss decreased (1.261778 --> 1.237723).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3411212
	speed: 0.1338s/iter; left time: 500.9881s
	iters: 200, epoch: 4 | loss: 0.3357793
	speed: 0.1767s/iter; left time: 643.6595s
Epoch: 4 cost time: 37.6632444858551
Epoch: 4, Steps: 226 | Train Loss: 0.3312815 Vali Loss: 1.2518108 Test Loss: 0.8173755
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3195343
	speed: 0.2987s/iter; left time: 1050.6420s
	iters: 200, epoch: 5 | loss: 0.3223979
	speed: 0.2822s/iter; left time: 964.1787s
Epoch: 5 cost time: 63.14439105987549
Epoch: 5, Steps: 226 | Train Loss: 0.3196226 Vali Loss: 1.2328091 Test Loss: 0.8368994
Validation loss decreased (1.237723 --> 1.232809).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3171356
	speed: 0.1769s/iter; left time: 582.3423s
	iters: 200, epoch: 6 | loss: 0.3003353
	speed: 0.1762s/iter; left time: 562.1599s
Epoch: 6 cost time: 39.93461894989014
Epoch: 6, Steps: 226 | Train Loss: 0.3142540 Vali Loss: 1.2333183 Test Loss: 0.8493225
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.3075794
	speed: 0.1745s/iter; left time: 534.8581s
	iters: 200, epoch: 7 | loss: 0.3099766
	speed: 0.1864s/iter; left time: 552.7755s
Epoch: 7 cost time: 41.35765099525452
Epoch: 7, Steps: 226 | Train Loss: 0.3093014 Vali Loss: 1.2387023 Test Loss: 0.8447204
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 8 | loss: 0.3002343
	speed: 0.1816s/iter; left time: 515.4300s
	iters: 200, epoch: 8 | loss: 0.3072487
	speed: 0.2035s/iter; left time: 557.5225s
Epoch: 8 cost time: 43.1841676235199
Epoch: 8, Steps: 226 | Train Loss: 0.3074318 Vali Loss: 1.2606098 Test Loss: 0.8432531
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.8352563977241516, mae:0.7057486772537231
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5621070
	speed: 0.1964s/iter; left time: 868.0981s
	iters: 200, epoch: 1 | loss: 0.4468082
	speed: 0.3047s/iter; left time: 1316.6391s
Epoch: 1 cost time: 57.14265823364258
Epoch: 1, Steps: 226 | Train Loss: 0.5806767 Vali Loss: 1.2734686 Test Loss: 0.6316931
Validation loss decreased (inf --> 1.273469).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3837538
	speed: 0.2409s/iter; left time: 1010.4225s
	iters: 200, epoch: 2 | loss: 0.3797071
	speed: 0.1983s/iter; left time: 811.9951s
Epoch: 2 cost time: 49.108455181121826
Epoch: 2, Steps: 226 | Train Loss: 0.3922695 Vali Loss: 1.3021454 Test Loss: 0.9432609
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3267254
	speed: 0.2149s/iter; left time: 853.1073s
	iters: 200, epoch: 3 | loss: 0.3298942
	speed: 0.1999s/iter; left time: 773.3598s
Epoch: 3 cost time: 46.05290079116821
Epoch: 3, Steps: 226 | Train Loss: 0.3464758 Vali Loss: 1.3248158 Test Loss: 0.9324262
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3358417
	speed: 0.1760s/iter; left time: 658.8561s
	iters: 200, epoch: 4 | loss: 0.3440993
	speed: 0.1943s/iter; left time: 707.9272s
Epoch: 4 cost time: 42.78946137428284
Epoch: 4, Steps: 226 | Train Loss: 0.3324755 Vali Loss: 1.3374263 Test Loss: 0.9473587
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.6310796737670898, mae:0.572976291179657
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7201
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.4862664
	speed: 0.1744s/iter; left time: 771.0650s
	iters: 200, epoch: 1 | loss: 0.4734097
	speed: 0.1780s/iter; left time: 769.0017s
Epoch: 1 cost time: 39.87272787094116
Epoch: 1, Steps: 226 | Train Loss: 0.5956419 Vali Loss: 1.3183370 Test Loss: 0.7423595
Validation loss decreased (inf --> 1.318337).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3853945
	speed: 0.3454s/iter; left time: 1449.0273s
	iters: 200, epoch: 2 | loss: 0.3520429
	speed: 0.3493s/iter; left time: 1430.5602s
Epoch: 2 cost time: 78.3466272354126
Epoch: 2, Steps: 226 | Train Loss: 0.3942640 Vali Loss: 1.3070630 Test Loss: 1.5651024
Validation loss decreased (1.318337 --> 1.307063).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3517948
	speed: 0.1905s/iter; left time: 756.2308s
	iters: 200, epoch: 3 | loss: 0.3505336
	speed: 0.1769s/iter; left time: 684.4649s
Epoch: 3 cost time: 41.48171877861023
Epoch: 3, Steps: 226 | Train Loss: 0.3474802 Vali Loss: 1.3351158 Test Loss: 1.5878902
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3564503
	speed: 0.1749s/iter; left time: 654.8230s
	iters: 200, epoch: 4 | loss: 0.3489255
	speed: 0.2205s/iter; left time: 803.3347s
Epoch: 4 cost time: 44.19348621368408
Epoch: 4, Steps: 226 | Train Loss: 0.3340039 Vali Loss: 1.3551213 Test Loss: 1.4872207
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3395072
	speed: 0.1752s/iter; left time: 616.0111s
	iters: 200, epoch: 5 | loss: 0.3190764
	speed: 0.1752s/iter; left time: 598.6747s
Epoch: 5 cost time: 39.68044590950012
Epoch: 5, Steps: 226 | Train Loss: 0.3238081 Vali Loss: 1.3857259 Test Loss: 1.5099463
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:1.5658146142959595, mae:0.9846715331077576
