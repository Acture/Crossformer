Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh2', data_dim=7, data_path='ETTh2.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=48, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=96, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8497
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3615873
	speed: 0.2807s/iter; left time: 1465.7188s
	iters: 200, epoch: 1 | loss: 0.2887236
	speed: 0.2272s/iter; left time: 1163.4857s
Epoch: 1 cost time: 66.29942798614502
Epoch: 1, Steps: 266 | Train Loss: 0.4895172 Vali Loss: 0.4743485 Test Loss: 1.0818386
Validation loss decreased (inf --> 0.474349).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5239879
	speed: 0.2468s/iter; left time: 1222.9069s
	iters: 200, epoch: 2 | loss: 0.4222034
	speed: 0.2631s/iter; left time: 1277.2430s
Epoch: 2 cost time: 68.85494494438171
Epoch: 2, Steps: 266 | Train Loss: 0.3663801 Vali Loss: 0.3213958 Test Loss: 0.7797261
Validation loss decreased (0.474349 --> 0.321396).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3538222
	speed: 0.2532s/iter; left time: 1187.1981s
	iters: 200, epoch: 3 | loss: 0.3330036
	speed: 0.2639s/iter; left time: 1210.9490s
Epoch: 3 cost time: 69.91019821166992
Epoch: 3, Steps: 266 | Train Loss: 0.3246055 Vali Loss: 0.3515531 Test Loss: 0.8311852
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3019712
	speed: 0.1781s/iter; left time: 787.6144s
	iters: 200, epoch: 4 | loss: 0.3293232
	speed: 0.1351s/iter; left time: 584.0131s
Epoch: 4 cost time: 39.82059288024902
Epoch: 4, Steps: 266 | Train Loss: 0.3072285 Vali Loss: 0.4150305 Test Loss: 1.0200219
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2249524
	speed: 0.1305s/iter; left time: 542.3770s
	iters: 200, epoch: 5 | loss: 0.2549941
	speed: 0.1609s/iter; left time: 652.5975s
Epoch: 5 cost time: 44.16351079940796
Epoch: 5, Steps: 266 | Train Loss: 0.2924124 Vali Loss: 0.4423492 Test Loss: 1.0976541
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.7863318920135498, mae:0.6731524467468262
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8497
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3999600
	speed: 0.2397s/iter; left time: 1251.4601s
	iters: 200, epoch: 1 | loss: 0.5468371
	speed: 0.2223s/iter; left time: 1138.5395s
Epoch: 1 cost time: 61.72847270965576
Epoch: 1, Steps: 266 | Train Loss: 0.4828268 Vali Loss: 0.3549215 Test Loss: 0.7485754
Validation loss decreased (inf --> 0.354921).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5485645
	speed: 0.2286s/iter; left time: 1132.6689s
	iters: 200, epoch: 2 | loss: 0.3796599
	speed: 0.2160s/iter; left time: 1048.7654s
Epoch: 2 cost time: 61.95973825454712
Epoch: 2, Steps: 266 | Train Loss: 0.3639209 Vali Loss: 0.3603240 Test Loss: 0.8926957
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4423494
	speed: 0.2533s/iter; left time: 1187.9388s
	iters: 200, epoch: 3 | loss: 0.2307795
	speed: 0.2491s/iter; left time: 1143.2705s
Epoch: 3 cost time: 61.42511582374573
Epoch: 3, Steps: 266 | Train Loss: 0.3245522 Vali Loss: 0.3775992 Test Loss: 0.9256521
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2696415
	speed: 0.1308s/iter; left time: 578.7209s
	iters: 200, epoch: 4 | loss: 0.2831428
	speed: 0.1547s/iter; left time: 668.7348s
Epoch: 4 cost time: 44.65999126434326
Epoch: 4, Steps: 266 | Train Loss: 0.3069986 Vali Loss: 0.3752297 Test Loss: 0.8788818
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.7547901272773743, mae:0.5962105393409729
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8497
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5725621
	speed: 0.2354s/iter; left time: 1229.1123s
	iters: 200, epoch: 1 | loss: 0.5962328
	speed: 0.2625s/iter; left time: 1344.2818s
Epoch: 1 cost time: 67.62741374969482
Epoch: 1, Steps: 266 | Train Loss: 0.4908817 Vali Loss: 0.3730057 Test Loss: 0.8131745
Validation loss decreased (inf --> 0.373006).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2857206
	speed: 0.1852s/iter; left time: 917.4589s
	iters: 200, epoch: 2 | loss: 0.4497094
	speed: 0.1332s/iter; left time: 646.4520s
Epoch: 2 cost time: 40.46515965461731
Epoch: 2, Steps: 266 | Train Loss: 0.3636256 Vali Loss: 0.4077937 Test Loss: 1.1210320
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2593698
	speed: 0.1409s/iter; left time: 660.8404s
	iters: 200, epoch: 3 | loss: 0.2907810
	speed: 0.1553s/iter; left time: 712.8820s
Epoch: 3 cost time: 48.9691321849823
Epoch: 3, Steps: 266 | Train Loss: 0.3266416 Vali Loss: 0.4582436 Test Loss: 1.6665011
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.5017042
	speed: 0.2563s/iter; left time: 1133.5580s
	iters: 200, epoch: 4 | loss: 0.2318359
	speed: 0.3008s/iter; left time: 1300.3853s
Epoch: 4 cost time: 75.18136286735535
Epoch: 4, Steps: 266 | Train Loss: 0.3089507 Vali Loss: 0.3954462 Test Loss: 1.4281603
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.8200325965881348, mae:0.6131200194358826
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8497
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3816108
	speed: 0.2675s/iter; left time: 1396.6158s
	iters: 200, epoch: 1 | loss: 0.4964167
	speed: 0.2468s/iter; left time: 1264.0278s
Epoch: 1 cost time: 67.50770425796509
Epoch: 1, Steps: 266 | Train Loss: 0.4836900 Vali Loss: 0.4378499 Test Loss: 0.9727542
Validation loss decreased (inf --> 0.437850).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2058463
	speed: 0.1902s/iter; left time: 942.2911s
	iters: 200, epoch: 2 | loss: 0.2990164
	speed: 0.2169s/iter; left time: 1052.8570s
Epoch: 2 cost time: 52.686129331588745
Epoch: 2, Steps: 266 | Train Loss: 0.3629154 Vali Loss: 0.3826310 Test Loss: 0.8945065
Validation loss decreased (0.437850 --> 0.382631).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2771791
	speed: 0.1405s/iter; left time: 658.9506s
	iters: 200, epoch: 3 | loss: 0.2827339
	speed: 0.1418s/iter; left time: 650.8359s
Epoch: 3 cost time: 37.28801989555359
Epoch: 3, Steps: 266 | Train Loss: 0.3250461 Vali Loss: 0.3721407 Test Loss: 0.8750371
Validation loss decreased (0.382631 --> 0.372141).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2714136
	speed: 0.1861s/iter; left time: 823.0373s
	iters: 200, epoch: 4 | loss: 0.4258963
	speed: 0.2481s/iter; left time: 1072.5417s
Epoch: 4 cost time: 60.4244544506073
Epoch: 4, Steps: 266 | Train Loss: 0.3086185 Vali Loss: 0.3711806 Test Loss: 0.9291920
Validation loss decreased (0.372141 --> 0.371181).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2510262
	speed: 0.2179s/iter; left time: 905.9247s
	iters: 200, epoch: 5 | loss: 0.2487465
	speed: 0.2374s/iter; left time: 962.9469s
Epoch: 5 cost time: 60.768290996551514
Epoch: 5, Steps: 266 | Train Loss: 0.2947520 Vali Loss: 0.4231999 Test Loss: 1.0131721
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.2087411
	speed: 0.2220s/iter; left time: 863.6984s
	iters: 200, epoch: 6 | loss: 0.3823904
	speed: 0.2310s/iter; left time: 875.7610s
Epoch: 6 cost time: 62.4087975025177
Epoch: 6, Steps: 266 | Train Loss: 0.2878184 Vali Loss: 0.4470099 Test Loss: 1.0591104
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.2097615
	speed: 0.2560s/iter; left time: 928.1286s
	iters: 200, epoch: 7 | loss: 0.2775335
	speed: 0.2201s/iter; left time: 775.7951s
Epoch: 7 cost time: 56.75600337982178
Epoch: 7, Steps: 266 | Train Loss: 0.2800217 Vali Loss: 0.4300612 Test Loss: 1.0471098
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.937140941619873, mae:0.7152617573738098
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8497
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.6260352
	speed: 0.2004s/iter; left time: 1046.1397s
	iters: 200, epoch: 1 | loss: 0.3869708
	speed: 0.2286s/iter; left time: 1170.8361s
Epoch: 1 cost time: 57.88620042800903
Epoch: 1, Steps: 266 | Train Loss: 0.4796918 Vali Loss: 0.4142272 Test Loss: 0.8802659
Validation loss decreased (inf --> 0.414227).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2596357
	speed: 0.2638s/iter; left time: 1307.2540s
	iters: 200, epoch: 2 | loss: 0.4989936
	speed: 0.2390s/iter; left time: 1160.2145s
Epoch: 2 cost time: 62.30353593826294
Epoch: 2, Steps: 266 | Train Loss: 0.3566598 Vali Loss: 0.4168660 Test Loss: 1.0578016
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4112530
	speed: 0.1323s/iter; left time: 620.3233s
	iters: 200, epoch: 3 | loss: 0.3469792
	speed: 0.1331s/iter; left time: 610.6649s
Epoch: 3 cost time: 36.42420148849487
Epoch: 3, Steps: 266 | Train Loss: 0.3201574 Vali Loss: 0.3943271 Test Loss: 1.0012812
Validation loss decreased (0.414227 --> 0.394327).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3619548
	speed: 0.1887s/iter; left time: 834.8412s
	iters: 200, epoch: 4 | loss: 0.3295687
	speed: 0.2381s/iter; left time: 1029.3922s
Epoch: 4 cost time: 60.87773656845093
Epoch: 4, Steps: 266 | Train Loss: 0.3040795 Vali Loss: 0.3726797 Test Loss: 0.9203871
Validation loss decreased (0.394327 --> 0.372680).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2273947
	speed: 0.2697s/iter; left time: 1121.0457s
	iters: 200, epoch: 5 | loss: 0.2306972
	speed: 0.2711s/iter; left time: 1099.6714s
Epoch: 5 cost time: 72.11120367050171
Epoch: 5, Steps: 266 | Train Loss: 0.2886988 Vali Loss: 0.4031199 Test Loss: 0.9157225
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.3654933
	speed: 0.2281s/iter; left time: 887.6849s
	iters: 200, epoch: 6 | loss: 0.2787221
	speed: 0.1410s/iter; left time: 534.6119s
Epoch: 6 cost time: 45.2784161567688
Epoch: 6, Steps: 266 | Train Loss: 0.2818359 Vali Loss: 0.3892240 Test Loss: 0.8577463
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.1987109
	speed: 0.1349s/iter; left time: 489.1435s
	iters: 200, epoch: 7 | loss: 0.2521189
	speed: 0.1599s/iter; left time: 563.6173s
Epoch: 7 cost time: 42.31739044189453
Epoch: 7, Steps: 266 | Train Loss: 0.2729392 Vali Loss: 0.3995633 Test Loss: 0.8679651
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.928903341293335, mae:0.700406551361084
