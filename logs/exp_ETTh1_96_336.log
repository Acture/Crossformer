Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh1', data_dim=7, data_path='ETTh1.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=336, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=96, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4028865
	speed: 0.2283s/iter; left time: 1150.7376s
	iters: 200, epoch: 1 | loss: 0.4273868
	speed: 0.1540s/iter; left time: 760.6880s
Epoch: 1 cost time: 49.21712875366211
Epoch: 1, Steps: 257 | Train Loss: 0.4463404 Vali Loss: 0.7590355 Test Loss: 0.3870678
Validation loss decreased (inf --> 0.759035).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4225200
	speed: 0.1433s/iter; left time: 685.4064s
	iters: 200, epoch: 2 | loss: 0.3187839
	speed: 0.1165s/iter; left time: 545.6731s
Epoch: 2 cost time: 33.393574237823486
Epoch: 2, Steps: 257 | Train Loss: 0.3376305 Vali Loss: 0.7401032 Test Loss: 0.4389432
Validation loss decreased (0.759035 --> 0.740103).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3386330
	speed: 0.1433s/iter; left time: 648.8750s
	iters: 200, epoch: 3 | loss: 0.3174648
	speed: 0.1171s/iter; left time: 518.2028s
Epoch: 3 cost time: 32.37972640991211
Epoch: 3, Steps: 257 | Train Loss: 0.3089562 Vali Loss: 0.7856182 Test Loss: 0.5379026
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2995847
	speed: 0.1101s/iter; left time: 470.1828s
	iters: 200, epoch: 4 | loss: 0.2816323
	speed: 0.1122s/iter; left time: 467.8776s
Epoch: 4 cost time: 28.52959394454956
Epoch: 4, Steps: 257 | Train Loss: 0.2944546 Vali Loss: 0.8320563 Test Loss: 0.5806611
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2451898
	speed: 0.1129s/iter; left time: 453.0844s
	iters: 200, epoch: 5 | loss: 0.2683442
	speed: 0.1086s/iter; left time: 425.0316s
Epoch: 5 cost time: 28.427368640899658
Epoch: 5, Steps: 257 | Train Loss: 0.2809648 Vali Loss: 0.7838300 Test Loss: 0.5600767
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.4379047751426697, mae:0.4473193287849426
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4232883
	speed: 0.1215s/iter; left time: 612.4114s
	iters: 200, epoch: 1 | loss: 0.4124697
	speed: 0.2185s/iter; left time: 1079.6687s
Epoch: 1 cost time: 46.05632162094116
Epoch: 1, Steps: 257 | Train Loss: 0.4462827 Vali Loss: 0.7433485 Test Loss: 0.4246899
Validation loss decreased (inf --> 0.743349).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2898228
	speed: 0.2391s/iter; left time: 1143.6687s
	iters: 200, epoch: 2 | loss: 0.3537712
	speed: 0.1672s/iter; left time: 782.9888s
Epoch: 2 cost time: 46.863731384277344
Epoch: 2, Steps: 257 | Train Loss: 0.3370542 Vali Loss: 0.7553151 Test Loss: 0.4578198
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3271281
	speed: 0.1111s/iter; left time: 502.7865s
	iters: 200, epoch: 3 | loss: 0.2804853
	speed: 0.1104s/iter; left time: 488.7354s
Epoch: 3 cost time: 29.400535583496094
Epoch: 3, Steps: 257 | Train Loss: 0.3029859 Vali Loss: 0.8160180 Test Loss: 0.5756372
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2774483
	speed: 0.0922s/iter; left time: 393.7415s
	iters: 200, epoch: 4 | loss: 0.3118418
	speed: 0.0876s/iter; left time: 365.4628s
Epoch: 4 cost time: 24.10004448890686
Epoch: 4, Steps: 257 | Train Loss: 0.2889068 Vali Loss: 0.7854793 Test Loss: 0.6589040
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.42326703667640686, mae:0.4453462064266205
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3918994
	speed: 0.1103s/iter; left time: 555.9517s
	iters: 200, epoch: 1 | loss: 0.3635770
	speed: 0.1479s/iter; left time: 730.6728s
Epoch: 1 cost time: 32.38070869445801
Epoch: 1, Steps: 257 | Train Loss: 0.4437613 Vali Loss: 0.7310416 Test Loss: 0.3902602
Validation loss decreased (inf --> 0.731042).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3268655
	speed: 0.1065s/iter; left time: 509.6829s
	iters: 200, epoch: 2 | loss: 0.3143585
	speed: 0.1266s/iter; left time: 593.1939s
Epoch: 2 cost time: 32.143646001815796
Epoch: 2, Steps: 257 | Train Loss: 0.3371939 Vali Loss: 0.7552701 Test Loss: 0.4787028
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3217587
	speed: 0.1370s/iter; left time: 620.1833s
	iters: 200, epoch: 3 | loss: 0.3535868
	speed: 0.1785s/iter; left time: 790.2692s
Epoch: 3 cost time: 37.77702212333679
Epoch: 3, Steps: 257 | Train Loss: 0.3051308 Vali Loss: 0.7859933 Test Loss: 0.6650007
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2500499
	speed: 0.1058s/iter; left time: 451.9626s
	iters: 200, epoch: 4 | loss: 0.2887176
	speed: 0.1152s/iter; left time: 480.2668s
Epoch: 4 cost time: 28.47685742378235
Epoch: 4, Steps: 257 | Train Loss: 0.2910170 Vali Loss: 0.7932666 Test Loss: 0.6364176
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3895165026187897, mae:0.42394188046455383
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3981804
	speed: 0.1365s/iter; left time: 687.9557s
	iters: 200, epoch: 1 | loss: 0.3357393
	speed: 0.1449s/iter; left time: 716.0206s
Epoch: 1 cost time: 34.4947566986084
Epoch: 1, Steps: 257 | Train Loss: 0.4491074 Vali Loss: 0.7295838 Test Loss: 0.3981158
Validation loss decreased (inf --> 0.729584).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3090603
	speed: 0.1107s/iter; left time: 529.7665s
	iters: 200, epoch: 2 | loss: 0.3079629
	speed: 0.1180s/iter; left time: 552.9410s
Epoch: 2 cost time: 29.218705892562866
Epoch: 2, Steps: 257 | Train Loss: 0.3365849 Vali Loss: 0.7320855 Test Loss: 0.4572802
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3350300
	speed: 0.1103s/iter; left time: 499.3979s
	iters: 200, epoch: 3 | loss: 0.2941069
	speed: 0.1205s/iter; left time: 533.4049s
Epoch: 3 cost time: 29.82760238647461
Epoch: 3, Steps: 257 | Train Loss: 0.3071385 Vali Loss: 0.7332359 Test Loss: 0.5622118
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3058102
	speed: 0.1442s/iter; left time: 615.7643s
	iters: 200, epoch: 4 | loss: 0.3305451
	speed: 0.2509s/iter; left time: 1046.2352s
Epoch: 4 cost time: 53.169687032699585
Epoch: 4, Steps: 257 | Train Loss: 0.2930709 Vali Loss: 0.7746952 Test Loss: 0.6187274
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.39709949493408203, mae:0.4251090884208679
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4124320
	speed: 0.1146s/iter; left time: 577.7907s
	iters: 200, epoch: 1 | loss: 0.3913982
	speed: 0.1095s/iter; left time: 540.8403s
Epoch: 1 cost time: 28.531925678253174
Epoch: 1, Steps: 257 | Train Loss: 0.4492410 Vali Loss: 0.7151310 Test Loss: 0.3910209
Validation loss decreased (inf --> 0.715131).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3991078
	speed: 0.1155s/iter; left time: 552.5691s
	iters: 200, epoch: 2 | loss: 0.2741539
	speed: 0.1066s/iter; left time: 499.4564s
Epoch: 2 cost time: 28.3504638671875
Epoch: 2, Steps: 257 | Train Loss: 0.3380570 Vali Loss: 0.7583416 Test Loss: 0.4572907
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2912649
	speed: 0.1155s/iter; left time: 522.9125s
	iters: 200, epoch: 3 | loss: 0.2994364
	speed: 0.1061s/iter; left time: 469.9076s
Epoch: 3 cost time: 28.605108976364136
Epoch: 3, Steps: 257 | Train Loss: 0.3051343 Vali Loss: 0.8003287 Test Loss: 0.5565781
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3253697
	speed: 0.1118s/iter; left time: 477.5351s
	iters: 200, epoch: 4 | loss: 0.2610738
	speed: 0.1095s/iter; left time: 456.6068s
Epoch: 4 cost time: 29.063721895217896
Epoch: 4, Steps: 257 | Train Loss: 0.2910242 Vali Loss: 0.8389503 Test Loss: 0.5632403
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il336_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.38999199867248535, mae:0.41899362206459045
