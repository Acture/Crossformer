Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh1', data_dim=7, data_path='ETTh1.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=720, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=96, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3613828
	speed: 0.2267s/iter; left time: 1088.3519s
	iters: 200, epoch: 1 | loss: 0.3278457
	speed: 0.1413s/iter; left time: 664.0654s
Epoch: 1 cost time: 42.52667713165283
Epoch: 1, Steps: 245 | Train Loss: 0.4439581 Vali Loss: 0.7916689 Test Loss: 0.3985567
Validation loss decreased (inf --> 0.791669).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3117014
	speed: 0.1253s/iter; left time: 570.6649s
	iters: 200, epoch: 2 | loss: 0.3295244
	speed: 0.1333s/iter; left time: 594.1386s
Epoch: 2 cost time: 31.548924922943115
Epoch: 2, Steps: 245 | Train Loss: 0.3280933 Vali Loss: 0.7790410 Test Loss: 0.4152297
Validation loss decreased (0.791669 --> 0.779041).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2724013
	speed: 0.1251s/iter; left time: 539.3943s
	iters: 200, epoch: 3 | loss: 0.2704298
	speed: 0.1345s/iter; left time: 566.4102s
Epoch: 3 cost time: 32.087483644485474
Epoch: 3, Steps: 245 | Train Loss: 0.2961805 Vali Loss: 0.7971872 Test Loss: 0.5922617
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3027380
	speed: 0.1536s/iter; left time: 624.3769s
	iters: 200, epoch: 4 | loss: 0.2921108
	speed: 0.1468s/iter; left time: 582.0865s
Epoch: 4 cost time: 35.7450590133667
Epoch: 4, Steps: 245 | Train Loss: 0.2800629 Vali Loss: 0.8250449 Test Loss: 0.6039294
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2567348
	speed: 0.1259s/iter; left time: 481.0718s
	iters: 200, epoch: 5 | loss: 0.2611795
	speed: 0.1461s/iter; left time: 543.6606s
Epoch: 5 cost time: 33.35985732078552
Epoch: 5, Steps: 245 | Train Loss: 0.2657282 Vali Loss: 0.8185184 Test Loss: 0.6682482
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.41389918327331543, mae:0.4351995587348938
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3661009
	speed: 0.1906s/iter; left time: 914.9405s
	iters: 200, epoch: 1 | loss: 0.3780736
	speed: 0.1253s/iter; left time: 588.9080s
Epoch: 1 cost time: 37.51517105102539
Epoch: 1, Steps: 245 | Train Loss: 0.4531758 Vali Loss: 0.7804950 Test Loss: 0.3839793
Validation loss decreased (inf --> 0.780495).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3610381
	speed: 0.1775s/iter; left time: 808.5750s
	iters: 200, epoch: 2 | loss: 0.3084922
	speed: 0.1327s/iter; left time: 591.3273s
Epoch: 2 cost time: 37.19038701057434
Epoch: 2, Steps: 245 | Train Loss: 0.3280005 Vali Loss: 0.7804042 Test Loss: 0.4157410
Validation loss decreased (0.780495 --> 0.780404).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2982356
	speed: 0.1332s/iter; left time: 574.3081s
	iters: 200, epoch: 3 | loss: 0.3142577
	speed: 0.0984s/iter; left time: 414.4952s
Epoch: 3 cost time: 27.954816341400146
Epoch: 3, Steps: 245 | Train Loss: 0.2919346 Vali Loss: 0.8056958 Test Loss: 0.4701591
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2660159
	speed: 0.1276s/iter; left time: 518.9919s
	iters: 200, epoch: 4 | loss: 0.2421197
	speed: 0.1267s/iter; left time: 502.4232s
Epoch: 4 cost time: 32.90550923347473
Epoch: 4, Steps: 245 | Train Loss: 0.2736423 Vali Loss: 0.8501147 Test Loss: 0.4848762
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2730908
	speed: 0.1259s/iter; left time: 481.1505s
	iters: 200, epoch: 5 | loss: 0.2700619
	speed: 0.1646s/iter; left time: 612.4412s
Epoch: 5 cost time: 39.87845420837402
Epoch: 5, Steps: 245 | Train Loss: 0.2612525 Vali Loss: 0.8862243 Test Loss: 0.5333514
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.4147389531135559, mae:0.4349384009838104
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4555974
	speed: 0.2884s/iter; left time: 1384.6291s
	iters: 200, epoch: 1 | loss: 0.3072288
	speed: 0.1884s/iter; left time: 885.7884s
Epoch: 1 cost time: 53.37453746795654
Epoch: 1, Steps: 245 | Train Loss: 0.4451542 Vali Loss: 0.7895010 Test Loss: 0.4121772
Validation loss decreased (inf --> 0.789501).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3168354
	speed: 0.1384s/iter; left time: 630.4315s
	iters: 200, epoch: 2 | loss: 0.3249790
	speed: 0.1296s/iter; left time: 577.5233s
Epoch: 2 cost time: 32.70217680931091
Epoch: 2, Steps: 245 | Train Loss: 0.3279858 Vali Loss: 0.8313021 Test Loss: 0.4268810
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2952081
	speed: 0.1298s/iter; left time: 559.4288s
	iters: 200, epoch: 3 | loss: 0.3634551
	speed: 0.1282s/iter; left time: 539.8156s
Epoch: 3 cost time: 31.579123973846436
Epoch: 3, Steps: 245 | Train Loss: 0.2928322 Vali Loss: 0.8674957 Test Loss: 0.5158675
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2445184
	speed: 0.1383s/iter; left time: 562.4592s
	iters: 200, epoch: 4 | loss: 0.3005184
	speed: 0.1305s/iter; left time: 517.5124s
Epoch: 4 cost time: 33.281471967697144
Epoch: 4, Steps: 245 | Train Loss: 0.2775951 Vali Loss: 0.9107557 Test Loss: 0.6232217
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.4119359850883484, mae:0.4459848403930664
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4200870
	speed: 0.2022s/iter; left time: 970.6025s
	iters: 200, epoch: 1 | loss: 0.3576432
	speed: 0.1715s/iter; left time: 806.3738s
Epoch: 1 cost time: 45.02209830284119
Epoch: 1, Steps: 245 | Train Loss: 0.4486175 Vali Loss: 0.7736984 Test Loss: 0.3829189
Validation loss decreased (inf --> 0.773698).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3427715
	speed: 0.2428s/iter; left time: 1106.1953s
	iters: 200, epoch: 2 | loss: 0.3585468
	speed: 0.1466s/iter; left time: 653.2243s
Epoch: 2 cost time: 44.68108344078064
Epoch: 2, Steps: 245 | Train Loss: 0.3290433 Vali Loss: 0.8159109 Test Loss: 0.4439332
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2929717
	speed: 0.1333s/iter; left time: 574.5608s
	iters: 200, epoch: 3 | loss: 0.2938521
	speed: 0.2177s/iter; left time: 916.5794s
Epoch: 3 cost time: 41.40609645843506
Epoch: 3, Steps: 245 | Train Loss: 0.2966955 Vali Loss: 0.8066377 Test Loss: 0.5347372
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2790834
	speed: 0.1289s/iter; left time: 524.0682s
	iters: 200, epoch: 4 | loss: 0.2771479
	speed: 0.1361s/iter; left time: 539.6818s
Epoch: 4 cost time: 31.70752763748169
Epoch: 4, Steps: 245 | Train Loss: 0.2816116 Vali Loss: 0.8012444 Test Loss: 0.6141840
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.38210421800613403, mae:0.42012181878089905
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4289099
	speed: 0.0976s/iter; left time: 468.3383s
	iters: 200, epoch: 1 | loss: 0.3141499
	speed: 0.1628s/iter; left time: 765.0979s
Epoch: 1 cost time: 32.47071647644043
Epoch: 1, Steps: 245 | Train Loss: 0.4527216 Vali Loss: 0.7491666 Test Loss: 0.3739933
Validation loss decreased (inf --> 0.749167).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3023775
	speed: 0.1932s/iter; left time: 880.2041s
	iters: 200, epoch: 2 | loss: 0.2965964
	speed: 0.2471s/iter; left time: 1101.1586s
Epoch: 2 cost time: 58.203349590301514
Epoch: 2, Steps: 245 | Train Loss: 0.3306912 Vali Loss: 0.7927093 Test Loss: 0.4589355
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3243774
	speed: 0.1776s/iter; left time: 765.8149s
	iters: 200, epoch: 3 | loss: 0.2728054
	speed: 0.1369s/iter; left time: 576.4399s
Epoch: 3 cost time: 38.050453901290894
Epoch: 3, Steps: 245 | Train Loss: 0.2943522 Vali Loss: 0.8315871 Test Loss: 0.5538213
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2431653
	speed: 0.1399s/iter; left time: 568.6864s
	iters: 200, epoch: 4 | loss: 0.2780255
	speed: 0.1329s/iter; left time: 526.9190s
Epoch: 4 cost time: 33.189934730529785
Epoch: 4, Steps: 245 | Train Loss: 0.2775916 Vali Loss: 0.8751037 Test Loss: 0.7571771
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3731715679168701, mae:0.41590210795402527
