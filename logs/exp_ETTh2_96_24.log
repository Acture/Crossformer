Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh2', data_dim=7, data_path='ETTh2.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=24, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=96, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8521
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5895156
	speed: 0.3135s/iter; left time: 1643.1272s
	iters: 200, epoch: 1 | loss: 0.5842736
	speed: 0.1985s/iter; left time: 1020.4908s
Epoch: 1 cost time: 61.763099908828735
Epoch: 1, Steps: 267 | Train Loss: 0.4995621 Vali Loss: 0.3880531 Test Loss: 0.8982059
Validation loss decreased (inf --> 0.388053).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5699705
	speed: 0.1500s/iter; left time: 745.9247s
	iters: 200, epoch: 2 | loss: 0.2952442
	speed: 0.1556s/iter; left time: 758.5235s
Epoch: 2 cost time: 38.960829734802246
Epoch: 2, Steps: 267 | Train Loss: 0.3661747 Vali Loss: 0.4134562 Test Loss: 1.5291979
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2972252
	speed: 0.1651s/iter; left time: 777.2560s
	iters: 200, epoch: 3 | loss: 0.2654638
	speed: 0.1025s/iter; left time: 472.0810s
Epoch: 3 cost time: 32.121378898620605
Epoch: 3, Steps: 267 | Train Loss: 0.3278626 Vali Loss: 0.3824659 Test Loss: 1.0630657
Validation loss decreased (0.388053 --> 0.382466).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4042372
	speed: 0.0782s/iter; left time: 347.1823s
	iters: 200, epoch: 4 | loss: 0.2534231
	speed: 0.0887s/iter; left time: 385.0288s
Epoch: 4 cost time: 23.644437551498413
Epoch: 4, Steps: 267 | Train Loss: 0.3096071 Vali Loss: 0.3892109 Test Loss: 0.7958676
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3007228
	speed: 0.1247s/iter; left time: 520.2144s
	iters: 200, epoch: 5 | loss: 0.2874403
	speed: 0.1761s/iter; left time: 717.1216s
Epoch: 5 cost time: 44.94652199745178
Epoch: 5, Steps: 267 | Train Loss: 0.2966700 Vali Loss: 0.3861099 Test Loss: 0.9799618
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.2423878
	speed: 0.2010s/iter; left time: 784.9537s
	iters: 200, epoch: 6 | loss: 0.3501410
	speed: 0.2039s/iter; left time: 776.0509s
Epoch: 6 cost time: 51.903823137283325
Epoch: 6, Steps: 267 | Train Loss: 0.2901389 Vali Loss: 0.3889624 Test Loss: 0.9909728
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:1.071689486503601, mae:0.813556432723999
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8521
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4698579
	speed: 0.2308s/iter; left time: 1209.8079s
	iters: 200, epoch: 1 | loss: 0.4457710
	speed: 0.2490s/iter; left time: 1280.0724s
Epoch: 1 cost time: 64.38191056251526
Epoch: 1, Steps: 267 | Train Loss: 0.5036724 Vali Loss: 0.4086041 Test Loss: 0.9068944
Validation loss decreased (inf --> 0.408604).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3203622
	speed: 0.1501s/iter; left time: 746.7960s
	iters: 200, epoch: 2 | loss: 0.3180733
	speed: 0.1015s/iter; left time: 494.7024s
Epoch: 2 cost time: 32.20943474769592
Epoch: 2, Steps: 267 | Train Loss: 0.3804099 Vali Loss: 0.3305739 Test Loss: 0.6627424
Validation loss decreased (0.408604 --> 0.330574).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2138398
	speed: 0.1030s/iter; left time: 484.9431s
	iters: 200, epoch: 3 | loss: 0.3583604
	speed: 0.1009s/iter; left time: 464.9692s
Epoch: 3 cost time: 27.127278089523315
Epoch: 3, Steps: 267 | Train Loss: 0.3387685 Vali Loss: 0.3757452 Test Loss: 0.9418672
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3593917
	speed: 0.1705s/iter; left time: 757.2192s
	iters: 200, epoch: 4 | loss: 0.2964666
	speed: 0.2075s/iter; left time: 900.4517s
Epoch: 4 cost time: 52.60533905029297
Epoch: 4, Steps: 267 | Train Loss: 0.3217781 Vali Loss: 0.3413738 Test Loss: 0.8195000
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2334115
	speed: 0.2662s/iter; left time: 1111.0016s
	iters: 200, epoch: 5 | loss: 0.2703296
	speed: 0.2782s/iter; left time: 1132.9307s
Epoch: 5 cost time: 72.32883954048157
Epoch: 5, Steps: 267 | Train Loss: 0.3019931 Vali Loss: 0.3590130 Test Loss: 0.9926410
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.6681041121482849, mae:0.6055903434753418
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8521
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4531351
	speed: 0.2460s/iter; left time: 1289.4128s
	iters: 200, epoch: 1 | loss: 0.3901894
	speed: 0.1961s/iter; left time: 1008.1472s
Epoch: 1 cost time: 52.69596338272095
Epoch: 1, Steps: 267 | Train Loss: 0.4980533 Vali Loss: 0.3982766 Test Loss: 0.8720412
Validation loss decreased (inf --> 0.398277).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2897218
	speed: 0.1050s/iter; left time: 522.3585s
	iters: 200, epoch: 2 | loss: 0.2104067
	speed: 0.1034s/iter; left time: 503.8400s
Epoch: 2 cost time: 27.90836811065674
Epoch: 2, Steps: 267 | Train Loss: 0.3690729 Vali Loss: 0.4196475 Test Loss: 0.8742917
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4495978
	speed: 0.1214s/iter; left time: 571.2996s
	iters: 200, epoch: 3 | loss: 0.3810384
	speed: 0.2342s/iter; left time: 1078.8369s
Epoch: 3 cost time: 51.94793915748596
Epoch: 3, Steps: 267 | Train Loss: 0.3286245 Vali Loss: 0.4322229 Test Loss: 0.9423907
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.4801498
	speed: 0.2374s/iter; left time: 1054.2582s
	iters: 200, epoch: 4 | loss: 0.2691887
	speed: 0.2259s/iter; left time: 980.3318s
Epoch: 4 cost time: 57.41961932182312
Epoch: 4, Steps: 267 | Train Loss: 0.3125972 Vali Loss: 0.4263913 Test Loss: 0.9269427
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.8788475394248962, mae:0.6444917917251587
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8521
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4400506
	speed: 0.1060s/iter; left time: 555.6520s
	iters: 200, epoch: 1 | loss: 0.3126166
	speed: 0.1594s/iter; left time: 819.3762s
Epoch: 1 cost time: 40.241700887680054
Epoch: 1, Steps: 267 | Train Loss: 0.4921472 Vali Loss: 0.4305457 Test Loss: 0.9448067
Validation loss decreased (inf --> 0.430546).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5096375
	speed: 0.2442s/iter; left time: 1214.7557s
	iters: 200, epoch: 2 | loss: 0.3350102
	speed: 0.2460s/iter; left time: 1199.0032s
Epoch: 2 cost time: 64.2246253490448
Epoch: 2, Steps: 267 | Train Loss: 0.3676141 Vali Loss: 0.3337511 Test Loss: 0.7977683
Validation loss decreased (0.430546 --> 0.333751).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4000741
	speed: 0.2431s/iter; left time: 1144.3825s
	iters: 200, epoch: 3 | loss: 0.2950562
	speed: 0.1936s/iter; left time: 892.1342s
Epoch: 3 cost time: 55.39935111999512
Epoch: 3, Steps: 267 | Train Loss: 0.3311097 Vali Loss: 0.3856577 Test Loss: 1.0340489
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3135131
	speed: 0.1139s/iter; left time: 505.6111s
	iters: 200, epoch: 4 | loss: 0.2582669
	speed: 0.1251s/iter; left time: 543.0337s
Epoch: 4 cost time: 32.619019746780396
Epoch: 4, Steps: 267 | Train Loss: 0.3155717 Vali Loss: 0.4379250 Test Loss: 1.2989447
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2566124
	speed: 0.1293s/iter; left time: 539.7045s
	iters: 200, epoch: 5 | loss: 0.1838227
	speed: 0.1678s/iter; left time: 683.4295s
Epoch: 5 cost time: 43.459532260894775
Epoch: 5, Steps: 267 | Train Loss: 0.3004110 Vali Loss: 0.3973130 Test Loss: 0.8644465
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.8049541115760803, mae:0.7258591651916504
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8521
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.2957663
	speed: 0.1574s/iter; left time: 825.0359s
	iters: 200, epoch: 1 | loss: 0.3647975
	speed: 0.2182s/iter; left time: 1121.6870s
Epoch: 1 cost time: 52.268858671188354
Epoch: 1, Steps: 267 | Train Loss: 0.4921193 Vali Loss: 0.3821367 Test Loss: 0.8024451
Validation loss decreased (inf --> 0.382137).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5618957
	speed: 0.2287s/iter; left time: 1137.5975s
	iters: 200, epoch: 2 | loss: 0.2685148
	speed: 0.2020s/iter; left time: 984.3541s
Epoch: 2 cost time: 60.9474093914032
Epoch: 2, Steps: 267 | Train Loss: 0.3683884 Vali Loss: 0.3635704 Test Loss: 0.8743980
Validation loss decreased (0.382137 --> 0.363570).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2455278
	speed: 0.2456s/iter; left time: 1156.1759s
	iters: 200, epoch: 3 | loss: 0.2775491
	speed: 0.2516s/iter; left time: 1158.9855s
Epoch: 3 cost time: 64.24277925491333
Epoch: 3, Steps: 267 | Train Loss: 0.3301554 Vali Loss: 0.3208839 Test Loss: 0.8464689
Validation loss decreased (0.363570 --> 0.320884).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1991938
	speed: 0.1482s/iter; left time: 657.8325s
	iters: 200, epoch: 4 | loss: 0.4136335
	speed: 0.1341s/iter; left time: 582.1005s
Epoch: 4 cost time: 40.51848793029785
Epoch: 4, Steps: 267 | Train Loss: 0.3154392 Vali Loss: 0.3527606 Test Loss: 0.8839392
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.4096901
	speed: 0.2436s/iter; left time: 1016.5638s
	iters: 200, epoch: 5 | loss: 0.2362579
	speed: 0.2477s/iter; left time: 1008.9664s
Epoch: 5 cost time: 65.67801928520203
Epoch: 5, Steps: 267 | Train Loss: 0.3004796 Vali Loss: 0.3672523 Test Loss: 0.7524933
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.3572615
	speed: 0.2679s/iter; left time: 1046.6038s
	iters: 200, epoch: 6 | loss: 0.3207064
	speed: 0.1419s/iter; left time: 540.1760s
Epoch: 6 cost time: 50.75256872177124
Epoch: 6, Steps: 267 | Train Loss: 0.2941759 Vali Loss: 0.3530783 Test Loss: 0.8462744
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.8545728325843811, mae:0.6790499687194824
