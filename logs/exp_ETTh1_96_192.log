Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh1', data_dim=7, data_path='ETTh1.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=192, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=96, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5294640
	speed: 0.1958s/iter; left time: 1006.7676s
	iters: 200, epoch: 1 | loss: 0.3709601
	speed: 0.1826s/iter; left time: 920.4103s
Epoch: 1 cost time: 46.76974153518677
Epoch: 1, Steps: 262 | Train Loss: 0.4499670 Vali Loss: 0.6942135 Test Loss: 0.3916209
Validation loss decreased (inf --> 0.694214).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3533658
	speed: 0.0994s/iter; left time: 484.8935s
	iters: 200, epoch: 2 | loss: 0.3202211
	speed: 0.1136s/iter; left time: 542.8973s
Epoch: 2 cost time: 27.96891951560974
Epoch: 2, Steps: 262 | Train Loss: 0.3517729 Vali Loss: 0.7333049 Test Loss: 0.4040464
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3165111
	speed: 0.1087s/iter; left time: 501.7916s
	iters: 200, epoch: 3 | loss: 0.3150430
	speed: 0.1473s/iter; left time: 665.1661s
Epoch: 3 cost time: 42.97679591178894
Epoch: 3, Steps: 262 | Train Loss: 0.3227590 Vali Loss: 0.7195058 Test Loss: 0.3994080
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3131680
	speed: 0.2653s/iter; left time: 1155.4622s
	iters: 200, epoch: 4 | loss: 0.2833508
	speed: 0.2352s/iter; left time: 1000.7079s
Epoch: 4 cost time: 57.866655111312866
Epoch: 4, Steps: 262 | Train Loss: 0.3084679 Vali Loss: 0.7823330 Test Loss: 0.4119393
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.391616553068161, mae:0.4117862582206726
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4389729
	speed: 0.1087s/iter; left time: 558.8511s
	iters: 200, epoch: 1 | loss: 0.3479411
	speed: 0.1131s/iter; left time: 570.2742s
Epoch: 1 cost time: 34.01755094528198
Epoch: 1, Steps: 262 | Train Loss: 0.4506585 Vali Loss: 0.7038839 Test Loss: 0.3991269
Validation loss decreased (inf --> 0.703884).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3338423
	speed: 0.1514s/iter; left time: 738.8312s
	iters: 200, epoch: 2 | loss: 0.3082296
	speed: 0.1108s/iter; left time: 529.6828s
Epoch: 2 cost time: 33.250534534454346
Epoch: 2, Steps: 262 | Train Loss: 0.3505564 Vali Loss: 0.7301130 Test Loss: 0.4045871
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3234049
	speed: 0.1342s/iter; left time: 619.5978s
	iters: 200, epoch: 3 | loss: 0.3043405
	speed: 0.1141s/iter; left time: 515.6003s
Epoch: 3 cost time: 31.69933795928955
Epoch: 3, Steps: 262 | Train Loss: 0.3236168 Vali Loss: 0.7956270 Test Loss: 0.4592692
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2858551
	speed: 0.1471s/iter; left time: 640.6497s
	iters: 200, epoch: 4 | loss: 0.3437859
	speed: 0.2707s/iter; left time: 1151.8443s
Epoch: 4 cost time: 59.49546837806702
Epoch: 4, Steps: 262 | Train Loss: 0.3110763 Vali Loss: 0.8007413 Test Loss: 0.4567942
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.39891546964645386, mae:0.4238860607147217
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3804618
	speed: 0.1958s/iter; left time: 1006.6503s
	iters: 200, epoch: 1 | loss: 0.4121460
	speed: 0.1152s/iter; left time: 580.4957s
Epoch: 1 cost time: 37.895336389541626
Epoch: 1, Steps: 262 | Train Loss: 0.4526324 Vali Loss: 0.7120007 Test Loss: 0.4061824
Validation loss decreased (inf --> 0.712001).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3198322
	speed: 0.1891s/iter; left time: 922.4033s
	iters: 200, epoch: 2 | loss: 0.3003218
	speed: 0.1213s/iter; left time: 579.7272s
Epoch: 2 cost time: 37.41361737251282
Epoch: 2, Steps: 262 | Train Loss: 0.3525724 Vali Loss: 0.7064899 Test Loss: 0.4144830
Validation loss decreased (0.712001 --> 0.706490).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3077077
	speed: 0.0909s/iter; left time: 419.8692s
	iters: 200, epoch: 3 | loss: 0.3084280
	speed: 0.0871s/iter; left time: 393.2187s
Epoch: 3 cost time: 24.063313007354736
Epoch: 3, Steps: 262 | Train Loss: 0.3230962 Vali Loss: 0.7348107 Test Loss: 0.4400419
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3426600
	speed: 0.1082s/iter; left time: 471.0852s
	iters: 200, epoch: 4 | loss: 0.3430147
	speed: 0.1107s/iter; left time: 470.8339s
Epoch: 4 cost time: 28.742026567459106
Epoch: 4, Steps: 262 | Train Loss: 0.3104629 Vali Loss: 0.7569000 Test Loss: 0.4483450
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2911466
	speed: 0.1069s/iter; left time: 437.4570s
	iters: 200, epoch: 5 | loss: 0.3399492
	speed: 0.1397s/iter; left time: 557.6338s
Epoch: 5 cost time: 31.919190645217896
Epoch: 5, Steps: 262 | Train Loss: 0.2983290 Vali Loss: 0.7716681 Test Loss: 0.4692287
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.4136691093444824, mae:0.43631914258003235
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4126068
	speed: 0.2111s/iter; left time: 1085.0545s
	iters: 200, epoch: 1 | loss: 0.3758386
	speed: 0.1182s/iter; left time: 596.0431s
Epoch: 1 cost time: 40.223336935043335
Epoch: 1, Steps: 262 | Train Loss: 0.4508497 Vali Loss: 0.7312762 Test Loss: 0.3893924
Validation loss decreased (inf --> 0.731276).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3259403
	speed: 0.1048s/iter; left time: 511.2186s
	iters: 200, epoch: 2 | loss: 0.3764926
	speed: 0.1140s/iter; left time: 544.6646s
Epoch: 2 cost time: 28.63205575942993
Epoch: 2, Steps: 262 | Train Loss: 0.3489799 Vali Loss: 0.7429710 Test Loss: 0.4104608
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3177983
	speed: 0.1055s/iter; left time: 486.9086s
	iters: 200, epoch: 3 | loss: 0.3293780
	speed: 0.1087s/iter; left time: 490.8840s
Epoch: 3 cost time: 28.68065309524536
Epoch: 3, Steps: 262 | Train Loss: 0.3211651 Vali Loss: 0.7401472 Test Loss: 0.4436620
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3243384
	speed: 0.1093s/iter; left time: 476.1391s
	iters: 200, epoch: 4 | loss: 0.2898606
	speed: 0.1066s/iter; left time: 453.4606s
Epoch: 4 cost time: 28.31890606880188
Epoch: 4, Steps: 262 | Train Loss: 0.3073091 Vali Loss: 0.7565244 Test Loss: 0.5013664
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.38941675424575806, mae:0.4095725119113922
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4191045
	speed: 0.1114s/iter; left time: 572.8294s
	iters: 200, epoch: 1 | loss: 0.3184298
	speed: 0.1584s/iter; left time: 798.4554s
Epoch: 1 cost time: 43.34722447395325
Epoch: 1, Steps: 262 | Train Loss: 0.4484401 Vali Loss: 0.7851895 Test Loss: 0.5157003
Validation loss decreased (inf --> 0.785190).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3627997
	speed: 0.2693s/iter; left time: 1314.1117s
	iters: 200, epoch: 2 | loss: 0.3020734
	speed: 0.1926s/iter; left time: 920.3872s
Epoch: 2 cost time: 54.359459400177
Epoch: 2, Steps: 262 | Train Loss: 0.3503080 Vali Loss: 0.7395779 Test Loss: 0.4000503
Validation loss decreased (0.785190 --> 0.739578).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3459836
	speed: 0.1084s/iter; left time: 500.5178s
	iters: 200, epoch: 3 | loss: 0.3189907
	speed: 0.1082s/iter; left time: 488.8327s
Epoch: 3 cost time: 29.514330863952637
Epoch: 3, Steps: 262 | Train Loss: 0.3204580 Vali Loss: 0.7473838 Test Loss: 0.4239078
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3159801
	speed: 0.1088s/iter; left time: 473.8312s
	iters: 200, epoch: 4 | loss: 0.2958350
	speed: 0.1126s/iter; left time: 479.2966s
Epoch: 4 cost time: 28.90727996826172
Epoch: 4, Steps: 262 | Train Loss: 0.3050083 Vali Loss: 0.7699125 Test Loss: 0.4490854
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3162836
	speed: 0.2118s/iter; left time: 866.6963s
	iters: 200, epoch: 5 | loss: 0.2830380
	speed: 0.1235s/iter; left time: 493.0949s
Epoch: 5 cost time: 41.00764226913452
Epoch: 5, Steps: 262 | Train Loss: 0.2921711 Vali Loss: 0.7751500 Test Loss: 0.4819456
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il192_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3995825946331024, mae:0.4197162687778473
