Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh2', data_dim=7, data_path='ETTh2.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=48, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=720, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il48_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7873
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.8188477
	speed: 0.2697s/iter; left time: 1305.5826s
	iters: 200, epoch: 1 | loss: 0.7072110
	speed: 0.1585s/iter; left time: 751.4759s
Epoch: 1 cost time: 50.75890374183655
Epoch: 1, Steps: 247 | Train Loss: 0.7614987 Vali Loss: 1.4102982 Test Loss: 2.8346013
Validation loss decreased (inf --> 1.410298).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6170477
	speed: 0.3014s/iter; left time: 1384.7868s
	iters: 200, epoch: 2 | loss: 0.3552591
	speed: 0.3050s/iter; left time: 1370.5177s
Epoch: 2 cost time: 75.7818193435669
Epoch: 2, Steps: 247 | Train Loss: 0.5409286 Vali Loss: 2.3271191 Test Loss: 3.9844316
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4793981
	speed: 0.2297s/iter; left time: 998.5639s
	iters: 200, epoch: 3 | loss: 0.3171696
	speed: 0.1504s/iter; left time: 638.9151s
Epoch: 3 cost time: 43.62929058074951
Epoch: 3, Steps: 247 | Train Loss: 0.4750986 Vali Loss: 2.6710566 Test Loss: 4.4761028
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.4289276
	speed: 0.1240s/iter; left time: 508.2092s
	iters: 200, epoch: 4 | loss: 0.4420407
	speed: 0.1706s/iter; left time: 682.2976s
Epoch: 4 cost time: 37.26089859008789
Epoch: 4, Steps: 247 | Train Loss: 0.4517260 Vali Loss: 3.2738626 Test Loss: 5.0858901
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il48_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:2.832300901412964, mae:1.465503454208374
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il48_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7873
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.8968858
	speed: 0.1555s/iter; left time: 752.7266s
	iters: 200, epoch: 1 | loss: 0.6414552
	speed: 0.1565s/iter; left time: 742.0159s
Epoch: 1 cost time: 38.570051431655884
Epoch: 1, Steps: 247 | Train Loss: 0.7729781 Vali Loss: 1.7487805 Test Loss: 3.1189634
Validation loss decreased (inf --> 1.748780).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6654008
	speed: 0.2442s/iter; left time: 1121.8517s
	iters: 200, epoch: 2 | loss: 0.5495836
	speed: 0.3004s/iter; left time: 1350.1174s
Epoch: 2 cost time: 69.01257181167603
Epoch: 2, Steps: 247 | Train Loss: 0.5352708 Vali Loss: 2.8263337 Test Loss: 4.8962055
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4083803
	speed: 0.2835s/iter; left time: 1232.2753s
	iters: 200, epoch: 3 | loss: 0.3555932
	speed: 0.1682s/iter; left time: 714.3615s
Epoch: 3 cost time: 52.552650928497314
Epoch: 3, Steps: 247 | Train Loss: 0.4709786 Vali Loss: 2.4553248 Test Loss: 4.1913386
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.5013573
	speed: 0.1827s/iter; left time: 749.1828s
	iters: 200, epoch: 4 | loss: 0.5295976
	speed: 0.1614s/iter; left time: 645.5098s
Epoch: 4 cost time: 41.732006311416626
Epoch: 4, Steps: 247 | Train Loss: 0.4425163 Vali Loss: 2.7059687 Test Loss: 4.1501759
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il48_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:3.1161351203918457, mae:1.5403743982315063
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il48_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7873
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.7982513
	speed: 0.1546s/iter; left time: 748.2192s
	iters: 200, epoch: 1 | loss: 0.6960789
	speed: 0.1556s/iter; left time: 737.5240s
Epoch: 1 cost time: 39.14408493041992
Epoch: 1, Steps: 247 | Train Loss: 0.7729480 Vali Loss: 1.1777016 Test Loss: 1.7930231
Validation loss decreased (inf --> 1.177702).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5740253
	speed: 0.2741s/iter; left time: 1259.0472s
	iters: 200, epoch: 2 | loss: 0.5243261
	speed: 0.2962s/iter; left time: 1330.9491s
Epoch: 2 cost time: 71.21191239356995
Epoch: 2, Steps: 247 | Train Loss: 0.5351561 Vali Loss: 2.2342502 Test Loss: 3.2263236
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4559726
	speed: 0.1780s/iter; left time: 773.6776s
	iters: 200, epoch: 3 | loss: 0.4188506
	speed: 0.1659s/iter; left time: 704.6584s
Epoch: 3 cost time: 42.89400386810303
Epoch: 3, Steps: 247 | Train Loss: 0.4648110 Vali Loss: 2.6456231 Test Loss: 4.8578315
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.4077506
	speed: 0.1789s/iter; left time: 733.4350s
	iters: 200, epoch: 4 | loss: 0.4348044
	speed: 0.1572s/iter; left time: 628.8598s
Epoch: 4 cost time: 40.95172166824341
Epoch: 4, Steps: 247 | Train Loss: 0.4447114 Vali Loss: 2.8635899 Test Loss: 5.0931415
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il48_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:1.7915335893630981, mae:1.1035103797912598
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il48_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7873
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6330426
	speed: 0.2083s/iter; left time: 1008.5544s
	iters: 200, epoch: 1 | loss: 0.7338093
	speed: 0.2650s/iter; left time: 1256.1599s
Epoch: 1 cost time: 55.650808572769165
Epoch: 1, Steps: 247 | Train Loss: 0.7654319 Vali Loss: 1.3187132 Test Loss: 2.1561150
Validation loss decreased (inf --> 1.318713).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4996596
	speed: 0.1561s/iter; left time: 716.9109s
	iters: 200, epoch: 2 | loss: 0.4818663
	speed: 0.1588s/iter; left time: 713.5130s
Epoch: 2 cost time: 40.23512506484985
Epoch: 2, Steps: 247 | Train Loss: 0.5403896 Vali Loss: 2.0400510 Test Loss: 3.2880072
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3836170
	speed: 0.1737s/iter; left time: 754.9293s
	iters: 200, epoch: 3 | loss: 0.5144981
	speed: 0.1799s/iter; left time: 764.0797s
Epoch: 3 cost time: 47.03946232795715
Epoch: 3, Steps: 247 | Train Loss: 0.4734454 Vali Loss: 2.3387817 Test Loss: 3.6274503
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.5141430
	speed: 0.1963s/iter; left time: 804.9380s
	iters: 200, epoch: 4 | loss: 0.4875470
	speed: 0.1611s/iter; left time: 644.3766s
Epoch: 4 cost time: 43.25535774230957
Epoch: 4, Steps: 247 | Train Loss: 0.4516900 Vali Loss: 2.2979670 Test Loss: 3.9257069
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il48_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:2.154236078262329, mae:1.266647219657898
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il48_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7873
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.7164103
	speed: 0.1829s/iter; left time: 885.6323s
	iters: 200, epoch: 1 | loss: 0.5281648
	speed: 0.1689s/iter; left time: 800.6770s
Epoch: 1 cost time: 42.540279388427734
Epoch: 1, Steps: 247 | Train Loss: 0.7618727 Vali Loss: 1.9508596 Test Loss: 3.1314124
Validation loss decreased (inf --> 1.950860).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5392337
	speed: 0.1585s/iter; left time: 728.2588s
	iters: 200, epoch: 2 | loss: 0.4060162
	speed: 0.1777s/iter; left time: 798.7048s
Epoch: 2 cost time: 46.95205283164978
Epoch: 2, Steps: 247 | Train Loss: 0.5363710 Vali Loss: 3.1470770 Test Loss: 3.8681914
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4517165
	speed: 0.2782s/iter; left time: 1209.3223s
	iters: 200, epoch: 3 | loss: 0.4265037
	speed: 0.2597s/iter; left time: 1103.0521s
Epoch: 3 cost time: 61.50526428222656
Epoch: 3, Steps: 247 | Train Loss: 0.4854722 Vali Loss: 2.9124795 Test Loss: 4.4829233
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.4688590
	speed: 0.1551s/iter; left time: 636.0456s
	iters: 200, epoch: 4 | loss: 0.4263377
	speed: 0.1553s/iter; left time: 621.2407s
Epoch: 4 cost time: 38.424304723739624
Epoch: 4, Steps: 247 | Train Loss: 0.4573489 Vali Loss: 2.4964652 Test Loss: 5.2594902
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il48_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:3.1283957958221436, mae:1.5493639707565308
