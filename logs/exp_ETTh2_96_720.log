Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh2', data_dim=7, data_path='ETTh2.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=720, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=96, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5221227
	speed: 0.2577s/iter; left time: 1237.4450s
	iters: 200, epoch: 1 | loss: 0.2876582
	speed: 0.1164s/iter; left time: 547.0449s
Epoch: 1 cost time: 41.983962535858154
Epoch: 1, Steps: 245 | Train Loss: 0.4972741 Vali Loss: 0.4512496 Test Loss: 0.6464184
Validation loss decreased (inf --> 0.451250).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2305035
	speed: 0.1162s/iter; left time: 529.1881s
	iters: 200, epoch: 2 | loss: 0.2582609
	speed: 0.2196s/iter; left time: 978.3847s
Epoch: 2 cost time: 43.67826724052429
Epoch: 2, Steps: 245 | Train Loss: 0.3228508 Vali Loss: 0.4345418 Test Loss: 0.9523248
Validation loss decreased (0.451250 --> 0.434542).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2770694
	speed: 0.1244s/iter; left time: 536.1020s
	iters: 200, epoch: 3 | loss: 0.3524783
	speed: 0.1233s/iter; left time: 519.3570s
Epoch: 3 cost time: 32.73959684371948
Epoch: 3, Steps: 245 | Train Loss: 0.2764095 Vali Loss: 0.6236719 Test Loss: 0.9602824
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3030025
	speed: 0.1845s/iter; left time: 750.2112s
	iters: 200, epoch: 4 | loss: 0.1994162
	speed: 0.1971s/iter; left time: 781.5822s
Epoch: 4 cost time: 51.707364082336426
Epoch: 4, Steps: 245 | Train Loss: 0.2561141 Vali Loss: 0.6016726 Test Loss: 0.6865466
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2126636
	speed: 0.2911s/iter; left time: 1112.1041s
	iters: 200, epoch: 5 | loss: 0.3167192
	speed: 0.2144s/iter; left time: 797.6727s
Epoch: 5 cost time: 56.08711266517639
Epoch: 5, Steps: 245 | Train Loss: 0.2309927 Vali Loss: 0.6524724 Test Loss: 0.7243277
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.959657609462738, mae:0.6862484216690063
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3221170
	speed: 0.1250s/iter; left time: 600.1092s
	iters: 200, epoch: 1 | loss: 0.3063120
	speed: 0.1278s/iter; left time: 600.8197s
Epoch: 1 cost time: 31.577291250228882
Epoch: 1, Steps: 245 | Train Loss: 0.4965701 Vali Loss: 0.3613858 Test Loss: 0.7587239
Validation loss decreased (inf --> 0.361386).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2263275
	speed: 0.1254s/iter; left time: 571.2783s
	iters: 200, epoch: 2 | loss: 0.4172880
	speed: 0.2065s/iter; left time: 920.2080s
Epoch: 2 cost time: 44.07395672798157
Epoch: 2, Steps: 245 | Train Loss: 0.3281905 Vali Loss: 0.5166588 Test Loss: 0.9947467
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2368026
	speed: 0.2630s/iter; left time: 1133.7485s
	iters: 200, epoch: 3 | loss: 0.3004754
	speed: 0.2960s/iter; left time: 1246.2851s
Epoch: 3 cost time: 68.04577994346619
Epoch: 3, Steps: 245 | Train Loss: 0.2751509 Vali Loss: 0.6858261 Test Loss: 0.8410225
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.1515009
	speed: 0.1952s/iter; left time: 793.6344s
	iters: 200, epoch: 4 | loss: 0.2240471
	speed: 0.1377s/iter; left time: 545.9855s
Epoch: 4 cost time: 42.05934476852417
Epoch: 4, Steps: 245 | Train Loss: 0.2523813 Vali Loss: 0.8076747 Test Loss: 0.8814175
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.7648779153823853, mae:0.6041668057441711
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3570499
	speed: 0.2067s/iter; left time: 992.2320s
	iters: 200, epoch: 1 | loss: 0.5224316
	speed: 0.1507s/iter; left time: 708.2100s
Epoch: 1 cost time: 42.768858432769775
Epoch: 1, Steps: 245 | Train Loss: 0.4952339 Vali Loss: 0.4177365 Test Loss: 0.9978597
Validation loss decreased (inf --> 0.417737).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4367874
	speed: 0.2236s/iter; left time: 1018.5046s
	iters: 200, epoch: 2 | loss: 0.4403205
	speed: 0.1854s/iter; left time: 826.0631s
Epoch: 2 cost time: 46.96622276306152
Epoch: 2, Steps: 245 | Train Loss: 0.3285405 Vali Loss: 0.5673908 Test Loss: 0.8525916
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2082224
	speed: 0.1748s/iter; left time: 753.4490s
	iters: 200, epoch: 3 | loss: 0.3173944
	speed: 0.2021s/iter; left time: 851.1281s
Epoch: 3 cost time: 45.90410232543945
Epoch: 3, Steps: 245 | Train Loss: 0.2752887 Vali Loss: 0.6344268 Test Loss: 0.8961878
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2575351
	speed: 0.1757s/iter; left time: 714.3149s
	iters: 200, epoch: 4 | loss: 0.2341323
	speed: 0.2154s/iter; left time: 854.0868s
Epoch: 4 cost time: 51.77583074569702
Epoch: 4, Steps: 245 | Train Loss: 0.2499763 Vali Loss: 0.7164888 Test Loss: 1.1212136
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:1.0048198699951172, mae:0.6822924613952637
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3393131
	speed: 0.2649s/iter; left time: 1272.0232s
	iters: 200, epoch: 1 | loss: 0.4219619
	speed: 0.2762s/iter; left time: 1298.4021s
Epoch: 1 cost time: 63.51251697540283
Epoch: 1, Steps: 245 | Train Loss: 0.4852374 Vali Loss: 0.3576909 Test Loss: 0.7907200
Validation loss decreased (inf --> 0.357691).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3280527
	speed: 0.1280s/iter; left time: 583.3532s
	iters: 200, epoch: 2 | loss: 0.2169871
	speed: 0.1261s/iter; left time: 562.0105s
Epoch: 2 cost time: 31.12828755378723
Epoch: 2, Steps: 245 | Train Loss: 0.3321592 Vali Loss: 0.4221418 Test Loss: 0.8712611
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2623561
	speed: 0.1260s/iter; left time: 543.2445s
	iters: 200, epoch: 3 | loss: 0.2820057
	speed: 0.1320s/iter; left time: 556.0474s
Epoch: 3 cost time: 31.771913290023804
Epoch: 3, Steps: 245 | Train Loss: 0.2827874 Vali Loss: 0.5304533 Test Loss: 0.9399536
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.1760333
	speed: 0.2918s/iter; left time: 1186.3319s
	iters: 200, epoch: 4 | loss: 0.3270316
	speed: 0.2913s/iter; left time: 1155.3929s
Epoch: 4 cost time: 71.20566153526306
Epoch: 4, Steps: 245 | Train Loss: 0.2567406 Vali Loss: 0.5246111 Test Loss: 0.7799762
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.7967776656150818, mae:0.6087988018989563
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3313075
	speed: 0.1713s/iter; left time: 822.5769s
	iters: 200, epoch: 1 | loss: 0.3462017
	speed: 0.2046s/iter; left time: 961.7593s
Epoch: 1 cost time: 43.872846364974976
Epoch: 1, Steps: 245 | Train Loss: 0.4850765 Vali Loss: 0.4420591 Test Loss: 1.1253597
Validation loss decreased (inf --> 0.442059).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3591892
	speed: 0.1283s/iter; left time: 584.6809s
	iters: 200, epoch: 2 | loss: 0.3533160
	speed: 0.2165s/iter; left time: 964.6306s
Epoch: 2 cost time: 43.767582178115845
Epoch: 2, Steps: 245 | Train Loss: 0.3228471 Vali Loss: 0.8143263 Test Loss: 0.7998933
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2522064
	speed: 0.2318s/iter; left time: 999.1686s
	iters: 200, epoch: 3 | loss: 0.1811455
	speed: 0.2082s/iter; left time: 876.8800s
Epoch: 3 cost time: 50.813512563705444
Epoch: 3, Steps: 245 | Train Loss: 0.2705242 Vali Loss: 0.8675914 Test Loss: 1.0697723
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3804331
	speed: 0.1288s/iter; left time: 523.8751s
	iters: 200, epoch: 4 | loss: 0.1896372
	speed: 0.1314s/iter; left time: 521.0182s
Epoch: 4 cost time: 32.01775240898132
Epoch: 4, Steps: 245 | Train Loss: 0.2454171 Vali Loss: 0.8704772 Test Loss: 0.9122316
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il720_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:1.1333556175231934, mae:0.7482139468193054
