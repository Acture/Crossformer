Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh1', data_dim=7, data_path='ETTh1.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=24, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=96, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8521
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5271004
	speed: 0.1837s/iter; left time: 962.5701s
	iters: 200, epoch: 1 | loss: 0.4511736
	speed: 0.0968s/iter; left time: 497.5871s
Epoch: 1 cost time: 34.43661308288574
Epoch: 1, Steps: 267 | Train Loss: 0.5164756 Vali Loss: 0.7710309 Test Loss: 0.4909344
Validation loss decreased (inf --> 0.771031).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4179913
	speed: 0.1406s/iter; left time: 699.3141s
	iters: 200, epoch: 2 | loss: 0.3705160
	speed: 0.1092s/iter; left time: 532.2448s
Epoch: 2 cost time: 33.32896947860718
Epoch: 2, Steps: 267 | Train Loss: 0.4080802 Vali Loss: 0.7849422 Test Loss: 0.5260908
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3461224
	speed: 0.1711s/iter; left time: 805.5805s
	iters: 200, epoch: 3 | loss: 0.3512697
	speed: 0.1306s/iter; left time: 601.8216s
Epoch: 3 cost time: 36.69457745552063
Epoch: 3, Steps: 267 | Train Loss: 0.3806600 Vali Loss: 0.7678219 Test Loss: 0.5305949
Validation loss decreased (0.771031 --> 0.767822).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3466903
	speed: 0.0968s/iter; left time: 429.9867s
	iters: 200, epoch: 4 | loss: 0.3063166
	speed: 0.1079s/iter; left time: 468.2046s
Epoch: 4 cost time: 27.034255027770996
Epoch: 4, Steps: 267 | Train Loss: 0.3701912 Vali Loss: 0.7539239 Test Loss: 0.5777417
Validation loss decreased (0.767822 --> 0.753924).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3502505
	speed: 0.0957s/iter; left time: 399.3908s
	iters: 200, epoch: 5 | loss: 0.3695113
	speed: 0.0977s/iter; left time: 398.1199s
Epoch: 5 cost time: 25.907896041870117
Epoch: 5, Steps: 267 | Train Loss: 0.3585762 Vali Loss: 0.7948355 Test Loss: 0.6354454
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.3650700
	speed: 0.0954s/iter; left time: 372.5677s
	iters: 200, epoch: 6 | loss: 0.3219953
	speed: 0.0979s/iter; left time: 372.7721s
Epoch: 6 cost time: 25.846288204193115
Epoch: 6, Steps: 267 | Train Loss: 0.3537749 Vali Loss: 0.7973972 Test Loss: 0.6058624
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.4090804
	speed: 0.0961s/iter; left time: 349.7386s
	iters: 200, epoch: 7 | loss: 0.3251910
	speed: 0.1472s/iter; left time: 520.7723s
Epoch: 7 cost time: 39.72547173500061
Epoch: 7, Steps: 267 | Train Loss: 0.3480652 Vali Loss: 0.7962119 Test Loss: 0.6566194
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.5786598920822144, mae:0.5702028870582581
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8521
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4618116
	speed: 0.1753s/iter; left time: 918.9449s
	iters: 200, epoch: 1 | loss: 0.3907813
	speed: 0.1463s/iter; left time: 752.2959s
Epoch: 1 cost time: 39.27143216133118
Epoch: 1, Steps: 267 | Train Loss: 0.5112445 Vali Loss: 0.7294439 Test Loss: 0.4704968
Validation loss decreased (inf --> 0.729444).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3951027
	speed: 0.0957s/iter; left time: 476.1905s
	iters: 200, epoch: 2 | loss: 0.3861659
	speed: 0.0965s/iter; left time: 470.1084s
Epoch: 2 cost time: 26.002707719802856
Epoch: 2, Steps: 267 | Train Loss: 0.4084819 Vali Loss: 0.8378585 Test Loss: 0.5569131
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4229851
	speed: 0.0956s/iter; left time: 450.2211s
	iters: 200, epoch: 3 | loss: 0.3612040
	speed: 0.1024s/iter; left time: 471.9786s
Epoch: 3 cost time: 27.204575777053833
Epoch: 3, Steps: 267 | Train Loss: 0.3847744 Vali Loss: 0.7696829 Test Loss: 0.5431885
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.4732661
	speed: 0.1033s/iter; left time: 458.6777s
	iters: 200, epoch: 4 | loss: 0.3750983
	speed: 0.0971s/iter; left time: 421.2230s
Epoch: 4 cost time: 26.535841703414917
Epoch: 4, Steps: 267 | Train Loss: 0.3744875 Vali Loss: 0.7766566 Test Loss: 0.5574190
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.47054192423820496, mae:0.4799933433532715
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8521
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5067397
	speed: 0.0965s/iter; left time: 505.7103s
	iters: 200, epoch: 1 | loss: 0.3823808
	speed: 0.1380s/iter; left time: 709.2018s
Epoch: 1 cost time: 33.68326115608215
Epoch: 1, Steps: 267 | Train Loss: 0.5134482 Vali Loss: 0.7281107 Test Loss: 0.4692821
Validation loss decreased (inf --> 0.728111).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4524375
	speed: 0.2215s/iter; left time: 1101.9349s
	iters: 200, epoch: 2 | loss: 0.3948926
	speed: 0.1744s/iter; left time: 850.0247s
Epoch: 2 cost time: 45.90607261657715
Epoch: 2, Steps: 267 | Train Loss: 0.4064757 Vali Loss: 0.7398875 Test Loss: 0.4823135
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4316109
	speed: 0.0910s/iter; left time: 428.1952s
	iters: 200, epoch: 3 | loss: 0.3778436
	speed: 0.0787s/iter; left time: 362.7357s
Epoch: 3 cost time: 22.339832305908203
Epoch: 3, Steps: 267 | Train Loss: 0.3799440 Vali Loss: 0.7281798 Test Loss: 0.5169412
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3824665
	speed: 0.0938s/iter; left time: 416.5274s
	iters: 200, epoch: 4 | loss: 0.3313804
	speed: 0.0991s/iter; left time: 430.0252s
Epoch: 4 cost time: 25.788553953170776
Epoch: 4, Steps: 267 | Train Loss: 0.3698897 Vali Loss: 0.7671787 Test Loss: 0.5292602
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.46933886408805847, mae:0.4770076870918274
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8521
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5252918
	speed: 0.1237s/iter; left time: 648.1656s
	iters: 200, epoch: 1 | loss: 0.4658245
	speed: 0.1249s/iter; left time: 642.1762s
Epoch: 1 cost time: 31.39033031463623
Epoch: 1, Steps: 267 | Train Loss: 0.5191642 Vali Loss: 0.7225064 Test Loss: 0.4529541
Validation loss decreased (inf --> 0.722506).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3656406
	speed: 0.1787s/iter; left time: 888.6522s
	iters: 200, epoch: 2 | loss: 0.3709342
	speed: 0.1694s/iter; left time: 825.6476s
Epoch: 2 cost time: 51.32511782646179
Epoch: 2, Steps: 267 | Train Loss: 0.4079567 Vali Loss: 0.7290188 Test Loss: 0.4941415
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4134346
	speed: 0.2532s/iter; left time: 1191.7574s
	iters: 200, epoch: 3 | loss: 0.3488370
	speed: 0.1369s/iter; left time: 630.7831s
Epoch: 3 cost time: 45.65556597709656
Epoch: 3, Steps: 267 | Train Loss: 0.3821525 Vali Loss: 0.7951664 Test Loss: 0.5775703
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3880577
	speed: 0.0979s/iter; left time: 434.8614s
	iters: 200, epoch: 4 | loss: 0.3751968
	speed: 0.1097s/iter; left time: 476.0432s
Epoch: 4 cost time: 30.469932079315186
Epoch: 4, Steps: 267 | Train Loss: 0.3728811 Vali Loss: 0.7952796 Test Loss: 0.5985934
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.4529726803302765, mae:0.4649047553539276
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8521
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4031212
	speed: 0.1080s/iter; left time: 566.1544s
	iters: 200, epoch: 1 | loss: 0.4333460
	speed: 0.0981s/iter; left time: 504.5372s
Epoch: 1 cost time: 27.01972484588623
Epoch: 1, Steps: 267 | Train Loss: 0.5093639 Vali Loss: 0.7448459 Test Loss: 0.4637618
Validation loss decreased (inf --> 0.744846).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4365006
	speed: 0.1615s/iter; left time: 803.4991s
	iters: 200, epoch: 2 | loss: 0.3776197
	speed: 0.1040s/iter; left time: 507.0704s
Epoch: 2 cost time: 32.98390507698059
Epoch: 2, Steps: 267 | Train Loss: 0.4049270 Vali Loss: 0.7805100 Test Loss: 0.4772727
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3885330
	speed: 0.1662s/iter; left time: 782.2938s
	iters: 200, epoch: 3 | loss: 0.3656898
	speed: 0.2113s/iter; left time: 973.3458s
Epoch: 3 cost time: 53.59890055656433
Epoch: 3, Steps: 267 | Train Loss: 0.3818843 Vali Loss: 0.7830842 Test Loss: 0.5260479
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2983584
	speed: 0.1844s/iter; left time: 818.6663s
	iters: 200, epoch: 4 | loss: 0.3223162
	speed: 0.1125s/iter; left time: 488.0726s
Epoch: 4 cost time: 36.29451012611389
Epoch: 4, Steps: 267 | Train Loss: 0.3717085 Vali Loss: 0.7588165 Test Loss: 0.5972826
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il24_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.4637707471847534, mae:0.47141462564468384
