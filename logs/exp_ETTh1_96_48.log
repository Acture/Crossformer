Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh1', data_dim=7, data_path='ETTh1.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=48, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=96, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8497
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5286938
	speed: 0.1925s/iter; left time: 1004.7973s
	iters: 200, epoch: 1 | loss: 0.4136054
	speed: 0.1188s/iter; left time: 608.5775s
Epoch: 1 cost time: 40.011717081069946
Epoch: 1, Steps: 266 | Train Loss: 0.4830438 Vali Loss: 0.7096213 Test Loss: 0.4216955
Validation loss decreased (inf --> 0.709621).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3427173
	speed: 0.1386s/iter; left time: 686.5229s
	iters: 200, epoch: 2 | loss: 0.3332171
	speed: 0.1385s/iter; left time: 672.2073s
Epoch: 2 cost time: 37.47117233276367
Epoch: 2, Steps: 266 | Train Loss: 0.3785405 Vali Loss: 0.6979755 Test Loss: 0.4045132
Validation loss decreased (0.709621 --> 0.697975).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4352457
	speed: 0.2061s/iter; left time: 966.5884s
	iters: 200, epoch: 3 | loss: 0.3725716
	speed: 0.1870s/iter; left time: 858.0396s
Epoch: 3 cost time: 56.45200705528259
Epoch: 3, Steps: 266 | Train Loss: 0.3540178 Vali Loss: 0.7200223 Test Loss: 0.4782961
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3226711
	speed: 0.2580s/iter; left time: 1141.2495s
	iters: 200, epoch: 4 | loss: 0.4004391
	speed: 0.1074s/iter; left time: 464.2751s
Epoch: 4 cost time: 43.44503831863403
Epoch: 4, Steps: 266 | Train Loss: 0.3419920 Vali Loss: 0.7925853 Test Loss: 0.5640317
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3862936
	speed: 0.1256s/iter; left time: 522.2708s
	iters: 200, epoch: 5 | loss: 0.2803209
	speed: 0.1699s/iter; left time: 689.3983s
Epoch: 5 cost time: 41.00038123130798
Epoch: 5, Steps: 266 | Train Loss: 0.3308438 Vali Loss: 0.7808752 Test Loss: 0.5919046
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.40461719036102295, mae:0.426835834980011
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8497
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5664234
	speed: 0.1057s/iter; left time: 552.0149s
	iters: 200, epoch: 1 | loss: 0.4171509
	speed: 0.1413s/iter; left time: 723.4104s
Epoch: 1 cost time: 31.6741623878479
Epoch: 1, Steps: 266 | Train Loss: 0.4820266 Vali Loss: 0.7255223 Test Loss: 0.4249074
Validation loss decreased (inf --> 0.725522).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3016641
	speed: 0.1515s/iter; left time: 750.8268s
	iters: 200, epoch: 2 | loss: 0.3652946
	speed: 0.2279s/iter; left time: 1106.4002s
Epoch: 2 cost time: 54.774659633636475
Epoch: 2, Steps: 266 | Train Loss: 0.3800351 Vali Loss: 0.6808114 Test Loss: 0.3981588
Validation loss decreased (0.725522 --> 0.680811).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3377420
	speed: 0.1937s/iter; left time: 908.3261s
	iters: 200, epoch: 3 | loss: 0.3582694
	speed: 0.2019s/iter; left time: 926.5731s
Epoch: 3 cost time: 46.70469546318054
Epoch: 3, Steps: 266 | Train Loss: 0.3564943 Vali Loss: 0.7562929 Test Loss: 0.4385426
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2947667
	speed: 0.1085s/iter; left time: 479.9227s
	iters: 200, epoch: 4 | loss: 0.3628615
	speed: 0.1046s/iter; left time: 452.3509s
Epoch: 4 cost time: 28.863855838775635
Epoch: 4, Steps: 266 | Train Loss: 0.3476972 Vali Loss: 0.7601229 Test Loss: 0.4633560
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3717990
	speed: 0.1987s/iter; left time: 825.8668s
	iters: 200, epoch: 5 | loss: 0.3375303
	speed: 0.1035s/iter; left time: 420.0267s
Epoch: 5 cost time: 37.200491428375244
Epoch: 5, Steps: 266 | Train Loss: 0.3371250 Vali Loss: 0.7623842 Test Loss: 0.4642622
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3980121612548828, mae:0.42635107040405273
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8497
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4854667
	speed: 0.1318s/iter; left time: 688.0556s
	iters: 200, epoch: 1 | loss: 0.3440818
	speed: 0.2173s/iter; left time: 1112.6447s
Epoch: 1 cost time: 48.62242007255554
Epoch: 1, Steps: 266 | Train Loss: 0.4827713 Vali Loss: 0.6956741 Test Loss: 0.4243927
Validation loss decreased (inf --> 0.695674).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3773709
	speed: 0.1740s/iter; left time: 861.9861s
	iters: 200, epoch: 2 | loss: 0.3225277
	speed: 0.2098s/iter; left time: 1018.4390s
Epoch: 2 cost time: 52.524311780929565
Epoch: 2, Steps: 266 | Train Loss: 0.3791307 Vali Loss: 0.6987201 Test Loss: 0.4203613
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3857226
	speed: 0.1432s/iter; left time: 671.4230s
	iters: 200, epoch: 3 | loss: 0.3230153
	speed: 0.1053s/iter; left time: 483.0239s
Epoch: 3 cost time: 33.34793424606323
Epoch: 3, Steps: 266 | Train Loss: 0.3566771 Vali Loss: 0.6965482 Test Loss: 0.4475912
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3675073
	speed: 0.1077s/iter; left time: 476.2892s
	iters: 200, epoch: 4 | loss: 0.3472059
	speed: 0.1579s/iter; left time: 682.7413s
Epoch: 4 cost time: 35.35041642189026
Epoch: 4, Steps: 266 | Train Loss: 0.3465978 Vali Loss: 0.7361806 Test Loss: 0.4937521
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.4247630834579468, mae:0.4471249580383301
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8497
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5333695
	speed: 0.1230s/iter; left time: 642.3932s
	iters: 200, epoch: 1 | loss: 0.3534276
	speed: 0.1064s/iter; left time: 544.8930s
Epoch: 1 cost time: 31.175106287002563
Epoch: 1, Steps: 266 | Train Loss: 0.4837870 Vali Loss: 0.6978633 Test Loss: 0.3982749
Validation loss decreased (inf --> 0.697863).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4046090
	speed: 0.2505s/iter; left time: 1241.3869s
	iters: 200, epoch: 2 | loss: 0.3843194
	speed: 0.2502s/iter; left time: 1214.9308s
Epoch: 2 cost time: 59.277071475982666
Epoch: 2, Steps: 266 | Train Loss: 0.3801227 Vali Loss: 0.7601913 Test Loss: 0.4698721
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3606156
	speed: 0.1072s/iter; left time: 502.8293s
	iters: 200, epoch: 3 | loss: 0.3288061
	speed: 0.0987s/iter; left time: 452.7497s
Epoch: 3 cost time: 27.888134479522705
Epoch: 3, Steps: 266 | Train Loss: 0.3566292 Vali Loss: 0.6970235 Test Loss: 0.4240678
Validation loss decreased (0.697863 --> 0.697024).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3286363
	speed: 0.1040s/iter; left time: 459.8736s
	iters: 200, epoch: 4 | loss: 0.3014774
	speed: 0.1068s/iter; left time: 461.6871s
Epoch: 4 cost time: 30.251970052719116
Epoch: 4, Steps: 266 | Train Loss: 0.3479361 Vali Loss: 0.7054869 Test Loss: 0.4634402
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3225464
	speed: 0.1038s/iter; left time: 431.6159s
	iters: 200, epoch: 5 | loss: 0.3365148
	speed: 0.1369s/iter; left time: 555.3236s
Epoch: 5 cost time: 33.18048810958862
Epoch: 5, Steps: 266 | Train Loss: 0.3375376 Vali Loss: 0.7197852 Test Loss: 0.4556126
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.3529283
	speed: 0.1012s/iter; left time: 393.9214s
	iters: 200, epoch: 6 | loss: 0.3425377
	speed: 0.1045s/iter; left time: 396.3141s
Epoch: 6 cost time: 28.32468843460083
Epoch: 6, Steps: 266 | Train Loss: 0.3323166 Vali Loss: 0.7463672 Test Loss: 0.4754982
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.4241317808628082, mae:0.447142630815506
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh1_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8497
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4508072
	speed: 0.2614s/iter; left time: 1364.7899s
	iters: 200, epoch: 1 | loss: 0.3811232
	speed: 0.2247s/iter; left time: 1150.9405s
Epoch: 1 cost time: 65.40432357788086
Epoch: 1, Steps: 266 | Train Loss: 0.4849107 Vali Loss: 0.6925800 Test Loss: 0.4233711
Validation loss decreased (inf --> 0.692580).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3981631
	speed: 0.1029s/iter; left time: 509.7798s
	iters: 200, epoch: 2 | loss: 0.3159680
	speed: 0.1182s/iter; left time: 573.7991s
Epoch: 2 cost time: 28.968770027160645
Epoch: 2, Steps: 266 | Train Loss: 0.3813182 Vali Loss: 0.6966415 Test Loss: 0.4492236
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3521412
	speed: 0.1024s/iter; left time: 480.2055s
	iters: 200, epoch: 3 | loss: 0.3822450
	speed: 0.1148s/iter; left time: 526.7683s
Epoch: 3 cost time: 29.844431400299072
Epoch: 3, Steps: 266 | Train Loss: 0.3566124 Vali Loss: 0.7214894 Test Loss: 0.4635712
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3381847
	speed: 0.1236s/iter; left time: 546.8270s
	iters: 200, epoch: 4 | loss: 0.3206203
	speed: 0.1063s/iter; left time: 459.4757s
Epoch: 4 cost time: 28.956112146377563
Epoch: 4, Steps: 266 | Train Loss: 0.3467918 Vali Loss: 0.7368898 Test Loss: 0.5211418
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il48_ol96_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.423633337020874, mae:0.4452490210533142
