Args in experiment:
Namespace(baseline=False, batch_size=32, checkpoints='./checkpoints/', d_ff=512, d_model=256, data='ETTh2', data_dim=7, data_path='ETTh2.csv', data_split=[8640, 2880, 2880], devices='0,1,2,3', dropout=0.2, e_layers=3, factor=10, gpu=0, in_len=336, itr=5, learning_rate=0.0001, lradj='type1', n_heads=4, num_workers=0, out_len=720, patience=3, root_path='./datasets/', save_pred=False, seg_len=24, train_epochs=20, use_gpu=True, use_multi_gpu=False, win_size=2)
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.7211025
	speed: 0.3078s/iter; left time: 1434.7854s
	iters: 200, epoch: 1 | loss: 0.4603527
	speed: 0.2166s/iter; left time: 988.1078s
Epoch: 1 cost time: 61.524734020233154
Epoch: 1, Steps: 238 | Train Loss: 0.7345789 Vali Loss: 0.8555720 Test Loss: 2.0686299
Validation loss decreased (inf --> 0.855572).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4170042
	speed: 0.3172s/iter; left time: 1402.8419s
	iters: 200, epoch: 2 | loss: 0.4235361
	speed: 0.2763s/iter; left time: 1194.3633s
Epoch: 2 cost time: 72.747567653656
Epoch: 2, Steps: 238 | Train Loss: 0.4420733 Vali Loss: 0.7588081 Test Loss: 2.7108145
Validation loss decreased (0.855572 --> 0.758808).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3938611
	speed: 0.2325s/iter; left time: 973.1523s
	iters: 200, epoch: 3 | loss: 0.3845600
	speed: 0.1652s/iter; left time: 674.7233s
Epoch: 3 cost time: 46.10907530784607
Epoch: 3, Steps: 238 | Train Loss: 0.3734523 Vali Loss: 0.7864564 Test Loss: 3.0324877
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3548312
	speed: 0.1656s/iter; left time: 653.6263s
	iters: 200, epoch: 4 | loss: 0.3255551
	speed: 0.1648s/iter; left time: 633.9951s
Epoch: 4 cost time: 39.333235025405884
Epoch: 4, Steps: 238 | Train Loss: 0.3445402 Vali Loss: 0.8040565 Test Loss: 3.0027399
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2923961
	speed: 0.2763s/iter; left time: 1024.8880s
	iters: 200, epoch: 5 | loss: 0.2692096
	speed: 0.2783s/iter; left time: 1004.4148s
Epoch: 5 cost time: 65.2573676109314
Epoch: 5, Steps: 238 | Train Loss: 0.3214740 Vali Loss: 0.7985989 Test Loss: 3.7059070
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:2.7036705017089844, mae:1.3717796802520752
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6205161
	speed: 0.2249s/iter; left time: 1048.3819s
	iters: 200, epoch: 1 | loss: 0.5136380
	speed: 0.1833s/iter; left time: 836.1485s
Epoch: 1 cost time: 51.24751949310303
Epoch: 1, Steps: 238 | Train Loss: 0.7239727 Vali Loss: 0.8619803 Test Loss: 2.7499016
Validation loss decreased (inf --> 0.861980).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3947589
	speed: 0.2409s/iter; left time: 1065.5595s
	iters: 200, epoch: 2 | loss: 0.3820990
	speed: 0.2004s/iter; left time: 866.2013s
Epoch: 2 cost time: 54.101640939712524
Epoch: 2, Steps: 238 | Train Loss: 0.4517268 Vali Loss: 0.8862059 Test Loss: 3.3981197
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3809576
	speed: 0.2556s/iter; left time: 1069.7225s
	iters: 200, epoch: 3 | loss: 0.4156604
	speed: 0.1676s/iter; left time: 684.7640s
Epoch: 3 cost time: 51.629807472229004
Epoch: 3, Steps: 238 | Train Loss: 0.3874146 Vali Loss: 0.8474640 Test Loss: 3.8449566
Validation loss decreased (0.861980 --> 0.847464).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3855059
	speed: 0.2257s/iter; left time: 890.7339s
	iters: 200, epoch: 4 | loss: 0.3592247
	speed: 0.1457s/iter; left time: 560.4600s
Epoch: 4 cost time: 41.99080562591553
Epoch: 4, Steps: 238 | Train Loss: 0.3600677 Vali Loss: 0.8371864 Test Loss: 4.0197716
Validation loss decreased (0.847464 --> 0.837186).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2406491
	speed: 0.1258s/iter; left time: 466.5890s
	iters: 200, epoch: 5 | loss: 0.3609211
	speed: 0.3209s/iter; left time: 1158.2308s
Epoch: 5 cost time: 58.27633023262024
Epoch: 5, Steps: 238 | Train Loss: 0.3374280 Vali Loss: 0.8475575 Test Loss: 4.2440338
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.3923213
	speed: 0.3787s/iter; left time: 1314.5515s
	iters: 200, epoch: 6 | loss: 0.2828892
	speed: 0.3200s/iter; left time: 1078.8252s
Epoch: 6 cost time: 76.12275624275208
Epoch: 6, Steps: 238 | Train Loss: 0.3265732 Vali Loss: 0.8613895 Test Loss: 5.1309489
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.2677307
	speed: 0.1697s/iter; left time: 548.7857s
	iters: 200, epoch: 7 | loss: 0.2974958
	speed: 0.2292s/iter; left time: 718.2080s
Epoch: 7 cost time: 51.40498185157776
Epoch: 7, Steps: 238 | Train Loss: 0.3199378 Vali Loss: 0.8874061 Test Loss: 5.2549575
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:4.01757287979126, mae:1.7304916381835938
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.7596269
	speed: 0.2484s/iter; left time: 1157.9492s
	iters: 200, epoch: 1 | loss: 0.6329051
	speed: 0.2967s/iter; left time: 1353.2129s
Epoch: 1 cost time: 68.21853113174438
Epoch: 1, Steps: 238 | Train Loss: 0.7326962 Vali Loss: 0.7429476 Test Loss: 2.3918951
Validation loss decreased (inf --> 0.742948).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4768403
	speed: 0.1905s/iter; left time: 842.3889s
	iters: 200, epoch: 2 | loss: 0.3591910
	speed: 0.1799s/iter; left time: 777.5459s
Epoch: 2 cost time: 44.48483943939209
Epoch: 2, Steps: 238 | Train Loss: 0.4460429 Vali Loss: 0.8665457 Test Loss: 2.8816053
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2807540
	speed: 0.3564s/iter; left time: 1491.5038s
	iters: 200, epoch: 3 | loss: 0.3018685
	speed: 0.3582s/iter; left time: 1463.0699s
Epoch: 3 cost time: 85.30673789978027
Epoch: 3, Steps: 238 | Train Loss: 0.3776068 Vali Loss: 0.8275586 Test Loss: 2.8297804
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3725100
	speed: 0.3026s/iter; left time: 1194.4265s
	iters: 200, epoch: 4 | loss: 0.4205905
	speed: 0.2763s/iter; left time: 1062.8524s
Epoch: 4 cost time: 66.78432297706604
Epoch: 4, Steps: 238 | Train Loss: 0.3503371 Vali Loss: 0.8550339 Test Loss: 2.9120822
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:2.3871564865112305, mae:1.300633192062378
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6684121
	speed: 0.1743s/iter; left time: 812.3519s
	iters: 200, epoch: 1 | loss: 0.6591191
	speed: 0.2780s/iter; left time: 1267.7730s
Epoch: 1 cost time: 55.25684475898743
Epoch: 1, Steps: 238 | Train Loss: 0.7183792 Vali Loss: 1.0006394 Test Loss: 3.3137234
Validation loss decreased (inf --> 1.000639).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4073178
	speed: 0.2634s/iter; left time: 1164.8222s
	iters: 200, epoch: 2 | loss: 0.4063716
	speed: 0.2667s/iter; left time: 1153.0106s
Epoch: 2 cost time: 64.9195773601532
Epoch: 2, Steps: 238 | Train Loss: 0.4397398 Vali Loss: 1.1068705 Test Loss: 3.2058067
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3841829
	speed: 0.1928s/iter; left time: 807.0486s
	iters: 200, epoch: 3 | loss: 0.2977508
	speed: 0.1973s/iter; left time: 805.8993s
Epoch: 3 cost time: 48.623103618621826
Epoch: 3, Steps: 238 | Train Loss: 0.3735379 Vali Loss: 1.2084584 Test Loss: 3.4786579
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3156580
	speed: 0.3560s/iter; left time: 1405.1369s
	iters: 200, epoch: 4 | loss: 0.3588167
	speed: 0.3638s/iter; left time: 1399.4615s
Epoch: 4 cost time: 80.69773244857788
Epoch: 4, Steps: 238 | Train Loss: 0.3510165 Vali Loss: 1.1601429 Test Loss: 3.5577021
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:3.3098104000091553, mae:1.5519413948059082
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTh2_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5975595
	speed: 0.2403s/iter; left time: 1119.8189s
	iters: 200, epoch: 1 | loss: 0.3683446
	speed: 0.2560s/iter; left time: 1167.6617s
Epoch: 1 cost time: 56.01578116416931
Epoch: 1, Steps: 238 | Train Loss: 0.7276252 Vali Loss: 1.3525959 Test Loss: 2.7177852
Validation loss decreased (inf --> 1.352596).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4410348
	speed: 0.1768s/iter; left time: 781.8980s
	iters: 200, epoch: 2 | loss: 0.4931735
	speed: 0.2760s/iter; left time: 1192.9370s
Epoch: 2 cost time: 56.57473874092102
Epoch: 2, Steps: 238 | Train Loss: 0.4479606 Vali Loss: 1.2131432 Test Loss: 2.8207349
Validation loss decreased (1.352596 --> 1.213143).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2792605
	speed: 0.2941s/iter; left time: 1230.6162s
	iters: 200, epoch: 3 | loss: 0.3211156
	speed: 0.2769s/iter; left time: 1131.1016s
Epoch: 3 cost time: 67.9027304649353
Epoch: 3, Steps: 238 | Train Loss: 0.3774213 Vali Loss: 1.3425303 Test Loss: 2.7535765
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.4534255
	speed: 0.2631s/iter; left time: 1038.6120s
	iters: 200, epoch: 4 | loss: 0.2412841
	speed: 0.2592s/iter; left time: 997.2321s
Epoch: 4 cost time: 59.83042788505554
Epoch: 4, Steps: 238 | Train Loss: 0.3525228 Vali Loss: 1.3474409 Test Loss: 3.0153844
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.4007210
	speed: 0.3578s/iter; left time: 1327.0957s
	iters: 200, epoch: 5 | loss: 0.3022382
	speed: 0.2951s/iter; left time: 1064.8932s
Epoch: 5 cost time: 74.89503598213196
Epoch: 5, Steps: 238 | Train Loss: 0.3295521 Vali Loss: 1.2402089 Test Loss: 3.2841631
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh2_il336_ol720_sl24_win2_fa10_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:2.8174924850463867, mae:1.4059520959854126
